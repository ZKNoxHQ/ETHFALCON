// code generated using pythonref/generate_deprecated_falcon_test_vectors.py.
pragma solidity ^0.8.25;

import {Test, console} from "forge-std/Test.sol";
import "../../src/ZKNOX_NTT.sol";
import "../../src/deprecated/ZKNOX_falcon.sol";

contract ZKNOX_FalconTest is Test {
    ZKNOX_falcon falcon;
    //exemple of stateless initialisation, no external contract provided
    ZKNOX_NTT ntt = new ZKNOX_NTT(address(0), address(0), 12289, 12265);
    // forgefmt: disable-next-line
        uint256[512] psi_rev = [uint256(1), 10810, 7143, 4043, 10984, 722, 5736, 8155, 3542, 8785, 9744, 3621, 10643, 1212, 3195, 5860, 7468, 2639, 9664, 11340, 11726, 9314, 9283, 9545, 5728, 7698, 5023, 5828, 8961, 6512, 7311, 1351, 2319, 11119, 11334, 11499, 9088, 3014, 5086, 10963, 4846, 9542, 9154, 3712, 4805, 8736, 11227, 9995, 3091, 12208, 7969, 11289, 9326, 7393, 9238, 2366, 11112, 8034, 10654, 9521, 12149, 10436, 7678, 11563, 1260, 4388, 4632, 6534, 2426, 334, 1428, 1696, 2013, 9000, 729, 3241, 2881, 3284, 7197, 10200, 8595, 7110, 10530, 8582, 3382, 11934, 9741, 8058, 3637, 3459, 145, 6747, 9558, 8357, 7399, 6378, 9447, 480, 1022, 9, 9821, 339, 5791, 544, 10616, 4278, 6958, 7300, 8112, 8705, 1381, 9764, 11336, 8541, 827, 5767, 2476, 118, 2197, 7222, 3949, 8993, 4452, 2396, 7935, 130, 2837, 6915, 2401, 442, 7188, 11222, 390, 773, 8456, 3778, 354, 4861, 9377, 5698, 5012, 9808, 2859, 11244, 1017, 7404, 1632, 7205, 27, 9223, 8526, 10849, 1537, 242, 4714, 8146, 9611, 3704, 5019, 11744, 1002, 5011, 5088, 8005, 7313, 10682, 8509, 11414, 9852, 3646, 6022, 2987, 9723, 10102, 6250, 9867, 11224, 2143, 11885, 7644, 1168, 5277, 11082, 3248, 493, 8193, 6845, 2381, 7952, 11854, 1378, 1912, 2166, 3915, 12176, 7370, 12129, 3149, 12286, 4437, 3636, 4938, 5291, 2704, 10863, 7635, 1663, 10512, 3364, 1689, 4057, 9018, 9442, 7875, 2174, 4372, 7247, 9984, 4053, 2645, 5195, 9509, 7394, 1484, 9042, 9603, 8311, 9320, 9919, 2865, 5332, 3510, 1630, 10163, 5407, 3186, 11136, 9405, 10040, 8241, 9890, 8889, 7098, 9153, 9289, 671, 3016, 243, 6730, 420, 10111, 1544, 3985, 4905, 3531, 476, 49, 1263, 5915, 1483, 9789, 10800, 10706, 6347, 1512, 350, 10474, 5383, 5369, 10232, 9087, 4493, 9551, 6421, 6554, 2655, 9280, 1693, 174, 723, 10314, 8532, 347, 2925, 8974, 11863, 1858, 4754, 3030, 4115, 2361, 10446, 2908, 218, 3434, 8760, 3963, 576, 6142, 9842, 1954, 10238, 9407, 10484, 3991, 8320, 9522, 156, 2281, 5876, 10258, 5333, 3772, 418, 5908, 11836, 5429, 7515, 7552, 1293, 295, 6099, 5766, 652, 8273, 4077, 8527, 9370, 325, 10885, 11143, 11341, 5990, 1159, 8561, 8240, 3329, 4298, 12121, 2692, 5961, 7183, 10327, 1594, 6167, 9734, 7105, 11089, 1360, 3956, 6170, 5297, 8210, 11231, 922, 441, 1958, 4322, 1112, 2078, 4046, 709, 9139, 1319, 4240, 8719, 6224, 11454, 2459, 683, 3656, 12225, 10723, 5782, 9341, 9786, 9166, 10542, 9235, 6803, 7856, 6370, 3834, 7032, 7048, 9369, 8120, 9162, 6821, 1010, 8807, 787, 5057, 4698, 4780, 8844, 12097, 1321, 4912, 10240, 677, 6415, 6234, 8953, 1323, 9523, 12237, 3174, 1579, 11858, 9784, 5906, 3957, 9450, 151, 10162, 12231, 12048, 3532, 11286, 1956, 7280, 11404, 6281, 3477, 6608, 142, 11184, 9445, 3438, 11314, 4212, 9260, 6695, 4782, 5886, 8076, 504, 2302, 11684, 11868, 8209, 3602, 6068, 8689, 3263, 6077, 7665, 7822, 7500, 6752, 4749, 4449, 6833, 12142, 8500, 6118, 8471, 1190, 9606, 3860, 5445, 7753, 11239, 5079, 9027, 2169, 11767, 7965, 4916, 8214, 5315, 11011, 9945, 1973, 6715, 8775, 11248, 5925, 11271, 654, 3565, 1702, 1987, 6760, 5206, 3199, 12233, 6136, 6427, 6874, 8646, 4948, 6152, 400, 10561, 5339, 5446, 3710, 6093, 468, 8301, 316, 11907, 10256, 8291, 3879, 1922, 10930, 6854, 973, 11035];

    // forgefmt: disable-next-line
        uint256[512] psi_inv_rev = [uint256(1), 1479, 8246, 5146, 4134, 6553, 11567, 1305, 6429, 9094, 11077, 1646, 8668, 2545, 3504, 8747, 10938, 4978, 5777, 3328, 6461, 7266, 4591, 6561, 2744, 3006, 2975, 563, 949, 2625, 9650, 4821, 726, 4611, 1853, 140, 2768, 1635, 4255, 1177, 9923, 3051, 4896, 2963, 1000, 4320, 81, 9198, 2294, 1062, 3553, 7484, 8577, 3135, 2747, 7443, 1326, 7203, 9275, 3201, 790, 955, 1170, 9970, 5374, 9452, 12159, 4354, 9893, 7837, 3296, 8340, 5067, 10092, 12171, 9813, 6522, 11462, 3748, 953, 2525, 10908, 3584, 4177, 4989, 5331, 8011, 1673, 11745, 6498, 11950, 2468, 12280, 11267, 11809, 2842, 5911, 4890, 3932, 2731, 5542, 12144, 8830, 8652, 4231, 2548, 355, 8907, 3707, 1759, 5179, 3694, 2089, 5092, 9005, 9408, 9048, 11560, 3289, 10276, 10593, 10861, 11955, 9863, 5755, 7657, 7901, 11029, 11813, 8758, 7384, 8304, 10745, 2178, 11869, 5559, 12046, 9273, 11618, 3000, 3136, 5191, 3400, 2399, 4048, 2249, 2884, 1153, 9103, 6882, 2126, 10659, 8779, 6957, 9424, 2370, 2969, 3978, 2686, 3247, 10805, 4895, 2780, 7094, 9644, 8236, 2305, 5042, 7917, 10115, 4414, 2847, 3271, 8232, 10600, 8925, 1777, 10626, 4654, 1426, 9585, 6998, 7351, 8653, 7852, 3, 9140, 160, 4919, 113, 8374, 10123, 10377, 10911, 435, 4337, 9908, 5444, 4096, 11796, 9041, 1207, 7012, 11121, 4645, 404, 10146, 1065, 2422, 6039, 2187, 2566, 9302, 6267, 8643, 2437, 875, 3780, 1607, 4976, 4284, 7201, 7278, 11287, 545, 7270, 8585, 2678, 4143, 7575, 12047, 10752, 1440, 3763, 3066, 12262, 5084, 10657, 4885, 11272, 1045, 9430, 2481, 7277, 6591, 2912, 7428, 11935, 8511, 3833, 11516, 11899, 1067, 5101, 11847, 9888, 1254, 11316, 5435, 1359, 10367, 8410, 3998, 2033, 382, 11973, 3988, 11821, 6196, 8579, 6843, 6950, 1728, 11889, 6137, 7341, 3643, 5415, 5862, 6153, 56, 9090, 7083, 5529, 10302, 10587, 8724, 11635, 1018, 6364, 1041, 3514, 5574, 10316, 2344, 1278, 6974, 4075, 7373, 4324, 522, 10120, 3262, 7210, 1050, 4536, 6844, 8429, 2683, 11099, 3818, 6171, 3789, 147, 5456, 7840, 7540, 5537, 4789, 4467, 4624, 6212, 9026, 3600, 6221, 8687, 4080, 421, 605, 9987, 11785, 4213, 6403, 7507, 5594, 3029, 8077, 975, 8851, 2844, 1105, 12147, 5681, 8812, 6008, 885, 5009, 10333, 1003, 8757, 241, 58, 2127, 12138, 2839, 8332, 6383, 2505, 431, 10710, 9115, 52, 2766, 10966, 3336, 6055, 5874, 11612, 2049, 7377, 10968, 192, 3445, 7509, 7591, 7232, 11502, 3482, 11279, 5468, 3127, 4169, 2920, 5241, 5257, 8455, 5919, 4433, 5486, 3054, 1747, 3123, 2503, 2948, 6507, 1566, 64, 8633, 11606, 9830, 835, 6065, 3570, 8049, 10970, 3150, 11580, 8243, 10211, 11177, 7967, 10331, 11848, 11367, 1058, 4079, 6992, 6119, 8333, 10929, 1200, 5184, 2555, 6122, 10695, 1962, 5106, 6328, 9597, 168, 7991, 8960, 4049, 3728, 11130, 6299, 948, 1146, 1404, 11964, 2919, 3762, 8212, 4016, 11637, 6523, 6190, 11994, 10996, 4737, 4774, 6860, 453, 6381, 11871, 8517, 6956, 2031, 6413, 10008, 12133, 2767, 3969, 8298, 1805, 2882, 2051, 10335, 2447, 6147, 11713, 8326, 3529, 8855, 12071, 9381, 1843, 9928, 8174, 9259, 7535, 10431, 426, 3315, 9364, 11942, 3757, 1975, 11566, 12115, 10596, 3009, 9634, 5735, 5868, 2738, 7796, 3202, 2057, 6920, 6906, 1815, 11939, 10777, 5942, 1583, 1489, 2500, 10806, 6374, 11026, 12240];

    //stateful initialisation
    function setUp() public {
        bytes memory bytecode_psirev = abi.encodePacked(psi_rev);

        address a_psirev; //address of the precomputations bytecode contract
        a_psirev = address(uint160(0xcaca)); //here it is etched, use create in the future
        vm.etch(a_psirev, bytecode_psirev); //pushing psirev bytecode into contract todo : replace with create

        bytes memory bytecode_psiInvrev = abi.encodePacked(psi_inv_rev);

        address a_psiInvrev; //address of the precomputations bytecode contract
        a_psiInvrev = address(uint160(0xa5a5)); //here it is etched, use create in the future
        vm.etch(a_psiInvrev, bytecode_psiInvrev); //pushing psirev bytecode into contract todo : replace with create

        ntt.update(a_psirev, a_psiInvrev, 12289, 12265); //update ntt with outer contract

        falcon = new ZKNOX_falcon(ntt);
    }

    function testVector0() public view {
        // public key
        // forgefmt: disable-next-line
uint[512] memory tmp_pk = [uint(8494), 9875,5391,1879,708,7214,6161,7426,130,4397,5498,8631,2407,9977,1931,7029,2352,991,9225,9158,8285,955,12093,4942,2664,778,3383,11334,11105,10565,3474,7022,2706,1183,6455,1113,1385,4181,5984,1364,6193,7574,2703,11943,2783,9363,10213,6442,10177,6408,8584,2766,1171,7190,253,3679,2625,7796,8043,5703,2065,459,1063,5107,475,7421,2950,1363,9991,2222,1222,2148,12181,10486,7239,2220,8612,10147,11233,10557,3816,7607,2043,9737,1487,6402,7156,4425,11155,8706,2669,9984,4688,8809,3126,5346,8576,11683,12012,2541,7468,3700,12043,6636,274,7905,1637,11874,8091,6388,2132,3454,5363,11278,8138,4104,3664,6955,7423,9252,5243,717,9654,11089,2662,5813,2725,3997,7882,8147,1972,5360,9958,6537,9866,1837,9724,2515,6909,11077,7382,8940,10578,66,991,11249,12078,5661,297,4236,5240,10615,8894,6752,1599,8903,4789,8794,721,143,708,3893,9853,10975,12240,4519,3983,9215,420,8767,11835,10220,3914,10930,3539,11989,4395,2901,1427,7668,5489,4941,6674,12249,5831,3530,12171,10261,775,894,11564,5706,3810,11670,9294,9899,5872,9997,9218,8757,7970,11087,3323,4779,9473,12172,9576,2989,1404,11193,376,7670,9520,11007,10252,55,8952,3523,8081,2097,6848,11377,6165,5777,12044,12000,8941,1892,8951,4426,8954,9118,4116,7340,10060,9311,7351,11995,9476,6246,2151,1574,4104,12141,880,3709,2410,8871,1771,8281,11433,8802,5517,7260,8932,2340,11134,8858,1110,2811,6777,10364,9649,7387,1996,6561,7065,2190,12094,11677,10503,2145,11418,10041,9467,109,5395,5299,7200,11203,3966,6117,1065,3458,5521,12182,6969,1134,7108,648,285,8703,100,12113,6653,7377,6804,1717,9467,10055,4009,3545,7482,28,4253,47,12043,7057,1286,10754,3347,3280,3738,3323,7715,6500,350,12245,11148,1705,6450,336,2873,176,9059,2491,7546,2877,7417,9768,2526,2893,551,9462,1754,3452,7819,10010,844,4087,8473,5019,9155,12253,8338,10746,6837,9485,7469,4277,8497,10631,2810,5104,5895,7050,298,1144,3489,7210,11509,4913,7844,1396,9705,11371,1646,3089,7918,12187,6710,106,6810,3783,9423,180,3100,228,6112,9775,3407,10474,3340,232,11654,454,2551,6891,10879,2473,6594,9791,6870,5661,5877,8893,3075,4752,1135,3859,2495,5101,1384,5825,5539,1734,4694,7444,8731,4653,7432,7238,9267,1719,9790,6698,6049,2948,4962,8614,2381,2866,6384,11786,775,4155,7072,9670,2011,4684,6722,1077,7784,7614,217,90,9505,4379,1799,1159,6056,11386,5041,3383,102,12112,9520,8228,9636,668,210,4688,3381,2281,2261,11425,7820,2252,9565,7195,8650,7037,11164,9071,1220,1974,6262,8288,4926,1069,206,7288,4139,4020,728,10582,10621,4568,5054,9984,6837,236,7164,9106,9007,3765,700,4173,1524,11782,6690,9860,2926,538,11340,6889,10459,7255,7705,6244,10579,7541,10909,11397,9092,115,2610,5294,10509,3454,4985,2496];
        uint256[] memory pk = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            pk[i] = tmp_pk[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint[512] memory tmp_s2 = [uint(243), 20,113,150,77,11915,12076,12219,35,305,12116,12089,12256,12202,12220,216,12114,12270,12258,161,12249,12157,87,24,191,87,84,70,12025,129,123,220,12167,88,12135,19,61,308,12262,12286,139,47,12135,12051,87,12255,12243,5,57,12279,148,12248,203,56,254,12119,84,12117,12217,12210,16,11929,12155,39,12054,136,191,2,138,12124,214,11928,12264,128,90,172,12058,124,69,158,29,12207,12152,11902,12100,12194,38,12201,150,12073,21,12176,12116,11985,12205,147,12091,11992,46,12269,380,12169,11988,119,24,6,11939,5,50,12203,304,12114,11936,116,12249,12150,22,12130,12053,152,11811,12198,117,234,168,200,328,11901,12272,295,12156,194,12240,12136,12263,77,12283,226,236,12197,163,12219,1,111,12138,12254,12233,113,45,12183,12083,12222,119,12253,397,153,12242,75,43,12014,12257,70,139,105,112,119,74,139,12137,141,12241,12123,261,285,142,12181,11938,2,12194,12017,28,12269,12030,12159,193,85,12274,110,150,192,12263,14,335,12193,11978,12101,10,12206,126,12184,10,12212,43,12269,74,12252,261,192,2,52,106,12222,12068,12228,288,202,12043,11990,12221,56,58,12222,12240,11967,12147,11838,69,20,68,218,12138,12179,232,301,12285,46,12164,231,272,234,21,12124,8,12241,12137,93,44,79,12175,12221,12270,12237,12210,12243,12229,12199,12041,12253,15,12199,99,27,38,12134,213,56,192,12246,11920,56,47,186,73,12062,12282,12029,12253,172,12261,144,12097,11936,34,12031,179,42,118,12008,12285,12280,95,12258,12207,329,12196,25,177,12145,347,199,12260,12213,12197,88,11,128,12072,198,129,116,12130,12027,134,12252,12028,12202,157,12264,62,109,87,115,140,12116,85,7,8,53,37,312,12184,12079,164,12252,12086,12254,146,245,186,12133,176,12129,109,108,76,12223,12280,12048,280,12195,112,12226,12087,12103,270,12124,12015,12154,30,59,287,220,12114,68,144,12204,12268,191,12258,12261,11932,31,76,174,12207,22,212,112,12074,157,21,59,32,12192,12088,69,12094,12193,12226,149,12252,12056,44,12222,12192,90,170,12089,12142,12112,12023,11936,12190,6,12123,12182,173,12059,219,12245,12260,12282,96,14,79,253,12240,12213,32,12075,48,205,12099,12210,271,156,12094,12234,12213,163,12144,12149,12040,56,12240,27,153,23,12248,12192,12228,12182,110,136,12189,11958,334,12201,131,167,12199,124,27,38,12223,12229,17,54,12239,272,203,139,12196,12093,12247,12267,12145,137,12223,39,9,107,89,12221,12102,12133,12232,251,35,0,13,108,217,11923,12144,167,12148,11,123,12180,152,181,15,60,208,46,20,12284,12063,138,12281,205,12161,12288,12217,12174,12258,1,12075,89,12046,12156];
        ZKNOX_falcon.Signature memory sig;
        sig.s2 = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            sig.s2[i] = tmp_s2[i];
        }
        // message
        bytes memory message = "My name is Renaud from ZKNOX!!!!";
        sig.salt =
            "\xab\x0b\xae\x31\x63\x39\x89\x43\x04\xe3\x58\x77\xb0\xc2\x8a\x9b\x1f\xd1\x66\xc7\x96\xb9\xcc\x25\x8a\x06\x4a\x8f\x57\xe2\x7f\x2a\x5b\x8d\x54\x8a\x72\x8c\x94\x44";
        bool result = falcon.verify(message, sig, pk, false);
        assertEq(true, result);
    }

    function testVector1() public view {
        // public key
        // forgefmt: disable-next-line
uint[512] memory tmp_pk = [uint(8494), 9875,5391,1879,708,7214,6161,7426,130,4397,5498,8631,2407,9977,1931,7029,2352,991,9225,9158,8285,955,12093,4942,2664,778,3383,11334,11105,10565,3474,7022,2706,1183,6455,1113,1385,4181,5984,1364,6193,7574,2703,11943,2783,9363,10213,6442,10177,6408,8584,2766,1171,7190,253,3679,2625,7796,8043,5703,2065,459,1063,5107,475,7421,2950,1363,9991,2222,1222,2148,12181,10486,7239,2220,8612,10147,11233,10557,3816,7607,2043,9737,1487,6402,7156,4425,11155,8706,2669,9984,4688,8809,3126,5346,8576,11683,12012,2541,7468,3700,12043,6636,274,7905,1637,11874,8091,6388,2132,3454,5363,11278,8138,4104,3664,6955,7423,9252,5243,717,9654,11089,2662,5813,2725,3997,7882,8147,1972,5360,9958,6537,9866,1837,9724,2515,6909,11077,7382,8940,10578,66,991,11249,12078,5661,297,4236,5240,10615,8894,6752,1599,8903,4789,8794,721,143,708,3893,9853,10975,12240,4519,3983,9215,420,8767,11835,10220,3914,10930,3539,11989,4395,2901,1427,7668,5489,4941,6674,12249,5831,3530,12171,10261,775,894,11564,5706,3810,11670,9294,9899,5872,9997,9218,8757,7970,11087,3323,4779,9473,12172,9576,2989,1404,11193,376,7670,9520,11007,10252,55,8952,3523,8081,2097,6848,11377,6165,5777,12044,12000,8941,1892,8951,4426,8954,9118,4116,7340,10060,9311,7351,11995,9476,6246,2151,1574,4104,12141,880,3709,2410,8871,1771,8281,11433,8802,5517,7260,8932,2340,11134,8858,1110,2811,6777,10364,9649,7387,1996,6561,7065,2190,12094,11677,10503,2145,11418,10041,9467,109,5395,5299,7200,11203,3966,6117,1065,3458,5521,12182,6969,1134,7108,648,285,8703,100,12113,6653,7377,6804,1717,9467,10055,4009,3545,7482,28,4253,47,12043,7057,1286,10754,3347,3280,3738,3323,7715,6500,350,12245,11148,1705,6450,336,2873,176,9059,2491,7546,2877,7417,9768,2526,2893,551,9462,1754,3452,7819,10010,844,4087,8473,5019,9155,12253,8338,10746,6837,9485,7469,4277,8497,10631,2810,5104,5895,7050,298,1144,3489,7210,11509,4913,7844,1396,9705,11371,1646,3089,7918,12187,6710,106,6810,3783,9423,180,3100,228,6112,9775,3407,10474,3340,232,11654,454,2551,6891,10879,2473,6594,9791,6870,5661,5877,8893,3075,4752,1135,3859,2495,5101,1384,5825,5539,1734,4694,7444,8731,4653,7432,7238,9267,1719,9790,6698,6049,2948,4962,8614,2381,2866,6384,11786,775,4155,7072,9670,2011,4684,6722,1077,7784,7614,217,90,9505,4379,1799,1159,6056,11386,5041,3383,102,12112,9520,8228,9636,668,210,4688,3381,2281,2261,11425,7820,2252,9565,7195,8650,7037,11164,9071,1220,1974,6262,8288,4926,1069,206,7288,4139,4020,728,10582,10621,4568,5054,9984,6837,236,7164,9106,9007,3765,700,4173,1524,11782,6690,9860,2926,538,11340,6889,10459,7255,7705,6244,10579,7541,10909,11397,9092,115,2610,5294,10509,3454,4985,2496];
        uint256[] memory pk = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            pk[i] = tmp_pk[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint[512] memory tmp_s2 = [uint(45), 142,1,12202,12260,12267,12098,12148,12258,12069,12261,232,12184,172,73,12138,12083,12174,12155,268,82,90,12230,244,107,12283,226,12263,122,12078,12220,43,12046,12064,220,158,47,11884,12172,192,110,12163,302,12124,12091,255,130,12120,288,12195,126,12281,126,50,187,12115,12090,12,240,84,48,12163,75,332,12137,320,12042,12236,217,12023,176,12049,12244,79,58,12149,12245,354,297,245,12039,12167,12109,12180,2,55,12187,255,121,149,12254,106,12274,136,12157,136,179,125,12160,33,75,172,12079,58,323,23,109,19,165,12106,176,13,12110,12187,12171,11914,2,370,12083,12273,182,140,12070,12239,12282,12171,230,12261,12089,11838,12115,12152,12008,12267,12155,12204,160,12097,12170,12159,213,12162,12196,11957,12254,12158,12195,12140,12279,12198,153,12199,134,12064,12189,342,12092,12226,12278,12282,12106,12179,178,12235,12,12215,236,11992,12263,145,248,115,242,12237,103,110,87,409,12220,33,141,193,11877,12187,15,122,12263,12198,17,385,12258,31,12198,40,12110,12242,7,165,50,12120,12236,137,296,12107,12259,3,12236,11966,287,29,12198,17,12281,85,12222,12026,12245,12195,78,12241,12030,268,20,4,12243,29,67,12,295,48,12227,12269,12288,12209,104,12191,12285,19,384,279,12246,134,12259,275,77,90,5,12207,12198,23,12273,60,17,12159,12239,11981,12197,12067,12216,85,218,15,12283,98,121,11693,12171,12253,11,12286,12121,12199,12249,179,154,12269,180,70,12098,88,12010,202,11883,93,12085,12248,12109,41,4,24,657,286,11931,12213,100,12193,12110,12190,12242,98,12263,11951,145,12184,12158,10,89,140,12006,59,17,12186,11885,12168,12168,12020,146,10,40,159,12088,12103,124,12207,12178,12272,12143,12074,42,12159,12067,153,70,12284,12278,239,12174,110,12109,12223,12284,12051,124,157,152,12058,12216,12264,25,12054,12235,63,62,150,12093,12135,12271,67,12223,12180,61,31,110,302,12170,12092,12243,12144,79,12080,12192,12062,209,12252,150,12045,203,12280,364,12117,182,12252,164,306,12214,150,36,12075,50,11933,33,12167,12245,151,12246,125,12284,120,33,209,277,242,97,47,6,12112,28,47,118,407,228,12,12177,56,186,201,12237,12228,12272,12211,12286,12193,12131,278,55,20,12200,12185,112,1,6,58,316,10,12132,24,58,12070,118,12037,12099,12266,12163,417,19,12255,12214,12034,12287,181,12114,283,11911,124,61,241,105,197,12244,230,336,12242,65,12007,12284,2,12273,12093,11985,12218,10,324,12264,12229,40,184,77,47,102,186,12113,41,12140,12246,12200,12271,12173,135,12188,12175,11999,12271,12149,12206,12233,228,12174,59,12091,12059,12121,12194,59,12225,51,79,12238,12165,12143,12151,12279,229];
        ZKNOX_falcon.Signature memory sig;
        sig.s2 = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            sig.s2[i] = tmp_s2[i];
        }
        // message
        bytes memory message = "My name is Simon also from ZKNOX";
        sig.salt =
            "\x91\x89\x90\xff\x93\xe0\x65\x6b\x5f\x75\xb0\x87\x29\xc6\x0e\x6a\x9d\x73\x52\xb9\xef\xd2\xe3\x3e\x3d\x1b\xa6\xe6\xd8\x9e\xdf\xa6\x71\x26\x6e\xce\x6b\xe7\xbb\x5a";
        bool result = falcon.verify(message, sig, pk, false);
        assertEq(true, result);
    }

    function testVector2() public view {
        // public key
        // forgefmt: disable-next-line
uint[512] memory tmp_pk = [uint(8494), 9875,5391,1879,708,7214,6161,7426,130,4397,5498,8631,2407,9977,1931,7029,2352,991,9225,9158,8285,955,12093,4942,2664,778,3383,11334,11105,10565,3474,7022,2706,1183,6455,1113,1385,4181,5984,1364,6193,7574,2703,11943,2783,9363,10213,6442,10177,6408,8584,2766,1171,7190,253,3679,2625,7796,8043,5703,2065,459,1063,5107,475,7421,2950,1363,9991,2222,1222,2148,12181,10486,7239,2220,8612,10147,11233,10557,3816,7607,2043,9737,1487,6402,7156,4425,11155,8706,2669,9984,4688,8809,3126,5346,8576,11683,12012,2541,7468,3700,12043,6636,274,7905,1637,11874,8091,6388,2132,3454,5363,11278,8138,4104,3664,6955,7423,9252,5243,717,9654,11089,2662,5813,2725,3997,7882,8147,1972,5360,9958,6537,9866,1837,9724,2515,6909,11077,7382,8940,10578,66,991,11249,12078,5661,297,4236,5240,10615,8894,6752,1599,8903,4789,8794,721,143,708,3893,9853,10975,12240,4519,3983,9215,420,8767,11835,10220,3914,10930,3539,11989,4395,2901,1427,7668,5489,4941,6674,12249,5831,3530,12171,10261,775,894,11564,5706,3810,11670,9294,9899,5872,9997,9218,8757,7970,11087,3323,4779,9473,12172,9576,2989,1404,11193,376,7670,9520,11007,10252,55,8952,3523,8081,2097,6848,11377,6165,5777,12044,12000,8941,1892,8951,4426,8954,9118,4116,7340,10060,9311,7351,11995,9476,6246,2151,1574,4104,12141,880,3709,2410,8871,1771,8281,11433,8802,5517,7260,8932,2340,11134,8858,1110,2811,6777,10364,9649,7387,1996,6561,7065,2190,12094,11677,10503,2145,11418,10041,9467,109,5395,5299,7200,11203,3966,6117,1065,3458,5521,12182,6969,1134,7108,648,285,8703,100,12113,6653,7377,6804,1717,9467,10055,4009,3545,7482,28,4253,47,12043,7057,1286,10754,3347,3280,3738,3323,7715,6500,350,12245,11148,1705,6450,336,2873,176,9059,2491,7546,2877,7417,9768,2526,2893,551,9462,1754,3452,7819,10010,844,4087,8473,5019,9155,12253,8338,10746,6837,9485,7469,4277,8497,10631,2810,5104,5895,7050,298,1144,3489,7210,11509,4913,7844,1396,9705,11371,1646,3089,7918,12187,6710,106,6810,3783,9423,180,3100,228,6112,9775,3407,10474,3340,232,11654,454,2551,6891,10879,2473,6594,9791,6870,5661,5877,8893,3075,4752,1135,3859,2495,5101,1384,5825,5539,1734,4694,7444,8731,4653,7432,7238,9267,1719,9790,6698,6049,2948,4962,8614,2381,2866,6384,11786,775,4155,7072,9670,2011,4684,6722,1077,7784,7614,217,90,9505,4379,1799,1159,6056,11386,5041,3383,102,12112,9520,8228,9636,668,210,4688,3381,2281,2261,11425,7820,2252,9565,7195,8650,7037,11164,9071,1220,1974,6262,8288,4926,1069,206,7288,4139,4020,728,10582,10621,4568,5054,9984,6837,236,7164,9106,9007,3765,700,4173,1524,11782,6690,9860,2926,538,11340,6889,10459,7255,7705,6244,10579,7541,10909,11397,9092,115,2610,5294,10509,3454,4985,2496];
        uint256[] memory pk = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            pk[i] = tmp_pk[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint[512] memory tmp_s2 = [uint(12123), 12244,12062,12069,215,86,12270,12118,311,12164,285,301,34,62,98,266,57,12246,46,12125,62,63,12014,94,12161,12226,31,246,47,12206,250,70,12182,140,236,12111,17,12072,12267,100,12252,12185,12258,255,12169,123,12240,138,12097,12125,12194,63,12227,12030,65,12063,64,171,12014,11881,342,7,12239,159,159,298,12051,210,45,12112,350,12282,69,84,36,12121,12255,12269,126,12209,24,12144,163,23,12041,54,115,30,11857,156,12204,4,11947,15,12251,12288,84,12249,1,60,12233,38,246,181,35,12258,12004,12288,12141,12138,12181,12132,11944,59,12,12025,84,12104,87,12120,12234,136,397,12105,84,42,30,12143,31,12136,194,14,12177,12255,12193,66,19,26,12256,12264,12150,12118,70,23,12275,91,81,12034,15,12151,12099,12177,12166,12227,126,71,12171,194,94,12233,12182,164,8,241,7,12252,86,57,201,191,192,18,11964,4,12155,378,59,156,134,12233,104,12137,110,12186,12024,125,132,331,12248,12183,113,12147,12101,12141,228,35,26,183,176,47,18,12254,12142,102,12246,242,101,12287,12243,70,4,126,12018,131,12163,12246,11,12183,12282,47,12263,42,132,12177,39,372,12016,12126,12138,12196,12277,37,12285,12160,8,133,178,12152,382,36,74,12101,12221,12216,12224,228,12194,372,12199,88,11763,103,15,12192,300,12173,79,12246,12193,12220,12208,123,12119,3,12212,197,12262,75,139,12239,62,351,12255,64,33,108,12214,142,279,414,212,11971,12210,12222,12133,53,12286,12286,12146,303,12204,12179,81,135,12193,162,149,12276,11977,9,155,12270,357,11926,12148,12232,11874,12078,17,12148,12251,134,32,13,12247,12233,94,66,12219,12129,12264,12259,91,102,442,54,12065,12267,38,12025,18,12148,12280,74,114,397,221,287,205,12274,44,302,75,34,16,12175,11948,12261,211,47,11999,161,135,12092,12205,12109,218,98,246,12215,155,126,12074,12192,160,12197,12126,57,23,12122,11896,12,12163,119,12217,12158,12166,5,12090,121,12271,67,12226,12229,12279,94,241,390,336,66,45,12114,101,12212,100,17,12248,160,12097,62,14,12021,9,12209,12020,12118,12016,12176,23,12202,12240,12258,87,84,12117,12025,12144,263,11984,130,208,160,12191,12171,9,15,173,290,90,12151,12141,267,12070,113,12206,434,12182,12180,60,12249,11993,205,1,12178,99,72,20,12083,88,12272,12181,12181,12173,12263,12149,54,128,12271,12263,190,12113,132,12054,114,12233,12137,12041,12141,12133,161,15,17,22,12035,49,93,25,12128,11909,249,12228,11924,12285,12181,31,191,12169,12155,12092,38,12236,99,352,12016,35,12223,12216,12224,378,12040,12205,75,347,12253,52,12270,11693,12183,102,103,66,65];
        ZKNOX_falcon.Signature memory sig;
        sig.s2 = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            sig.s2[i] = tmp_s2[i];
        }
        // message
        bytes memory message = "My name is Nicolas from ZKNOXtoo";
        sig.salt =
            "\x13\x57\x9b\x4e\xf5\xf6\xb6\x42\x65\x63\xd7\x19\x5b\x8c\x5b\x84\x73\x6b\x14\x26\x61\x60\x34\x2c\x40\x93\xf8\xab\xea\x48\x37\x1b\xa9\x4c\xc0\x6d\xcb\x6b\x8a\x8e";
        bool result = falcon.verify(message, sig, pk, false);
        assertEq(true, result);
    }

    function testVector3() public view {
        // public key
        // forgefmt: disable-next-line
uint[512] memory tmp_pk = [uint(8494), 9875,5391,1879,708,7214,6161,7426,130,4397,5498,8631,2407,9977,1931,7029,2352,991,9225,9158,8285,955,12093,4942,2664,778,3383,11334,11105,10565,3474,7022,2706,1183,6455,1113,1385,4181,5984,1364,6193,7574,2703,11943,2783,9363,10213,6442,10177,6408,8584,2766,1171,7190,253,3679,2625,7796,8043,5703,2065,459,1063,5107,475,7421,2950,1363,9991,2222,1222,2148,12181,10486,7239,2220,8612,10147,11233,10557,3816,7607,2043,9737,1487,6402,7156,4425,11155,8706,2669,9984,4688,8809,3126,5346,8576,11683,12012,2541,7468,3700,12043,6636,274,7905,1637,11874,8091,6388,2132,3454,5363,11278,8138,4104,3664,6955,7423,9252,5243,717,9654,11089,2662,5813,2725,3997,7882,8147,1972,5360,9958,6537,9866,1837,9724,2515,6909,11077,7382,8940,10578,66,991,11249,12078,5661,297,4236,5240,10615,8894,6752,1599,8903,4789,8794,721,143,708,3893,9853,10975,12240,4519,3983,9215,420,8767,11835,10220,3914,10930,3539,11989,4395,2901,1427,7668,5489,4941,6674,12249,5831,3530,12171,10261,775,894,11564,5706,3810,11670,9294,9899,5872,9997,9218,8757,7970,11087,3323,4779,9473,12172,9576,2989,1404,11193,376,7670,9520,11007,10252,55,8952,3523,8081,2097,6848,11377,6165,5777,12044,12000,8941,1892,8951,4426,8954,9118,4116,7340,10060,9311,7351,11995,9476,6246,2151,1574,4104,12141,880,3709,2410,8871,1771,8281,11433,8802,5517,7260,8932,2340,11134,8858,1110,2811,6777,10364,9649,7387,1996,6561,7065,2190,12094,11677,10503,2145,11418,10041,9467,109,5395,5299,7200,11203,3966,6117,1065,3458,5521,12182,6969,1134,7108,648,285,8703,100,12113,6653,7377,6804,1717,9467,10055,4009,3545,7482,28,4253,47,12043,7057,1286,10754,3347,3280,3738,3323,7715,6500,350,12245,11148,1705,6450,336,2873,176,9059,2491,7546,2877,7417,9768,2526,2893,551,9462,1754,3452,7819,10010,844,4087,8473,5019,9155,12253,8338,10746,6837,9485,7469,4277,8497,10631,2810,5104,5895,7050,298,1144,3489,7210,11509,4913,7844,1396,9705,11371,1646,3089,7918,12187,6710,106,6810,3783,9423,180,3100,228,6112,9775,3407,10474,3340,232,11654,454,2551,6891,10879,2473,6594,9791,6870,5661,5877,8893,3075,4752,1135,3859,2495,5101,1384,5825,5539,1734,4694,7444,8731,4653,7432,7238,9267,1719,9790,6698,6049,2948,4962,8614,2381,2866,6384,11786,775,4155,7072,9670,2011,4684,6722,1077,7784,7614,217,90,9505,4379,1799,1159,6056,11386,5041,3383,102,12112,9520,8228,9636,668,210,4688,3381,2281,2261,11425,7820,2252,9565,7195,8650,7037,11164,9071,1220,1974,6262,8288,4926,1069,206,7288,4139,4020,728,10582,10621,4568,5054,9984,6837,236,7164,9106,9007,3765,700,4173,1524,11782,6690,9860,2926,538,11340,6889,10459,7255,7705,6244,10579,7541,10909,11397,9092,115,2610,5294,10509,3454,4985,2496];
        uint256[] memory pk = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            pk[i] = tmp_pk[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint[512] memory tmp_s2 = [uint(12202), 81,87,12044,12239,42,33,238,12208,122,56,366,12276,27,12055,106,178,12262,12029,148,81,147,12109,28,183,12,12087,12143,112,62,12132,27,12084,7,42,195,12134,12217,178,12061,18,174,7,207,12224,12213,48,113,56,11961,340,418,12257,12178,51,332,12268,11,11929,12150,12178,79,12203,45,12102,12253,217,206,12162,68,108,293,12038,12105,12208,43,12080,12104,159,134,3,12107,12107,12076,11924,11983,77,117,61,12139,12188,51,118,12175,181,11908,187,26,50,12266,12164,12155,0,63,178,78,12242,49,166,12109,12195,11967,11951,12236,12117,300,187,46,303,102,12160,12283,12286,12202,12141,90,18,12205,75,12198,99,157,12060,12035,11911,270,3,12079,43,12238,44,58,81,12243,142,11981,30,199,196,12259,17,191,49,12260,12215,276,12101,193,12196,12195,171,177,12027,12175,166,12237,265,12187,231,188,71,111,377,12278,12267,73,12218,122,12242,201,12263,12197,28,206,33,179,17,12193,12247,12080,326,80,77,12215,12163,12175,60,211,163,253,12170,11933,84,12265,12227,141,12127,12156,72,12110,75,12139,83,12142,12056,12279,12152,12269,12269,27,59,215,12257,12177,12271,196,59,289,120,12246,19,12211,6,12278,11995,33,107,12199,12141,106,12124,63,124,12041,112,73,135,10,12237,12085,132,79,12225,95,12235,112,330,12098,216,113,12277,153,12166,12268,67,12121,474,145,12203,12086,12157,16,286,16,12200,12201,12235,12126,12274,12094,4,269,191,113,12257,72,12278,12001,12173,171,12274,12179,12261,12035,12092,234,105,12198,12067,153,12264,31,237,12,49,12102,12275,11,12094,12072,32,12056,33,20,12274,311,113,12127,263,12146,11922,29,12259,12230,290,29,139,13,12279,88,12030,260,12205,12286,12071,12023,12199,12200,191,45,12199,12143,12179,46,63,123,12284,12199,12155,62,12254,12265,232,329,54,12083,12088,91,48,243,23,149,292,12280,12207,12249,75,12231,12272,225,198,112,12229,12206,12220,42,40,105,166,120,45,7,11947,12286,39,12267,22,40,12152,12113,32,12279,17,12169,59,12103,12171,12271,12286,12260,207,12266,152,12094,12199,158,12288,71,27,12090,12,12012,12178,12262,67,12102,12230,136,12073,11966,12260,11975,245,82,432,62,68,5,12232,153,348,59,12144,38,24,12234,14,12034,12035,12223,70,35,261,68,12143,12236,11910,272,24,12099,59,90,12114,12236,12139,31,12244,234,111,216,240,12191,120,148,12081,130,106,12158,12133,133,63,12210,22,292,12140,172,12127,11898,13,159,98,71,12128,12264,12107,12207,12263,176,70,12258,203,315,31,12000,12183,145,34,2,26,75,12204,164,12056,11884,75,12136,92,12269,12284,12048,55,154];
        ZKNOX_falcon.Signature memory sig;
        sig.s2 = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            sig.s2[i] = tmp_s2[i];
        }
        // message
        bytes memory message = "We are ZKNox, you already know!!";
        sig.salt =
            "\x5a\x54\x83\x5f\x8b\x04\xd4\xc0\xb2\x96\x67\xba\xeb\x0c\x32\x58\x80\x9e\xe6\x98\xdb\xc0\x35\x36\xa1\xc9\x36\xc8\x11\xf6\xe6\xf6\x92\x10\xf5\x63\x20\x80\x06\x49";
        bool result = falcon.verify(message, sig, pk, false);
        assertEq(true, result);
    }

    function testVector4() public view {
        // public key
        // forgefmt: disable-next-line
uint[512] memory tmp_pk = [uint(8494), 9875,5391,1879,708,7214,6161,7426,130,4397,5498,8631,2407,9977,1931,7029,2352,991,9225,9158,8285,955,12093,4942,2664,778,3383,11334,11105,10565,3474,7022,2706,1183,6455,1113,1385,4181,5984,1364,6193,7574,2703,11943,2783,9363,10213,6442,10177,6408,8584,2766,1171,7190,253,3679,2625,7796,8043,5703,2065,459,1063,5107,475,7421,2950,1363,9991,2222,1222,2148,12181,10486,7239,2220,8612,10147,11233,10557,3816,7607,2043,9737,1487,6402,7156,4425,11155,8706,2669,9984,4688,8809,3126,5346,8576,11683,12012,2541,7468,3700,12043,6636,274,7905,1637,11874,8091,6388,2132,3454,5363,11278,8138,4104,3664,6955,7423,9252,5243,717,9654,11089,2662,5813,2725,3997,7882,8147,1972,5360,9958,6537,9866,1837,9724,2515,6909,11077,7382,8940,10578,66,991,11249,12078,5661,297,4236,5240,10615,8894,6752,1599,8903,4789,8794,721,143,708,3893,9853,10975,12240,4519,3983,9215,420,8767,11835,10220,3914,10930,3539,11989,4395,2901,1427,7668,5489,4941,6674,12249,5831,3530,12171,10261,775,894,11564,5706,3810,11670,9294,9899,5872,9997,9218,8757,7970,11087,3323,4779,9473,12172,9576,2989,1404,11193,376,7670,9520,11007,10252,55,8952,3523,8081,2097,6848,11377,6165,5777,12044,12000,8941,1892,8951,4426,8954,9118,4116,7340,10060,9311,7351,11995,9476,6246,2151,1574,4104,12141,880,3709,2410,8871,1771,8281,11433,8802,5517,7260,8932,2340,11134,8858,1110,2811,6777,10364,9649,7387,1996,6561,7065,2190,12094,11677,10503,2145,11418,10041,9467,109,5395,5299,7200,11203,3966,6117,1065,3458,5521,12182,6969,1134,7108,648,285,8703,100,12113,6653,7377,6804,1717,9467,10055,4009,3545,7482,28,4253,47,12043,7057,1286,10754,3347,3280,3738,3323,7715,6500,350,12245,11148,1705,6450,336,2873,176,9059,2491,7546,2877,7417,9768,2526,2893,551,9462,1754,3452,7819,10010,844,4087,8473,5019,9155,12253,8338,10746,6837,9485,7469,4277,8497,10631,2810,5104,5895,7050,298,1144,3489,7210,11509,4913,7844,1396,9705,11371,1646,3089,7918,12187,6710,106,6810,3783,9423,180,3100,228,6112,9775,3407,10474,3340,232,11654,454,2551,6891,10879,2473,6594,9791,6870,5661,5877,8893,3075,4752,1135,3859,2495,5101,1384,5825,5539,1734,4694,7444,8731,4653,7432,7238,9267,1719,9790,6698,6049,2948,4962,8614,2381,2866,6384,11786,775,4155,7072,9670,2011,4684,6722,1077,7784,7614,217,90,9505,4379,1799,1159,6056,11386,5041,3383,102,12112,9520,8228,9636,668,210,4688,3381,2281,2261,11425,7820,2252,9565,7195,8650,7037,11164,9071,1220,1974,6262,8288,4926,1069,206,7288,4139,4020,728,10582,10621,4568,5054,9984,6837,236,7164,9106,9007,3765,700,4173,1524,11782,6690,9860,2926,538,11340,6889,10459,7255,7705,6244,10579,7541,10909,11397,9092,115,2610,5294,10509,3454,4985,2496];
        uint256[] memory pk = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            pk[i] = tmp_pk[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint[512] memory tmp_s2 = [uint(12013), 12269,12046,275,11910,12288,40,27,267,481,331,27,84,81,248,12016,12122,275,181,12250,12162,12265,62,12244,91,12269,12276,94,12247,12089,12153,317,285,12235,187,249,3,12083,12086,131,12019,12227,0,11954,12208,12037,135,12131,12263,12083,39,12219,12201,189,65,12093,8,12162,135,12168,116,367,218,12259,12156,225,41,12055,201,13,12185,198,11768,103,176,12278,12110,12166,12210,12244,12239,12170,12242,12250,68,80,12250,135,12194,84,12245,42,12198,11,258,12001,76,12254,233,12163,12206,230,135,12177,12240,44,12008,11816,101,12217,250,12277,12115,12232,11961,12238,12214,12185,12009,12104,162,74,12209,12144,89,207,10,25,181,12109,204,294,129,38,239,221,12195,12016,226,12093,12075,12141,32,12109,152,12182,97,83,247,12158,11955,79,66,12128,12161,77,12083,12103,12242,12216,118,178,12221,123,340,12097,12221,11910,383,12253,12158,12113,104,12143,333,51,126,12134,56,317,5,149,12218,212,67,12255,12200,66,12056,25,127,375,12217,12207,212,296,12,12140,154,12168,290,111,12261,12255,12193,418,12271,92,56,12041,12230,12229,306,35,13,12040,119,65,12129,12281,87,12263,24,118,180,75,12277,12045,336,12262,99,12145,31,12225,105,12119,12204,196,12175,12234,48,12257,12282,12267,12156,190,12075,65,32,6,182,210,12036,253,123,146,113,337,12196,240,232,219,36,12214,11967,11934,12269,12147,239,12141,162,12117,102,210,361,12178,12100,72,12222,12103,78,12280,97,28,143,12285,12017,12052,196,217,76,12218,12057,31,12107,244,313,12070,11,48,248,137,12279,7,12189,12230,12131,12077,12189,12276,190,12078,11950,286,11977,95,12055,17,209,86,12258,144,12092,102,105,12148,130,11941,22,240,140,12081,180,20,12244,12148,12055,169,12283,12055,120,174,12200,161,12118,144,12206,241,84,12057,12194,97,12139,12147,7,12101,43,2,101,11974,148,12141,12249,176,12212,12149,145,31,12033,60,240,21,12265,12188,52,17,39,360,158,94,40,12049,270,12200,12202,12086,145,323,14,12259,63,12258,12276,12137,118,164,12148,10,212,134,38,12234,12194,75,12202,12066,47,111,12089,12008,135,73,11976,12001,127,12237,12200,12000,131,12050,12263,12200,152,62,203,12222,12249,11923,225,12114,12042,12099,12106,12214,12227,12090,12037,12115,40,12171,12175,12158,144,12,20,144,94,121,12155,132,12251,12260,12220,87,191,56,37,227,146,12005,12220,20,12179,14,12128,12261,224,142,50,12162,161,12281,11912,82,49,12198,171,123,12135,12091,125,12148,184,11940,12170,12185,12,12224,63,12203,12222,12095,6,0,12245,0,25,12243,11903,12057,38,12133,152,12227,43,11951,200,12264,84,269,34,12150];
        ZKNOX_falcon.Signature memory sig;
        sig.s2 = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            sig.s2[i] = tmp_s2[i];
        }
        // message
        bytes memory message = "Practical security on the chain.";
        sig.salt =
            "\xc3\xff\x24\xbc\x6b\x6d\x7a\x3d\x30\x7c\xe7\xb1\x73\x1e\x7d\xf5\x96\x90\xd0\x53\x0d\x7f\x2f\x5b\xb9\xed\x37\xd1\x80\x16\x9a\x6c\x1b\xb0\x22\x25\x2a\xb8\xcc\x68";
        bool result = falcon.verify(message, sig, pk, false);
        assertEq(true, result);
    }
}
