// code generated using pythonref/generate_hashtopoint_test_vectors.py.
pragma solidity ^0.8.25;

import {Test, console} from "forge-std/Test.sol";
import "../src/ZKNOX_HashToPoint.sol";
import "../src/ZKNOX_falcon.sol";
import "../src/ZKNOX_ethfalcon.sol";
import "../src/ZKNOX_ethepervier.sol";
import "../src/ZKNOX_NTT_falcon.sol";
import "../src/ZKNOX_falcon_encodings.sol";

contract Benchmark is Test {
    ZKNOX_falcon falcon;
    ZKNOX_ethfalcon ethfalcon;
    ZKNOX_ethepervier ethepervier;

    // forgefmt: disable-next-line
	uint256[]  f = [9999, 7085, 6820, 8778, 6376, 3654, 751, 8032, 9000, 7804, 1199, 698, 11321, 9441, 11590, 1244, 4515, 10616, 6860, 441, 6800, 11579, 4591, 5953, 10392, 4264, 2672, 10279, 1124, 2490, 3242, 6344, 5052, 1585, 4677, 3186, 4500, 6989, 439, 2822, 12191, 8937, 1146, 10412, 9422, 8183, 6233, 12110, 10972, 7139, 4359, 5441, 171, 7485, 579, 7478, 8148, 523, 8046, 11529, 5261, 11343, 478, 11537, 8707, 1510, 4800, 3705, 6474, 8752, 10907, 5380, 2680, 2901, 8837, 174, 7393, 11327, 3000, 2962, 10762, 7159, 8732, 7335, 11165, 6400, 12254, 437, 7048, 763, 4495, 1246, 6650, 5548, 3303, 2931, 4471, 5342, 1372, 3210, 11499, 8447, 2992, 1331, 9795, 4331, 11998, 10437, 256, 8575, 3680, 8881, 11551, 8194, 5884, 8706, 209, 6116, 8410, 1267, 12001, 12014, 3395, 10985, 9744, 4718, 2837, 253, 5994, 10098, 1209, 1776, 3579, 11570, 3584, 8590, 2377, 5086, 6065, 4455, 8477, 11240, 1822, 3409, 8505, 210, 753, 11201, 5575, 8074, 5896, 4296, 186, 9500, 1067, 7082, 373, 6179, 2421, 3628, 8590, 11689, 6489, 6551, 8331, 10160, 1585, 8286, 799, 10449, 8457, 11846, 5133, 10416, 11189, 8187, 8623, 10356, 11588, 2870, 5605, 6259, 1407, 2593, 6225, 7484, 9443, 6445, 3625, 9208, 2332, 431, 11337, 9534, 6147, 5040, 545, 11742, 6332, 6725, 6040, 3370, 7499, 4852, 2916, 808, 9664, 10995, 10026, 12143, 8422, 2811, 3387, 10, 2568, 5567, 7382, 2162, 8864, 11244, 3273, 6476, 4174, 12066, 2462, 1188, 4064, 4948, 4334, 3219, 9572, 9314, 672, 4486, 9624, 4458, 11150, 804, 7908, 1939, 6524, 3338, 4090, 11839, 3566, 4053, 5510, 1824, 3590, 4512, 7475, 6840, 6576, 3581, 4794, 1295, 5474, 7370, 10342, 11576, 6954, 9507, 6341, 7708, 8462, 623, 10455, 1541, 1594, 3792, 8428, 5141, 6225, 7364, 11122, 6508, 2612, 11177, 5824, 2083, 6083, 11117, 11272, 3482, 1941, 9261, 11511, 1737, 11921, 8655, 11129, 8438, 4302, 3417, 5024, 11466, 11899, 9353, 7791, 9025, 7296, 4018, 10424, 7731, 11727, 6659, 2313, 8413, 683, 65, 2686, 4672, 9454, 329, 8409, 4128, 6098, 8959, 483, 8285, 7679, 8206, 11528, 830, 9903, 4553, 1983, 2615, 5720, 7285, 5117, 11315, 6235, 9229, 5817, 8071, 8875, 7024, 8567, 6100, 10668, 205, 7304, 281, 12242, 9947, 1653, 9104, 3412, 6728, 4368, 1804, 6962, 10170, 7739, 3254, 10975, 12197, 1218, 1816, 5613, 313, 7621, 594, 5447, 12164, 8562, 10386, 6368, 9309, 8303, 7136, 7366, 5550, 8623, 4376, 6385, 4930, 3184, 10000, 8112, 8324, 3566, 6386, 10547, 108, 95, 3433, 757, 2675, 8604, 7700, 3169, 4135, 272, 10108, 3674, 4476, 3684, 2662, 12105, 4869, 4321, 10208, 5599, 4868, 9853, 7446, 7440, 4281, 7633, 10743, 5528, 11175, 1841, 1030, 6640, 3909, 274, 1231, 2112, 5318, 8734, 9417, 10719, 10515, 10507, 151, 9255, 5479, 7751, 9110, 10075, 712, 6244, 2837, 6071, 3809, 12200, 6716, 5507, 10742, 5016, 2999, 5379, 8065, 4024, 10958, 8328, 5454, 10131, 6814, 5121, 4739, 132, 11121, 6487, 8948, 3515, 8429, 3096, 3514, 11468, 7402, 3186, 7126, 6968, 9720, 6853, 8190, 7780, 7266, 3759, 6383, 3490, 1828, 4248, 5327, 4740, 9462, 8450, 10998, 6238, 11283, 6074, 8314, 11629, 11905, 10089, 12099, 3489, 2352, 8721, 416, 8068, 8319, 213, 5593, 4978, 2617, 3447, 11486, 5677, 10457, 4227, 209, 6519, 639, 5568, 7873, 11843, 11108];
    // forgefmt: disable-next-line
    uint256[] pkc = [5662797900309780854973796610500849947334657117880689816302353465126500706865, 19773102689601973621062070293263100534733440101750387150077711329493973274058, 14606681890476865709816748627007131256488820167404174518724605890405097603719, 15845234755931409677594030697035096324340457247480758851130851814703350289524, 5524941775098342886171484209767745714294893760953145782448900256027476885810, 15301033023652038200658165594502048003364566882283859976805808429697192567788, 18875246040654000517074755552890901133645669291006567534900678519700207707731, 11843395683334522200668269515783436692309636627649985746204914551011013629864, 8419305811746464065544475584323153271481428319969733938911379662274846467111, 18343417927809591481517183183479503623951147924071925629514120039495430967592, 10007451325105194000131443764495043320645967197761209321537835667210153693191, 779487061150515667795843171268512499191273448454307717194241961063365614179, 14889466660684110621550004892629051623956217990147793956971155241422811501259, 2995124819739638247263964985959552967489690950312509006670204449438399867779, 16698797261630410217796026169071784061995015858612862963622742163763641855864, 13129716852402613948762495927854872029721399215764359316540986925328111906305, 8620514528683669238836845045565231437047299941974001946945409334379184590766, 5184181041252042291984928267300200431567362250531180743278111084485128161037, 15555356690664302555826193017277818624355238475260445618945780405430020481200, 19264077329172342356817033544893125657281034846341493111114385757819435942150, 8708853592016768361541207473719404660232059936330605270802350059910738161396, 21018648773068189736719755689803981281912117625241701774409626083005150670687, 267026197077955750670312407002345619518873569178283514941902712705828521229, 14359242962640593260752841229079220345384234239741953227891227234975247894859, 8320354099602406351863744856415421903486499003224102136141447162113864442068, 17564344674783852357247325589247473882830766139750808683064015010041459773180, 12601232530472338126510941067000966999586933909071534455578397454667291628041, 17820703520112071877812607241017358905719406745793395857586668204300579510382, 20977963461796112341763752649093803701879441191599296283127418471622134932903, 5627732773047409045458881938100601008133088383905060686572856121439798106767, 2602661464000108367786729796742170641292899005030508211661215565063118195399, 20110282897068872581106488251090599973196923955248066799683528955504800771309];
    bytes message =
        "\x4d\x79\x20\x6e\x61\x6d\x65\x20\x69\x73\x20\x52\x65\x6e\x61\x75\x64\x20\x66\x72\x6f\x6d\x20\x5a\x4b\x4e\x4f\x58\x21\x21\x21\x21";

    function setUp() public {
        // bytes32 salt = keccak256(abi.encodePacked("ZKnox"));
        falcon = new ZKNOX_falcon();
        ethfalcon = new ZKNOX_ethfalcon();
        ethepervier = new ZKNOX_ethepervier();
    }

    function testBenchmarkNTT() public view {
        // a NTT of a polynomial of degree 512
        uint256 gasStart = gasleft();
        // this doesn't make sense because pkc is already in NTT domain
        uint256[] memory pkc_ntt = _ZKNOX_NTTFW_vectorized(pkc);
        uint256 gasUsed = gasStart - gasleft();
        console.log("NTT cost:              ", gasUsed);
        pkc_ntt[0] = 0; // in order to remove warnings
    }

    function testBenchmarkiNTT() public view {
        // a NTT of a polynomial of degree 512
        uint256 gasStart = gasleft();
        // Compute the inverse NTT of the pk
        uint256[] memory pkc_invntt = _ZKNOX_NTTINV_vectorized(pkc);
        uint256 gasUsed = gasStart - gasleft();
        console.log("iNTT cost:             ", gasUsed);
        pkc_invntt[0] = 0; // in order to remove warnings
    }

    function testBenchFalconCore()
        public
        view
    {

        // verify the core algorithm of Falcon
        // forgefmt: disable-next-line
        uint256[32] memory tmp_s2 = [21299671975787483454790402018496259712325154098698828370862796902048963440524, 226482644561092801897613003311591793491464477287443953390217386369311322015, 122241768215234212762829461233206915525091542269434133652196666067046117266, 17998600124730622827465990899026975431920967581729901424009026369714323515, 21156552726390114447912652470199481904643883857534790873521589824973084372941, 166414638319359694539675323431761741043307735201951903340794358417336827986, 21451614924126190838060080098931214529037792752475566277715416002725544210312, 21619468086225573149428575687681504604739876340506400383036250394919471022197, 21354444752013408991527203716041803392832851588841014790823564527783031812068, 40637590359720631756101950821212066384251755770640449468737583935557545897, 304228256065111465341595114396824176330096899003450390299007497041692078041, 21151253506241730037214008021307237001806313126801305624031661634239557730460, 120468666454760826934618408257990251737086348137219304739400371046851555278, 21432184616009917607269660114506949891222288898806366184877936761055983775547, 21518433259746648670717331844331216366351090502579212557941552317525499248692, 21647739391709647690802008982923383029008210205554608875280491239402655592366, 40964884159568868602122268505814142421304112730977685866577034491435560785, 134281644066644075952295235160147398920909894081157681132255108571974992066, 21691911382121948660240887888667851751942217725501296445477391473357788557231, 21696886004442863450261761150950129663128179474933041610268931151502459731982, 404610463137767168486106082172428680248662411074833208161405963809904656482, 91879772852911984237518509646383898093449686531778472006833239623202058238, 164644178638518845312982181671048221605431573972257798857853361098856857728, 21574973686812103371699961732701920024338479494313547651614704632000563981947, 175245562549033153724892418326575979114467271119590358939154166249244262574, 266796661751086246441058213427294247068745218289871840260809319750822854698, 97183598268319474873784359172567103256595448544293089836817574924407079179, 86576072396373326456075399840772528545065258380973319625452012942335356845, 208817323379001257158570910002768001779019792526753026636949068845966164023, 21082022843605336096552002185742069167530055866640863550830674291014571601566, 21458687219065978677109946072223714604125558224559441365838144304995083419665, 666423492797790993818496611161184796611027378170087972178025157084774543202];
        uint256[] memory s2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            s2[i] = tmp_s2[i];
        } // forgefmt: disable-next-line
        uint256[512] memory _hashed = [uint256(4643), 8890, 7599, 3818, 3920, 156, 1149, 8934, 2177, 8085, 3571, 5176, 6195, 2666, 3782, 1481, 9991, 1314, 6137, 9729, 10248, 1211, 7215, 6779, 4329, 285, 5149, 4641, 5853, 4677, 10238, 10810, 12061, 8024, 547, 9764, 11118, 4432, 1206, 9724, 12243, 3217, 1119, 9214, 9297, 9115, 5399, 2488, 159, 9702, 12203, 11928, 2696, 9069, 2892, 1436, 7397, 9593, 3074, 2929, 3722, 3847, 4011, 7200, 7563, 2968, 6857, 272, 10484, 7628, 3326, 2629, 5481, 4177, 2713, 6396, 2392, 5669, 6300, 11422, 4572, 4440, 3638, 562, 7443, 5049, 1336, 923, 6322, 9624, 7510, 5699, 10217, 11982, 2092, 1242, 8500, 3854, 6752, 4606, 2039, 8910, 8149, 11253, 1588, 4729, 9885, 2526, 3485, 2216, 6910, 2091, 10835, 6624, 1778, 1195, 9435, 3681, 11191, 10268, 195, 4677, 2600, 1128, 5404, 5380, 9977, 1839, 6141, 4549, 8937, 2473, 7771, 7985, 1914, 10772, 3445, 3364, 11784, 4657, 2323, 8788, 2472, 4769, 3011, 8595, 3074, 1892, 6376, 3904, 3446, 7516, 4415, 10366, 9636, 11954, 11878, 3180, 11109, 5140, 6362, 6127, 3822, 8578, 2859, 2387, 9325, 3062, 605, 10202, 8984, 2613, 3375, 5895, 6762, 192, 7622, 8228, 2938, 4234, 1018, 4259, 9378, 10922, 11652, 9530, 9314, 12124, 6133, 11593, 11858, 9038, 1367, 1436, 5660, 3774, 11685, 5890, 5036, 11295, 4455, 3855, 8347, 7870, 4321, 2915, 10110, 6989, 12087, 2667, 6395, 6842, 6468, 3482, 5386, 1876, 5795, 5000, 4194, 1668, 136, 11289, 8610, 4883, 11046, 9285, 3780, 10377, 4139, 4213, 4989, 6218, 908, 2395, 8042, 3832, 6410, 4365, 1574, 10695, 10425, 1778, 3156, 2475, 5593, 6396, 10559, 8645, 5170, 4844, 759, 6009, 7843, 5304, 8342, 8425, 11498, 5621, 10536, 11707, 11507, 1208, 11843, 6613, 9824, 1545, 5848, 917, 1781, 4129, 3054, 1140, 9875, 8446, 3651, 607, 10838, 5784, 5525, 5344, 2376, 8152, 7705, 5265, 6002, 8928, 2477, 201, 4861, 9317, 9587, 8528, 2301, 12104, 8797, 5737, 10792, 2983, 8754, 11072, 11951, 1319, 9808, 4398, 4209, 1498, 10667, 4630, 1844, 7433, 1903, 5552, 11065, 9401, 7713, 4533, 10525, 10555, 1364, 3297, 2995, 12002, 9199, 3805, 11585, 11133, 8717, 7370, 7154, 9828, 9518, 11217, 3095, 11110, 3330, 5230, 2807, 7888, 3313, 11804, 8944, 4971, 7036, 10781, 5117, 4554, 2957, 10934, 2954, 1881, 4816, 4556, 8442, 5080, 5897, 1248, 9823, 1271, 1577, 2341, 3133, 6588, 8798, 5466, 2465, 2429, 10531, 7561, 9941, 4334, 716, 5606, 8928, 9566, 4675, 533, 5409, 1384, 1624, 3916, 6110, 3631, 787, 9276, 644, 3279, 10623, 8724, 293, 12108, 5, 3878, 9924, 7676, 3866, 11394, 8104, 78, 1641, 10334, 4568, 984, 7328, 5142, 10013, 8221, 7457, 4188, 1112, 9472, 819, 6785, 1064, 5617, 10254, 1028, 4622, 5498, 9294, 3685, 2143, 5292, 4317, 11731, 5047, 6368, 158, 832, 1242, 6384, 6926, 2302, 5521, 2676, 11311, 7986, 3152, 2622, 7745, 7942, 3125, 10401, 4920, 3832, 6122, 10299, 2418, 7563, 7429, 3658, 818, 3972, 10763, 8486, 4864, 9401, 6514, 8531, 2133, 9360, 1175, 3871, 8258, 3723, 11227, 2871, 550, 7585, 7780, 1988, 6916, 3820, 1291, 8115, 4404, 11804, 10995, 200, 10546, 10324, 11567, 2950, 7969, 3232, 3366, 8458, 12075, 11551, 6115, 5759, 8152, 5996, 6451, 10922, 9977, 6001, 2342, 10608, 10661, 4679, 12055, 10269, 3864, 10006, 7852, 9161, 9654, 9147, 8081, 5935, 7014, 5112];
        uint256[] memory hashed = new uint256[](512);
        for (uint256 i = 0; i < 512; i++) {
            hashed[i] = _hashed[i];
        }
        uint256 gasStart = gasleft();
        bool result = falcon_core(s2, pkc, hashed);
        uint256 gasUsed = gasStart - gasleft();
        console.log("Falcon core cost:      ", gasUsed);
        assertEq(true, result);
    }

    function testBenchHashToPointNIST() public view {
        // Hash to point NIST (with SHAKE256)
        bytes memory salt =
            "\x4b\x09\x9f\x8e\x30\x0f\x01\xb8\x65\x0f\x1f\x4b\x1d\x8f\xcf\x3f\x3c\xb5\x3f\xb8\xe9\xeb\x2e\xa2\x03\xbd\xc9\x70\xf5\x0a\xe5\x54\x28\xa9\x1f\x7f\x53\xac\x26\x6b"; // forgefmt: disable-next-line
        uint256[512] memory expected_hash = [uint256(2578), 9409,5446,11883,3141,10060,11878,2420,7205,5080,10356,9921,7102,11023,6011,9087,3599,20,7901,11170,5751,3435,9682,7761,751,10853,2087,138,9813,9210,5348,625,7844,7825,1395,3704,9025,1402,1686,6174,1459,8095,1538,5296,3942,4491,11654,11409,8189,6166,5299,9446,7070,1023,7288,575,4127,4182,9690,667,1927,1261,6218,7417,11916,2011,5526,7301,6685,7671,1196,12278,1340,11667,7567,4136,10605,4460,2740,6759,1002,754,2266,1417,12188,3713,10022,7250,11942,2047,2118,9458,9926,7800,11434,1225,8524,8696,6461,2345,6570,3212,9584,11852,902,5535,8020,11218,5232,511,2979,3417,11281,10322,1843,11790,9924,12085,2168,11716,8611,4007,251,8772,11543,2578,11631,10600,11424,5082,9825,11065,247,1753,333,12060,10996,8341,8581,11516,7970,10085,2403,10978,9587,6629,6112,7858,8080,7677,3913,5637,5152,11786,7969,5935,6137,5239,12139,3724,9284,10885,3224,11068,10053,4605,11219,11437,7357,8408,11196,2873,5926,4809,9957,3091,9672,1994,4145,5127,897,1047,5719,8405,5531,9439,1373,5438,3809,11485,6882,3195,8979,7196,5540,4256,11085,8518,1031,3717,7876,89,2310,923,1685,5207,12263,3550,1723,6275,3451,5655,2160,1591,9791,8490,7642,8372,11105,8818,8291,959,1466,7057,223,1507,5593,3827,3875,6597,7681,11173,8013,1854,10372,3488,9631,6907,2911,9548,8230,2931,6267,4819,7631,6094,4903,9817,1684,8998,2386,11461,9997,11116,6432,5571,6727,7972,10041,9139,4132,6475,11364,5765,7761,5555,10409,11991,10168,11657,12040,5071,1896,11967,4211,8906,4578,2693,5837,9493,1420,6334,5660,3658,5819,10837,2481,10373,5906,7465,7562,5848,4466,555,10501,8367,8391,11279,3281,6665,1365,10369,1647,1571,8623,8190,2287,2200,6337,6082,8137,10740,7609,8577,1469,6001,266,2833,6206,8418,6137,10730,4439,8434,10389,9765,7615,3453,9780,2428,10821,4544,12266,4477,4763,3413,3227,9305,11773,3566,4940,1919,1228,4795,5853,10174,10994,6469,10058,965,7086,7250,7799,6692,7233,6027,3006,3989,4753,1429,7744,2584,9303,11600,5184,2175,581,1243,4601,3750,4732,5698,5537,11955,4306,483,318,647,9607,6258,11739,17,11364,6217,8753,12215,779,3718,6078,1005,1894,8518,4480,789,8194,9874,10458,10601,10640,10834,3488,6354,10427,11774,7439,10555,5983,10090,4676,2705,4003,6519,4434,6003,4525,8094,3662,4740,6447,5414,4424,7459,8855,8159,10700,86,5077,8353,10565,10555,6325,2427,835,6946,6906,4329,9515,8622,1665,7462,6355,5039,6742,519,8233,6556,8955,11872,7619,1059,6647,2277,5209,81,8776,2841,447,3836,3777,8029,3574,11305,3874,11476,1641,1857,5582,8087,8932,9699,6948,807,1648,12103,3420,9708,8352,9546,2769,12152,12086,1743,6860,3325,4490,463,11764,9721,1450,12103,4950,5458,8619,409,4975,5939,3304,5688,3555,957,3900,6425,6146,8633,11584,1050,2687,4941,7067,9688,1913,11296];
        uint256 gasStart = gasleft();
        uint256[] memory hash = hashToPointNIST(salt, message);
        uint256 gasUsed = gasStart - gasleft();
        console.log("NIST HashToPoint cost: ", gasUsed);
        for (uint256 i = 0; i < n; i++) {
            assertEq(hash[i], expected_hash[i]);
        }
    }

    function testBenchHashToPointRIP() public view {
        // Hash to point RIP (with Keccak-CTR PRNG)
        bytes memory salt =
            "\x46\xb9\xdd\x2b\x0b\xa8\x8d\x13\x23\x3b\x3f\xeb\x74\x3e\xeb\x24\x3f\xcd\x52\xea\x62\xb8\x1b\x82\xb5\x0c\x27\x64\x6e\xd5\x76\x2f\xd7\x5d\xc4\xdd\xd8\xc0\xf2\x00"; // forgefmt: disable-next-line
        uint256[512] memory expected_hash = [uint256(9279), 7796,1440,6137,9955,9207,10759,5405,1680,11905,5141,4342,11052,2239,851,7983,8188,2461,2085,330,8996,12242,580,1960,4817,971,6079,4907,10927,8965,12131,1628,188,8227,9734,10483,9969,4713,1551,1224,9991,8752,11420,7434,3984,7708,7623,6207,7877,7458,3888,8689,11950,5005,3559,1691,6999,11886,6534,3710,9262,9077,511,873,7364,5243,12164,5201,2506,2825,5914,1126,327,423,10757,1355,248,10843,8288,10947,2873,6496,8197,7802,3148,9801,1173,1576,5230,4231,9229,11575,12236,814,5308,10168,8031,4140,9954,7696,9060,4239,275,4431,422,1191,7868,5843,2407,5569,9313,9993,1215,5986,11913,5583,1145,2293,9021,2233,6360,10167,3379,2790,6171,12107,8872,11483,3016,153,10554,836,9163,5628,7813,2843,7959,5312,5597,10763,580,5296,1659,10278,10812,975,4094,1752,638,6324,490,1940,11132,6870,7623,11870,7349,7949,10461,4628,4146,5599,3787,9753,9895,7551,8654,244,1906,567,5414,5632,8108,8416,11449,6916,5575,10149,10516,5932,8723,3699,1156,3121,11533,5749,6378,4095,716,11232,4545,3885,5719,1174,6388,5816,6584,6935,6982,3665,12079,8495,10667,3550,8533,2766,120,8258,2983,1325,12193,11179,7465,2638,7919,2679,371,1160,12149,4543,11876,10180,6522,613,5414,11987,10616,6051,9999,3761,9296,254,2550,1471,5787,6034,5352,4623,11503,10287,1538,931,9711,8655,10341,2961,7560,6470,3496,6671,2316,12028,7205,458,8551,11622,7591,9474,5617,8277,6338,9255,5418,4816,5731,2011,3169,4038,929,10295,10186,7360,4520,5621,2600,1492,6416,3745,9365,9093,2562,8806,6562,1878,1149,11775,8959,2410,11490,11975,1976,9543,6235,2401,11702,3696,6138,6119,9895,8646,150,11140,8277,2436,1174,11692,5447,12156,7583,8902,10607,241,3289,6921,405,7276,2355,5402,10465,6658,6758,6497,11067,2940,5425,7348,8677,6593,2406,10035,76,9883,4554,4984,4044,7660,9999,2321,3595,7416,5104,7334,4832,5363,10447,10896,9371,9034,2360,2546,8776,4910,4472,9639,7016,5250,7160,9247,10446,7472,3215,4366,6434,10758,6149,417,5501,2448,11221,7260,4369,4171,8954,9354,11624,2049,7865,3658,6671,11070,9803,7463,5842,1578,6250,6437,6953,1226,6944,2034,202,699,2026,10667,102,3055,3117,7307,5764,371,920,3964,8854,8058,5624,6794,12287,4791,6957,7542,4408,989,2209,7419,10693,4850,7252,9637,1777,7645,3102,4172,4995,5538,3645,2084,4926,1827,10908,8314,10173,7098,229,9091,1418,4860,586,7697,10278,8168,5544,11589,1533,4529,8393,7401,5320,7627,182,7796,9632,6811,6554,5216,8861,20,8143,6056,10030,978,2467,11920,6561,1215,2872,10449,151,8072,6368,11630,252,1290,9916,8664,8374,8726,1022,7155,2485,10921,12093,7182,2706,7659,8781,2791,1606,7694,2541,7886,1740,2655,6865,7671,9827,5166,816,3085,3490,11216,3501,7665,9258,5728,7889,956,10628,11918,580,10850,9286,3869];
        uint256 gasStart = gasleft();
        uint256[] memory hash = hashToPointRIP(salt, message);
        uint256 gasUsed = gasStart - gasleft();
        console.log("RIP HashToPoint cost:  ", gasUsed);
        for (uint256 i = 0; i < n; i++) {
            assertEq(hash[i], expected_hash[i]);
        }
    }

    function testBenchDecompressKAT()
        public
        view
    {

        // a verificaiton of Falcon signature from NIST KAT vectors
        // forgefmt: disable-next-line
        bytes memory pk=hex"096BA86CB658A8F445C9A5E4C28374BEC879C8655F68526923240918074D0147C03162E4A49200648C652803C6FD7509AE9AA799D6310D0BD42724E0635920186207000767CA5A8546B1755308C304B84FC93B069E265985B398D6B834698287FF829AA820F17A7F4226AB21F601EBD7175226BAB256D8888F009032566D6383D68457EA155A94301870D589C678ED304259E9D37B193BC2A7CCBCBEC51D69158C44073AEC9792630253318BC954DBF50D15028290DC2D309C7B7B02A6823744D463DA17749595CB77E6D16D20D1B4C3AAD89D320EBE5A672BB96D6CD5C1EFEC8B811200CBB062E473352540EDDEF8AF9499F8CDD1DC7C6873F0C7A6BCB7097560271F946849B7F373640BB69CA9B518AA380A6EB0A7275EE84E9C221AED88F5BFBAF43A3EDE8E6AA42558104FAF800E018441930376C6F6E751569971F47ADBCA5CA00C801988F317A18722A29298925EA154DBC9024E120524A2D41DC0F18FD8D909F6C50977404E201767078BA9A1F9E40A8B2BA9C01B7DA3A0B73A4C2A6B4F518BBEE3455D0AF2204DDC031C805C72CCB647940B1E6794D859AAEBCEA0DEB581D61B9248BD9697B5CB974A8176E8F910469CAE0AB4ED92D2AEE9F7EB50296DAF8057476305C1189D1D9840A0944F0447FB81E511420E67891B98FA6C257034D5A063437D379177CE8D3FA6EAF12E2DBB7EB8E498481612B1929617DA5FB45E4CDF893927D8BA842AA861D9C50471C6D0C6DF7E2BB26465A0EB6A3A709DE792AAFAAF922AA95DD5920B72B4B8856C6E632860B10F5CC08450003671AF388961872B466400ADB815BA81EA794945D19A100622A6CA0D41C4EA620C21DC125119E372418F04402D9FA7180F7BC89AFA54F8082244A42F46E5B5ABCE87B50A7D6FEBE8D7BBBAC92657CBDA1DB7C25572A4C1D0BAEA30447A865A2B1036B880037E2F4D26D453E9E913259779E9169B28A62EB809A5C744E04E260E1F2BBDA874F1AC674839DDB47B3148C5946DE0180148B7973D63C58193B17CD05D16E80CD7928C2A338363A23A81C0608C87505589B9DA1C617E7B70786B6754FBB30A5816810B9E126CFCC5AA49326E9D842973874B6359B5DB75610BA68A98C7B5E83F125A82522E13B83FB8F864E2A97B73B5D544A7415B6504A13939EAB1595D64FAF41FAB25A864A574DE524405E878339877886D2FC07FA0311508252413EDFA1158466667AFF78386DAF7CB4C9B850992F96E20525330599AB601D454688E294C8C3E";// forgefmt: disable-next-line
        bytes memory sm=hex"026833B3C07507E4201748494D832B6EE2A6C93BFF9B0EE343B550D1F85A3D0DE0D704C6D17842951309D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8290765843D1E460D17A527D2BCA405BD55BBC7DA09A8C620BE0AF4A767D9DB96B80F55E466676751EAABA7B93B86D71132DAA0EB376782B9EEE37519CE10FDD33FE9F29312C31D8736206D165CF4C528AA3DDC017845E1F0DD5B0A44FF961C42D874A95533E5B438982F524CA954D87533BFBE42C63FF2ABC77A34C79DB55A99171BBCB72C842A6530AF2F753F0C34AC632F9F1E7949F0BF6C67665B27722A8857D626B6FF1A136D923A39F4069B7477FF946E5247A6627791D49B59EDC9E2525A860E6E9828D18F64A9F17222E8166A02453859BBDA0B8186D8C9928BB571E4146401D7430E225904673AD21CCAC54C146C248A1DD69AB6491E901D6D71B152155BE97DE057F3916A3F1B4273308C29B2F4D9697167B90681B1583ED930A71E990467DEA368134BECEEBD597F9BEC922E816F1B0570D728F4AE0464C1F797657F87A4E52DCDCAEB9272662EA66D7C6CD8781B31AF555AD93F5F65E75816CB8DC306BB67E592B5261BACA7C509629EA2AF8ABB80CBA89EE535B76DFD9CCBBE3BF48F2BC8AA34B26E1103291053F5CB8DE3A45AFA5A76DF8B2122ED2C82FBCF2259290D41A14F86B12F35F5D49762B34CFF13EE7E42EDEC70201D7F37C33316288FA3078E36E58108865C3CFE263D563692043DECC62F3426F86061285B7B1B336F56FF41BB65E9CD6D9B92FD90F864AA1C923CB8C755F5CDE1770D862595427149D7721AAAB5D194AEA9ACDECA15BE43CBA6A62B5A33909E9FC4DA1C5814FBD7CD6A2FA572E318B42C6C319140B86E66392580A11A2B431F44C1F9270E4F7B2490F3B325A9977A71A575915636635B9969DBD6D220B24C3D99CEBBBD834B88222BD08C3ABE124E80";

        uint256[] memory kpub;
        uint256[] memory s2;
        bytes memory salt;
        bytes memory m;

        uint256 gasStart = gasleft();
        // KAT vector 0 has mlen = 33
        (kpub, s2, salt, m) = decompress_KAT(pk, sm, 33);
        uint256[] memory ntth = _ZKNOX_NTT_Compact(_ZKNOX_NTTFW_vectorized(kpub));
        uint256 gasUsed = gasStart - gasleft();
        console.log("Decompress KAT cost:   ", gasUsed);
    }

    function testBenchVerifyNISTCompliant() public view {
        // forgefmt: disable-next-line
        bytes memory pk=hex"096BA86CB658A8F445C9A5E4C28374BEC879C8655F68526923240918074D0147C03162E4A49200648C652803C6FD7509AE9AA799D6310D0BD42724E0635920186207000767CA5A8546B1755308C304B84FC93B069E265985B398D6B834698287FF829AA820F17A7F4226AB21F601EBD7175226BAB256D8888F009032566D6383D68457EA155A94301870D589C678ED304259E9D37B193BC2A7CCBCBEC51D69158C44073AEC9792630253318BC954DBF50D15028290DC2D309C7B7B02A6823744D463DA17749595CB77E6D16D20D1B4C3AAD89D320EBE5A672BB96D6CD5C1EFEC8B811200CBB062E473352540EDDEF8AF9499F8CDD1DC7C6873F0C7A6BCB7097560271F946849B7F373640BB69CA9B518AA380A6EB0A7275EE84E9C221AED88F5BFBAF43A3EDE8E6AA42558104FAF800E018441930376C6F6E751569971F47ADBCA5CA00C801988F317A18722A29298925EA154DBC9024E120524A2D41DC0F18FD8D909F6C50977404E201767078BA9A1F9E40A8B2BA9C01B7DA3A0B73A4C2A6B4F518BBEE3455D0AF2204DDC031C805C72CCB647940B1E6794D859AAEBCEA0DEB581D61B9248BD9697B5CB974A8176E8F910469CAE0AB4ED92D2AEE9F7EB50296DAF8057476305C1189D1D9840A0944F0447FB81E511420E67891B98FA6C257034D5A063437D379177CE8D3FA6EAF12E2DBB7EB8E498481612B1929617DA5FB45E4CDF893927D8BA842AA861D9C50471C6D0C6DF7E2BB26465A0EB6A3A709DE792AAFAAF922AA95DD5920B72B4B8856C6E632860B10F5CC08450003671AF388961872B466400ADB815BA81EA794945D19A100622A6CA0D41C4EA620C21DC125119E372418F04402D9FA7180F7BC89AFA54F8082244A42F46E5B5ABCE87B50A7D6FEBE8D7BBBAC92657CBDA1DB7C25572A4C1D0BAEA30447A865A2B1036B880037E2F4D26D453E9E913259779E9169B28A62EB809A5C744E04E260E1F2BBDA874F1AC674839DDB47B3148C5946DE0180148B7973D63C58193B17CD05D16E80CD7928C2A338363A23A81C0608C87505589B9DA1C617E7B70786B6754FBB30A5816810B9E126CFCC5AA49326E9D842973874B6359B5DB75610BA68A98C7B5E83F125A82522E13B83FB8F864E2A97B73B5D544A7415B6504A13939EAB1595D64FAF41FAB25A864A574DE524405E878339877886D2FC07FA0311508252413EDFA1158466667AFF78386DAF7CB4C9B850992F96E20525330599AB601D454688E294C8C3E";// forgefmt: disable-next-line
        bytes memory sm=hex"026833B3C07507E4201748494D832B6EE2A6C93BFF9B0EE343B550D1F85A3D0DE0D704C6D17842951309D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8290765843D1E460D17A527D2BCA405BD55BBC7DA09A8C620BE0AF4A767D9DB96B80F55E466676751EAABA7B93B86D71132DAA0EB376782B9EEE37519CE10FDD33FE9F29312C31D8736206D165CF4C528AA3DDC017845E1F0DD5B0A44FF961C42D874A95533E5B438982F524CA954D87533BFBE42C63FF2ABC77A34C79DB55A99171BBCB72C842A6530AF2F753F0C34AC632F9F1E7949F0BF6C67665B27722A8857D626B6FF1A136D923A39F4069B7477FF946E5247A6627791D49B59EDC9E2525A860E6E9828D18F64A9F17222E8166A02453859BBDA0B8186D8C9928BB571E4146401D7430E225904673AD21CCAC54C146C248A1DD69AB6491E901D6D71B152155BE97DE057F3916A3F1B4273308C29B2F4D9697167B90681B1583ED930A71E990467DEA368134BECEEBD597F9BEC922E816F1B0570D728F4AE0464C1F797657F87A4E52DCDCAEB9272662EA66D7C6CD8781B31AF555AD93F5F65E75816CB8DC306BB67E592B5261BACA7C509629EA2AF8ABB80CBA89EE535B76DFD9CCBBE3BF48F2BC8AA34B26E1103291053F5CB8DE3A45AFA5A76DF8B2122ED2C82FBCF2259290D41A14F86B12F35F5D49762B34CFF13EE7E42EDEC70201D7F37C33316288FA3078E36E58108865C3CFE263D563692043DECC62F3426F86061285B7B1B336F56FF41BB65E9CD6D9B92FD90F864AA1C923CB8C755F5CDE1770D862595427149D7721AAAB5D194AEA9ACDECA15BE43CBA6A62B5A33909E9FC4DA1C5814FBD7CD6A2FA572E318B42C6C319140B86E66392580A11A2B431F44C1F9270E4F7B2490F3B325A9977A71A575915636635B9969DBD6D220B24C3D99CEBBBD834B88222BD08C3ABE124E80";

        uint256[] memory kpub;
        uint256[] memory s2;

        uint256[] memory cs2;
        bytes memory salt;
        bytes memory m;

        uint256 gasStart = gasleft();
        // KAT vector 0 has mlen = 33
        (kpub, s2, salt, m) = decompress_KAT(pk, sm, 33);
        uint256[] memory ntth = _ZKNOX_NTT_Compact(_ZKNOX_NTTFW_vectorized(kpub));
        cs2 = _ZKNOX_NTT_Compact(s2);
        bool result = falcon.verify(m, salt, cs2, ntth);
        uint256 gasUsed = gasStart - gasleft();
        console.log("Verify NIST compliant cost:", gasUsed);
        assertEq(true, result);
    }

    function testBenchVerifyNIST()
        public
        view
    {

        // a verificaiton of Falcon signature
        // forgefmt: disable-next-line
        uint256[32] memory tmp_s2 = [21299671975787483454790402018496259712325154098698828370862796902048963440524, 226482644561092801897613003311591793491464477287443953390217386369311322015, 122241768215234212762829461233206915525091542269434133652196666067046117266, 17998600124730622827465990899026975431920967581729901424009026369714323515, 21156552726390114447912652470199481904643883857534790873521589824973084372941, 166414638319359694539675323431761741043307735201951903340794358417336827986, 21451614924126190838060080098931214529037792752475566277715416002725544210312, 21619468086225573149428575687681504604739876340506400383036250394919471022197, 21354444752013408991527203716041803392832851588841014790823564527783031812068, 40637590359720631756101950821212066384251755770640449468737583935557545897, 304228256065111465341595114396824176330096899003450390299007497041692078041, 21151253506241730037214008021307237001806313126801305624031661634239557730460, 120468666454760826934618408257990251737086348137219304739400371046851555278, 21432184616009917607269660114506949891222288898806366184877936761055983775547, 21518433259746648670717331844331216366351090502579212557941552317525499248692, 21647739391709647690802008982923383029008210205554608875280491239402655592366, 40964884159568868602122268505814142421304112730977685866577034491435560785, 134281644066644075952295235160147398920909894081157681132255108571974992066, 21691911382121948660240887888667851751942217725501296445477391473357788557231, 21696886004442863450261761150950129663128179474933041610268931151502459731982, 404610463137767168486106082172428680248662411074833208161405963809904656482, 91879772852911984237518509646383898093449686531778472006833239623202058238, 164644178638518845312982181671048221605431573972257798857853361098856857728, 21574973686812103371699961732701920024338479494313547651614704632000563981947, 175245562549033153724892418326575979114467271119590358939154166249244262574, 266796661751086246441058213427294247068745218289871840260809319750822854698, 97183598268319474873784359172567103256595448544293089836817574924407079179, 86576072396373326456075399840772528545065258380973319625452012942335356845, 208817323379001257158570910002768001779019792526753026636949068845966164023, 21082022843605336096552002185742069167530055866640863550830674291014571601566, 21458687219065978677109946072223714604125558224559441365838144304995083419665, 666423492797790993818496611161184796611027378170087972178025157084774543202];
        uint256[] memory s2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            s2[i] = tmp_s2[i];
        }
        bytes memory salt =
            "\xab\x0b\xae\x31\x63\x39\x89\x43\x04\xe3\x58\x77\xb0\xc2\x8a\x9b\x1f\xd1\x66\xc7\x96\xb9\xcc\x25\x8a\x06\x4a\x8f\x57\xe2\x7f\x2a\x5b\x8d\x54\x8a\x72\x8c\x94\x44";
        uint256 gasStart = gasleft();
        bool result = falcon.verify(message, salt, s2, pkc);
        uint256 gasUsed = gasStart - gasleft();
        console.log("Verify NIST cost:      ", gasUsed);
        assertEq(true, result);
    }

    function testBenchVerifyRIP()
        public
        view
    {

        // a verification of ETHFalcon signature
        // signature s2 = [331, 161, 11828, 123, 32, 12109, 173, 13, 51, 44, 12170, 229, 6, 12196, 146, 20, 312, 12194, 11942, 12047, 12129, 100, 12052, 75, 12226, 272, 12185, 13, 89, 145, 209, 102, 30, 88, 85, 12239, 215, 174, 12000, 12249, 12213, 23, 338, 11953, 12177, 12143, 12270, 12259, 42, 353, 149, 12269, 12019, 12134, 9, 12078, 12197, 12150, 49, 12155, 400, 11866, 11971, 12127, 12287, 172, 12226, 179, 12122, 12037, 212, 12225, 12115, 44, 244, 258, 12222, 12269, 326, 12187, 256, 12248, 94, 399, 341, 11698, 6, 12184, 12286, 12288, 71, 11901, 12119, 11931, 11919, 12199, 98, 251, 152, 12213, 52, 12226, 73, 12040, 148, 372, 45, 12116, 139, 289, 12109, 12210, 47, 8, 12163, 12125, 160, 12287, 12270, 212, 87, 269, 4, 12012, 12238, 293, 46, 30, 15, 12052, 203, 36, 12286, 213, 10, 12122, 12130, 102, 12188, 90, 12240, 191, 9, 12052, 11957, 12244, 54, 60, 12105, 12043, 12025, 297, 12288, 14, 12265, 250, 12016, 120, 194, 12280, 12262, 239, 146, 12246, 165, 12175, 12193, 16, 158, 12190, 12236, 118, 12183, 20, 12098, 4, 12247, 240, 12238, 12135, 12120, 64, 316, 12156, 144, 12166, 12226, 12103, 11994, 65, 12201, 167, 36, 190, 209, 36, 23, 6, 133, 11781, 146, 12040, 232, 12039, 322, 8, 67, 108, 12225, 219, 12178, 164, 12251, 12226, 236, 70, 126, 54, 5, 80, 12185, 11, 24, 12175, 12276, 12166, 242, 11999, 263, 12039, 12068, 29, 12085, 107, 94, 12226, 29, 40, 163, 12228, 12028, 369, 107, 12221, 60, 12135, 12140, 21, 176, 209, 88, 12268, 12108, 12190, 29, 51, 24, 11968, 144, 11975, 110, 12241, 291, 12180, 308, 11987, 175, 12287, 12154, 12089, 12170, 59, 180, 273, 295, 96, 11942, 12006, 12069, 17, 12280, 89, 12135, 91, 199, 178, 154, 291, 12237, 63, 12271, 27, 12154, 12275, 85, 12160, 60, 143, 133, 240, 12219, 12166, 94, 112, 59, 64, 12265, 105, 12167, 208, 49, 12240, 43, 112, 196, 134, 12212, 12235, 56, 12066, 12236, 12183, 16, 12280, 224, 279, 12161, 209, 12058, 12071, 97, 344, 100, 178, 212, 47, 12157, 12236, 99, 205, 12129, 13, 12092, 11983, 12164, 12183, 145, 100, 12277, 38, 73, 12241, 12223, 25, 86, 12122, 12098, 12123, 12250, 239, 12244, 11974, 304, 11961, 12260, 147, 135, 184, 121, 12099, 11937, 12011, 166, 93, 65, 314, 336, 71, 12176, 74, 12245, 323, 12242, 12032, 12207, 12080, 13, 12257, 9, 327, 119, 49, 151, 105, 12063, 12167, 12032, 287, 12282, 12041, 12241, 12051, 18, 12200, 84, 12240, 65, 12122, 12176, 12287, 11966, 37, 12128, 97, 202, 71, 12166, 12212, 12287, 122, 12078, 12242, 12274, 20, 12288, 71, 233, 89, 12279, 11865, 110, 12172, 12108, 12135, 164, 54, 380, 108, 57, 45, 12179, 12197, 12273, 94, 12188, 12142, 11969, 12011, 12155, 12106, 136, 18, 161, 186, 12136, 64, 12253, 103, 11926, 12275, 142, 12204, 12126, 93, 12066, 12124, 12228, 12147, 196, 12184, 12076, 102, 12132, 12284, 12280, 12150, 12230, 12081, 12119, 12109, 266, 29, 62, 112, 12234, 12260, 12047, 79, 209, 12220, 122, 12027, 164, 36, 69, 240, 12232, 1, 12235, 0, 25, 32, 12070, 160, 63, 191, 81, 12097, 122, 148, 12172, 12082]
        // forgefmt: disable-next-line
        uint256[32] memory tmp_s2 = [35340882464924523541995235154197297331698212535822337674871285992432664907, 180224035295898734967424559955110864706259919802156795967147536627173294392, 21660108970659236332012478115952358326918007598343581207077716353317091147806, 21426877096970411006463900407158094543758079600974377313834920144686872068138, 21532573972444033887945810679016838468960936465445605310938766495257100824575, 21554088683744040996748006764668557361486174635377514903964211445294077313280, 21573529119057153769253416776347610441096552414441883024503392124998338150498, 53006652221508247962266517649092413191335746399468556370572797863029899311, 21294041067427257618839626452643844082030500202723276839266466992478450089999, 21696887185757653556905065230288601351252470876317472519462491639050772164277, 7393549702196722486937355513781543883815551295472474195991424503815024614, 295392398154090825770484205193313540394559827038657366580035133567333838807, 190821289315785238182371032232920054077122865834943957235452129484914688036, 21511363660720150848316943631887470437079875802390899065969407652249137262529, 21605010302597845556479029048990850163848484454155759471590000898968861945844, 90109987156902090936530777855008758360371939969806389104874041211754721020, 104572084346066340167083551182104689146293539485848256090626339792851304472, 514156647755522783060040765974913519453868610190488203601010740475827650740, 197889410495044568095010513345112256806038811134476442977434269697754214349, 21318778198406262401873362605515470069085124541617237697498893509567816138811, 83047527626503079969967455649559960577956137462230952838902833155772198860, 21627976888044018637707984826286220060254605975249490293366060763764927246205, 325103499572572032874165825271180576496456259468362034620514497536126955455, 21259033927213570867800144627469482151777426893391078165896623693625123078265, 21274936629179632135911704720746147246288012508036889754345464058860469759919, 125451587548471666038100046017214664884947170069029004350974217027543314385, 21506065442957682415953035674987275763404500059127299000966211256928596930438, 21221922783649838897706181833337517808517798162318114440910270965561724186444, 164643698358110908220571711946393125783699674605573664832288166753027633019, 21395077839965026954895174082835214542011281553796169586746661093872653578018, 424045155797942844106670610447724202898460225829873252761779863646138859786, 21347374393184156463198939959870175941440385865926587820609152397676420083656];
        uint256[] memory s2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            s2[i] = tmp_s2[i];
        }
        bytes memory salt =
            "\x46\xb9\xdd\x2b\x0b\xa8\x8d\x13\x23\x3b\x3f\xeb\x74\x3e\xeb\x24\x3f\xcd\x52\xea\x62\xb8\x1b\x82\xb5\x0c\x27\x64\x6e\xd5\x76\x2f\xd7\x5d\xc4\xdd\xd8\xc0\xf2\x00";
        uint256 gasStart = gasleft();
        bool result = ethfalcon.verify(message, salt, s2, pkc);
        uint256 gasUsed = gasStart - gasleft();
        console.log("Verify RIP cost:       ", gasUsed);
        assertEq(true, result);
    }

    function testBenchEpervierRIP()
        public
        view
    {

        // a public-key recovery with ETHEpervier

        // public key
        // forgefmt: disable-next-line
        address pk = address(728199263750570446964354330903202655824594974439);

        // signature s1
        // forgefmt: disable-next-line
        uint256[32] memory tmp_s1 = [127214665213589097161835274703357204562987795624039620550251278841594577059, 21159760717400281634852593057593485809071942971868994123744587935195754475332, 189383245899603158375809826367339927749837394292143291744422834584208682948, 21682747426563929267934057665394942211915145662596763200081090427159784271698, 21569675167645855832412093709743976790114326257518123198077994090411772412003, 180547716391800651022500299749613196982610219827087119674342150302064705840, 21697211486961872373358308952260967032135910855798862834650666694341534351852, 318362434553915395932315946694135742995838706477839664372531189198894411689, 394009348868192951615313671453490620308202296384602068843163152076802162885, 21610307527763657474579033160535761496088084045155786439665876926410317889618, 21619469218540454282593992979478620342090792577163628133508843773230071492314, 274187784953106640656286720905831775894032392013455400239831593255534723275, 203192049593739455123361931703060642950985388609865029827845241670227132789, 369272114969048241782424085407951524944258075394850078280984375966546407352, 21286974681594710810380239615221182427313380586492866019056688182089515020265, 21622679797721959875878107889378257143350554145766163293841509194131352924048, 127540233489563162770721969082820216312196622632599185141951537935395532561, 40640987313488343067132416451155019343194747750088334181139129759319851294, 148736704814963776929832768254778034998479006103505290760762777432652251227, 21568230707728709780104293759196958196447302173657478564489147369041103237028, 369600626809215313001214256563230605438148089472539722485725145132839415721, 79509223393450964750316832974784657227369592457786586946655140290602270758, 21195098440525252903355950731797024541328580061268899976086553708230419087636, 21253734518217209915730096964106833996754210625736070731303545589249329594385, 21645969606056682016014055570623518491010433520067812832282758386001522983117, 65381973537639725416383790152711348493509228084350381743323363074586968369, 21410654084013001974198814286820518184228306987212451148401398668655927885939, 201749939930855484125675043722049083765921599537596897353164045228231950356, 237084423025265759556348607433082282240394595400221762755889372920090865469, 145207841415351346144491575439351579938560441856595595454153849256922579008, 21395075947959285830246154403995015195591110341643615104408444911169818079125, 265032321921930865602047145312858918064071077800948613010348248772821254185];
        uint256[] memory cs1 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs1[i] = tmp_s1[i];
        }
        // signature s2
        // forgefmt: disable-next-line
        uint256[32] memory tmp_s2 = [171713993326567253175735293446338435981493104966753997475473012450851368907, 21498996701926392219947085913669085296444180762927386610038095578288852107269, 452320855744196729263525382518648486101322119190782780004867998719352516502, 301610290073250114293558878833852160271555999703804794315220826784040, 21230437296011178897909094451396232506707694340005553747434364188325741539158, 113079641101639197312573870512454616690956622132413294170436606950500859993, 47705760438364264247831513345052003740603614300362326524637225085611487185, 21308177299717532146421932376243605433109172594072619233454442056084387528742, 21225462840353137318681158243153822002874523881659095747994777536124848963755, 56869284641350843956318120591835603320070954002021844040806879345489412451, 21600032768551756525717875771323281451008180779728001738465605849956021764098, 412002907472536653146653042179248206525093580814393915871751896796573609575, 162872263103356275677536393004004277077635753309055008061105861398154784617, 21571437032129491652615151942368309604066349406184110111399961220786151817439, 21711017487037039044426559292681573420864923961564567874932702928236539424739, 83366253048476995128888869219101971286361546157553550614273001086409584614, 21440694447247297679236873169747049084201317154134571922909870197279931564197, 21511693331965140538235096628936940874146144558128912970649527822622964514945, 259732886119142926121455742849322651542601696485034317796168847645296766822, 21642435081082330079651400829534483046221927125788251360706033919556091916240, 286230981838740379334973157250450897464863814923344128430119820165311496362, 290093555439276985977653448271580047616530031527161840144684355350551527590, 21684515163374002587819002216032060340928337616005165306699647558703425990587, 21249869680067953746801460782669147832805872704743189648058556680797325164641, 199981825896679593278755977572624847497063230090653413441505729053037375227, 203190005565667215998968389129208593620015712070760211618048962670963654748, 310971176450629075739182294296362528058135922433043711776810510569258626942, 21617374139137209449886180689670238479388919477407499396910815617076401483476, 346303561468237481218603219160810409761283516529772376289409239516912168935, 689400646614484187528313142788634824925237973753004202841513297306514435885, 21324082212406290182610070101453472806829671703313864561543447926298940157940, 21265774614747158490428496955547248558480155779892385808399539624318376476686];

        uint256[] memory cs2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs2[i] = tmp_s2[i];
        }
        // hint
        uint256 hint = 1387;
        // message
        bytes memory salt =
            "\x46\xb9\xdd\x2b\x0b\xa8\x8d\x13\x23\x3b\x3f\xeb\x74\x3e\xeb\x24\x3f\xcd\x52\xea\x62\xb8\x1b\x82\xb5\x0c\x27\x64\x6e\xd5\x76\x2f\xd7\x5d\xc4\xdd\xd8\xc0\xf2\x00";
        address recovered_pk;
        uint256 gasStart = gasleft();
        recovered_pk = ethepervier.recover(message, salt, cs1, cs2, hint);
        uint256 gasUsed = gasStart - gasleft();
        console.log("Verify Epervier RIP cost:  ", gasUsed);
        assertEq(pk, recovered_pk);
    }
}
