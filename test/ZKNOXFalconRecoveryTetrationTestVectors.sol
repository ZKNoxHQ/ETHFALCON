// code generated using pythonref/generate_falcon_recovery_tetration_test_vectors.py.
pragma solidity ^0.8.25;

import {Test, console} from "forge-std/Test.sol";
import "../src/ZKNOX_NTT.sol";
import "../src/ZKNOX_falconrec_tetration.sol";

contract ZKNOX_FalconRecTest is Test {
    ZKNOX_falconrec_tetration falconrec;
    //exemple of stateless initialisation, no external contract provided
    ZKNOX_NTT ntt = new ZKNOX_NTT(address(0), address(0), 12289, 12265);
    // forgefmt: disable-next-line
    uint256[1024] psi_rev = [uint256(1), 1479, 4043, 7143, 5736, 4134, 1305, 722, 1646, 1212, 6429, 9094, 3504, 8747, 9744, 8668, 4591, 6561, 5023, 6461, 10938, 4978, 6512, 8961, 11340, 9664, 9650, 4821, 563, 9314, 2744, 3006, 1000, 4320, 12208, 3091, 9326, 4896, 2366, 9238, 11563, 7678, 1853, 140, 1635, 9521, 11112, 4255, 7203, 10963, 9088, 9275, 790, 955, 11119, 2319, 9542, 4846, 3135, 3712, 9995, 11227, 3553, 7484, 544, 5791, 11950, 2468, 11267, 9, 9447, 11809, 10616, 8011, 7300, 6958, 1381, 2525, 4177, 8705, 2837, 5374, 4354, 130, 2396, 4452, 3296, 8340, 12171, 9813, 2197, 5067, 11336, 3748, 5767, 827, 3284, 2881, 5092, 10200, 10276, 9000, 9048, 11560, 10593, 10861, 334, 2426, 4632, 5755, 11029, 4388, 10530, 3707, 3694, 7110, 11934, 3382, 2548, 8058, 4890, 6378, 9558, 3932, 5542, 12144, 3459, 3637, 1663, 1777, 1426, 7635, 2704, 5291, 7351, 8653, 9140, 160, 12286, 7852, 2166, 8374, 7370, 12176, 3364, 10600, 9018, 4057, 2174, 7917, 2847, 7875, 7094, 9509, 10805, 4895, 2305, 5042, 4053, 9644, 3985, 7384, 476, 3531, 420, 6730, 2178, 1544, 9273, 243, 9289, 11618, 3136, 5191, 8889, 9890, 9103, 6882, 10163, 1630, 11136, 2884, 8241, 10040, 3247, 9603, 2969, 3978, 6957, 3510, 9919, 9424, 7575, 8146, 1537, 12047, 8585, 2678, 5019, 545, 7404, 1017, 10657, 7205, 10849, 8526, 3066, 12262, 11244, 2859, 2481, 7277, 2912, 5698, 354, 7428, 390, 11516, 3778, 8456, 442, 2401, 5101, 11222, 4976, 10682, 875, 3780, 7278, 11287, 5088, 4284, 6022, 9302, 2437, 3646, 10102, 9723, 6039, 9867, 11854, 7952, 10911, 1912, 11796, 8193, 9908, 5444, 9041, 1207, 5277, 1168, 11885, 4645, 1065, 2143, 3957, 2839, 10162, 151, 11858, 1579, 2505, 5906, 52, 3174, 1323, 2766, 3336, 6055, 6415, 677, 3445, 7509, 4698, 5057, 12097, 10968, 10240, 4912, 5241, 9369, 3127, 4169, 3482, 787, 6821, 11279, 12231, 241, 11286, 3532, 11404, 6008, 10333, 7280, 2844, 3438, 8077, 975, 5681, 8812, 142, 1105, 4080, 421, 3602, 6221, 4624, 6212, 3263, 8689, 5886, 4782, 5594, 3029, 4213, 504, 605, 9987, 2033, 8291, 10367, 8410, 11316, 11035, 10930, 5435, 3710, 6196, 6950, 5446, 8301, 468, 11973, 11907, 6152, 4948, 11889, 10561, 6153, 6427, 3643, 5415, 56, 9090, 5206, 6760, 1702, 10302, 11635, 3565, 5315, 8214, 7373, 4324, 10120, 11767, 5079, 3262, 11011, 2344, 6715, 1973, 5925, 1018, 3514, 11248, 7500, 7822, 5537, 4749, 8500, 12142, 5456, 7840, 6844, 8429, 7753, 1050, 6118, 3818, 9606, 1190, 5876, 2281, 2031, 5333, 8298, 8320, 12133, 2767, 453, 6381, 418, 3772, 5429, 4774, 1293, 7552, 2361, 1843, 9259, 4115, 218, 2908, 8855, 8760, 2882, 10484, 1954, 2051, 2447, 6147, 576, 3963, 1858, 7535, 3315, 11863, 2925, 347, 3757, 1975, 10596, 3009, 174, 11566, 9551, 5868, 2655, 6554, 1512, 11939, 5383, 10474, 9087, 7796, 6920, 10232, 6374, 1483, 49, 11026, 1489, 2500, 10706, 5942, 1404, 11964, 11143, 948, 4049, 3728, 1159, 5990, 652, 5766, 6190, 11994, 4016, 4077, 2919, 3762, 6328, 7183, 10695, 1962, 7991, 8960, 12121, 9597, 7105, 1200, 6122, 9734, 3956, 1360, 6119, 5297, 3054, 6803, 9166, 1747, 5919, 4433, 3834, 5257, 683, 2459, 8633, 12225, 9786, 9341, 6507, 1566, 11454, 6224, 3570, 8049, 3150, 1319, 4046, 11580, 1958, 7967, 2078, 1112, 11231, 8210, 11367, 441, 1826, 9363, 9118, 4489, 3708, 3238, 11153, 3449, 7080, 1092, 3359, 3205, 8024, 8611, 10361, 11825, 2068, 10900, 4404, 346, 3163, 8257, 7449, 6127, 12164, 11749, 10763, 4222, 8051, 11677, 8921, 8062, 7228, 11071, 11851, 3515, 9011, 5993, 6877, 8080, 1536, 10568, 4103, 9860, 11572, 8700, 1373, 2982, 3448, 11946, 4538, 1908, 4727, 11081, 1866, 7078, 10179, 716, 10125, 6873, 1705, 2450, 11475, 416, 10224, 5826, 7725, 8794, 1756, 4145, 8755, 8328, 5063, 4176, 8524, 10771, 2461, 2275, 8022, 5653, 6693, 6302, 11710, 3889, 212, 6323, 9175, 2769, 5734, 1176, 5508, 11014, 4860, 11164, 11158, 10844, 11841, 1014, 7508, 7365, 10962, 3607, 5232, 8347, 12221, 10029, 7723, 5836, 3200, 1535, 9572, 60, 7784, 10032, 10872, 5676, 3087, 6454, 7406, 3975, 7326, 8545, 2528, 3056, 5845, 5588, 11877, 5102, 1255, 506, 10897, 5784, 9615, 2212, 3338, 9013, 1178, 9513, 6811, 8778, 10347, 3408, 1165, 2575, 10453, 425, 11897, 10104, 377, 4578, 375, 1620, 1038, 11366, 6085, 4167, 6092, 2231, 2800, 12096, 1522, 2151, 8946, 8170, 5002, 12269, 7681, 5163, 10545, 1314, 2894, 3654, 11951, 3947, 9834, 6599, 7350, 7174, 1248, 2442, 8330, 6492, 6330, 10141, 5724, 10964, 1945, 1029, 8945, 6691, 10397, 3624, 6825, 4906, 4670, 512, 7735, 11295, 9389, 12050, 1804, 1403, 6195, 7100, 406, 10602, 7021, 12143, 8914, 9998, 7954, 3393, 8464, 8054, 7376, 8761, 11667, 1737, 4499, 5672, 8307, 9342, 11653, 5609, 4605, 2689, 180, 8151, 5219, 1409, 204, 6780, 9806, 2054, 1344, 9247, 463, 8882, 3981, 1468, 4475, 7043, 3017, 1236, 9168, 4705, 2600, 11232, 4739, 4251, 1226, 6771, 11925, 2360, 3028, 5216, 11839, 10345, 11711, 5368, 11779, 7628, 2622, 6903, 8929, 7605, 7154, 12226, 8481, 8619, 2373, 7302, 10891, 9199, 826, 5043, 5789, 8787, 6671, 10631, 9224, 1506, 7806, 5703, 4719, 11538, 6389, 11379, 4693, 9951, 11872, 9996, 6138, 8820, 4443, 8871, 7186, 10398, 1802, 10734, 1590, 4411, 1223, 2334, 2946, 6828, 2637, 4510, 881, 365, 10362, 1015, 7250, 6742, 2485, 904, 24, 10918, 11009, 11675, 980, 11607, 5082, 7699, 5207, 8239, 844, 7087, 3221, 8016, 8452, 2595, 5289, 6627, 567, 2941, 1406, 2633, 6940, 2945, 3232, 11996, 3769, 7434, 3944, 8190, 6759, 5604, 11024, 9282, 10118, 8809, 9169, 6184, 6643, 6086, 8753, 5370, 8348, 8536, 1282, 3572, 9457, 2021, 4730, 3229, 1706, 3929, 5054, 3154, 9004, 7929, 12282, 1936, 8566, 11444, 11520, 5526, 50, 216, 767, 3805, 4153, 10076, 1279, 11424, 9617, 5170, 12100, 3116, 10080, 1763, 3815, 1734, 1350, 5832, 8420, 4423, 1530, 1694, 10036, 10421, 9559, 5411, 4820, 1160, 9195, 7771, 2840, 9811, 4194, 9270, 7315, 4565, 7211, 10506, 944, 7519, 7002, 8620, 7624, 6883, 3020, 5673, 5410, 1251, 10499, 7014, 2035, 11249, 6164, 10407, 8176, 12217, 10447, 3840, 2712, 4834, 2828, 4352, 1241, 4378, 3451, 4094, 3045, 5781, 9646, 11194, 7592, 8711, 8823, 10588, 7785, 11511, 2626, 530, 10808, 9332, 9349, 2046, 8972, 9757, 8957, 12150, 3268, 3795, 1849, 6513, 4523, 4301, 457, 8, 8835, 3758, 8071, 4390, 10013, 982, 2593, 879, 9687, 10388, 11787, 7171, 6063, 8496, 8443, 1573, 5969, 4649, 9360, 6026, 1030, 11823, 10608, 8468, 11415, 9988, 5650, 12119, 648, 12139, 2307, 8000, 11498, 9855, 9416, 2827, 9754, 11169, 21, 6481];

    // forgefmt: disable-next-line
    uint256[1024] psi_inv_rev = [uint256(1), 10810, 5146, 8246, 11567, 10984, 8155, 6553, 3621, 2545, 3542, 8785, 3195, 5860, 11077, 10643, 9283, 9545, 2975, 11726, 7468, 2639, 2625, 949, 3328, 5777, 7311, 1351, 5828, 7266, 5728, 7698, 4805, 8736, 1062, 2294, 8577, 9154, 7443, 2747, 9970, 1170, 11334, 11499, 3014, 3201, 1326, 5086, 8034, 1177, 2768, 10654, 12149, 10436, 4611, 726, 3051, 9923, 7393, 2963, 9198, 81, 7969, 11289, 8652, 8830, 145, 6747, 8357, 2731, 5911, 7399, 4231, 9741, 8907, 355, 5179, 8595, 8582, 1759, 7901, 1260, 6534, 7657, 9863, 11955, 1428, 1696, 729, 3241, 3289, 2013, 2089, 7197, 9408, 9005, 11462, 6522, 8541, 953, 7222, 10092, 2476, 118, 3949, 8993, 7837, 9893, 12159, 7935, 6915, 9452, 3584, 8112, 9764, 10908, 5331, 4989, 4278, 1673, 480, 2842, 12280, 1022, 9821, 339, 6498, 11745, 10146, 11224, 7644, 404, 11121, 7012, 11082, 3248, 6845, 2381, 4096, 493, 10377, 1378, 4337, 435, 2422, 6250, 2566, 2187, 8643, 9852, 2987, 6267, 8005, 7201, 1002, 5011, 8509, 11414, 1607, 7313, 1067, 7188, 9888, 11847, 3833, 8511, 773, 11899, 4861, 11935, 6591, 9377, 5012, 9808, 9430, 1045, 27, 9223, 3763, 1440, 5084, 1632, 11272, 4885, 11744, 7270, 9611, 3704, 242, 10752, 4143, 4714, 2865, 2370, 8779, 5332, 8311, 9320, 2686, 9042, 2249, 4048, 9405, 1153, 10659, 2126, 5407, 3186, 2399, 3400, 7098, 9153, 671, 3000, 12046, 3016, 10745, 10111, 5559, 11869, 8758, 11813, 4905, 8304, 2645, 8236, 7247, 9984, 7394, 1484, 2780, 5195, 4414, 9442, 4372, 10115, 8232, 3271, 1689, 8925, 113, 4919, 3915, 10123, 4437, 3, 12129, 3149, 3636, 4938, 6998, 9585, 4654, 10863, 10512, 10626, 11848, 922, 4079, 1058, 11177, 10211, 4322, 10331, 709, 8243, 10970, 9139, 4240, 8719, 6065, 835, 10723, 5782, 2948, 2503, 64, 3656, 9830, 11606, 7032, 8455, 7856, 6370, 10542, 3123, 5486, 9235, 6992, 6170, 10929, 8333, 2555, 6167, 11089, 5184, 2692, 168, 3329, 4298, 10327, 1594, 5106, 5961, 8527, 9370, 8212, 8273, 295, 6099, 6523, 11637, 6299, 11130, 8561, 8240, 11341, 1146, 325, 10885, 6347, 1583, 9789, 10800, 1263, 12240, 10806, 5915, 2057, 5369, 4493, 3202, 1815, 6906, 350, 10777, 5735, 9634, 6421, 2738, 723, 12115, 9280, 1693, 10314, 8532, 11942, 9364, 426, 8974, 4754, 10431, 8326, 11713, 6142, 9842, 10238, 10335, 1805, 9407, 3529, 3434, 9381, 12071, 8174, 3030, 10446, 9928, 4737, 10996, 7515, 6860, 8517, 11871, 5908, 11836, 9522, 156, 3969, 3991, 6956, 10258, 10008, 6413, 11099, 2683, 8471, 6171, 11239, 4536, 3860, 5445, 4449, 6833, 147, 3789, 7540, 6752, 4467, 4789, 1041, 8775, 11271, 6364, 10316, 5574, 9945, 1278, 9027, 7210, 522, 2169, 7965, 4916, 4075, 6974, 8724, 654, 1987, 10587, 5529, 7083, 3199, 12233, 6874, 8646, 5862, 6136, 1728, 400, 7341, 6137, 382, 316, 11821, 3988, 6843, 5339, 6093, 8579, 6854, 1359, 1254, 973, 3879, 1922, 3998, 10256, 2302, 11684, 11785, 8076, 9260, 6695, 7507, 6403, 3600, 9026, 6077, 7665, 6068, 8687, 11868, 8209, 11184, 12147, 3477, 6608, 11314, 4212, 8851, 9445, 5009, 1956, 6281, 885, 8757, 1003, 12048, 58, 1010, 5468, 11502, 8807, 8120, 9162, 2920, 7048, 7377, 2049, 1321, 192, 7232, 7591, 4780, 8844, 11612, 5874, 6234, 8953, 9523, 10966, 9115, 12237, 6383, 9784, 10710, 431, 12138, 2127, 9450, 8332, 5808, 12268, 1120, 2535, 9462, 2873, 2434, 791, 4289, 9982, 150, 11641, 170, 6639, 2301, 874, 3821, 1681, 466, 11259, 6263, 2929, 7640, 6320, 10716, 3846, 3793, 6226, 5118, 502, 1901, 2602, 11410, 9696, 11307, 2276, 7899, 4218, 8531, 3454, 12281, 11832, 7988, 7766, 5776, 10440, 8494, 9021, 139, 3332, 2532, 3317, 10243, 2940, 2957, 1481, 11759, 9663, 778, 4504, 1701, 3466, 3578, 4697, 1095, 2643, 6508, 9244, 8195, 8838, 7911, 11048, 7937, 9461, 7455, 9577, 8449, 1842, 72, 4113, 1882, 6125, 1040, 10254, 5275, 1790, 11038, 6879, 6616, 9269, 5406, 4665, 3669, 5287, 4770, 11345, 1783, 5078, 7724, 4974, 3019, 8095, 2478, 9449, 4518, 3094, 11129, 7469, 6878, 2730, 1868, 2253, 10595, 10759, 7866, 3869, 6457, 10939, 10555, 8474, 10526, 2209, 9173, 189, 7119, 2672, 865, 11010, 2213, 8136, 8484, 11522, 12073, 12239, 6763, 769, 845, 3723, 10353, 7, 4360, 3285, 9135, 7235, 8360, 10583, 9060, 7559, 10268, 2832, 8717, 11007, 3753, 3941, 6919, 3536, 6203, 5646, 6105, 3120, 3480, 2171, 3007, 1265, 6685, 5530, 4099, 8345, 4855, 8520, 293, 9057, 9344, 5349, 9656, 10883, 9348, 11722, 5662, 7000, 9694, 3837, 4273, 9068, 5202, 11445, 4050, 7082, 4590, 7207, 682, 11309, 614, 1280, 1371, 12265, 11385, 9804, 5547, 5039, 11274, 1927, 11924, 11408, 7779, 9652, 5461, 9343, 9955, 11066, 7878, 10699, 1555, 10487, 1891, 5103, 3418, 7846, 3469, 6151, 2293, 417, 2338, 7596, 910, 5900, 751, 7570, 6586, 4483, 10783, 3065, 1658, 5618, 3502, 6500, 7246, 11463, 3090, 1398, 4987, 9916, 3670, 3808, 63, 5135, 4684, 3360, 5386, 9667, 4661, 510, 6921, 578, 1944, 450, 7073, 9261, 9929, 364, 5518, 11063, 8038, 7550, 1057, 9689, 7584, 3121, 11053, 9272, 5246, 7814, 10821, 8308, 3407, 11826, 3042, 10945, 10235, 2483, 5509, 12085, 10880, 7070, 4138, 12109, 9600, 7684, 6680, 636, 2947, 3982, 6617, 7790, 10552, 622, 3528, 4913, 4235, 3825, 8896, 4335, 2291, 3375, 146, 5268, 1687, 11883, 5189, 6094, 10886, 10485, 239, 2900, 994, 4554, 11777, 7619, 7383, 5464, 8665, 1892, 5598, 3344, 11260, 10344, 1325, 6565, 2148, 5959, 5797, 3959, 9847, 11041, 5115, 4939, 5690, 2455, 8342, 338, 8635, 9395, 10975, 1744, 7126, 4608, 20, 7287, 4119, 3343, 10138, 10767, 193, 9489, 10058, 6197, 8122, 6204, 923, 11251, 10669, 11914, 7711, 11912, 2185, 392, 11864, 1836, 9714, 11124, 8881, 1942, 3511, 5478, 2776, 11111, 3276, 8951, 10077, 2674, 6505, 1392, 11783, 11034, 7187, 412, 6701, 6444, 9233, 9761, 3744, 4963, 8314, 4883, 5835, 9202, 6613, 1417, 2257, 4505, 12229, 2717, 10754, 9089, 6453, 4566, 2260, 68, 3942, 7057, 8682, 1327, 4924, 4781, 11275, 448, 1445, 1131, 1125, 7429, 1275, 6781, 11113, 6555, 9520, 3114, 5966, 12077, 8400, 579, 5987, 5596, 6636, 4267, 10014, 9828, 1518, 3765, 8113, 7226, 3961, 3534, 8144, 10533, 3495, 4564, 6463, 2065, 11873, 814, 9839, 10584, 5416, 2164, 11573, 2110, 5211, 10423, 1208, 7562, 10381, 7751, 343, 8841, 9307, 10916, 3589, 717, 2429, 8186, 1721, 10753, 4209, 5412, 6296, 3278, 8774, 438, 1218, 5061, 4227, 3368, 612, 4238, 8067, 1526, 540, 125, 6162, 4840, 4032, 9126, 11943, 7885, 1389, 10221, 464, 1928, 3678, 4265, 9084, 8930, 11197, 5209, 8840, 1136, 9051, 8581, 7800, 3171, 2926, 10463];

    //stateful initialisation
    function setUp() public {
        bytes memory bytecode_psirev = abi.encodePacked(psi_rev);

        address a_psirev; //address of the precomputations bytecode contract
        a_psirev = address(uint160(0xcaca)); //here it is etched, use create in the future
        vm.etch(a_psirev, bytecode_psirev); //pushing psirev bytecode into contract todo : replace with create

        bytes memory bytecode_psiInvrev = abi.encodePacked(psi_inv_rev);

        address a_psiInvrev; //address of the precomputations bytecode contract
        a_psiInvrev = address(uint160(0xa5a5)); //here it is etched, use create in the future
        vm.etch(a_psiInvrev, bytecode_psiInvrev); //pushing psirev bytecode into contract todo : replace with create

        ntt.update(a_psirev, a_psiInvrev, 12289, 12265); //update ntt with outer contract

        falconrec = new ZKNOX_falconrec_tetration(ntt);
    }

    function testVector0() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_0 = address(589959844205978517058917870757624514131424632278);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(12261), 44,56,12062,199,12085,36,101,12166,34,12116,19,12221,122,83,8,12274,12161,0,138,12167,12270,12286,157,317,12,158,78,115,67,12231,496,12126,12146,12268,116,110,12090,59,12221,416,12218,62,12175,121,12148,166,12213,332,0,86,12276,12211,12100,65,2,12231,86,11983,234,243,84,113,11973,21,12217,12076,12002,203,67,12071,255,5,12047,12218,183,12044,12215,34,12235,12093,49,13,280,12073,12271,17,54,187,12148,12224,12267,12245,157,12089,12210,12233,12148,11981,12208,139,21,58,12247,106,11977,12132,384,229,66,12114,12220,45,11903,310,12242,12006,8,91,12020,18,11977,12041,12017,12274,149,120,285,147,51,12103,2,27,35,183,1,12269,12169,254,8,12229,19,3,30,12085,150,12229,34,12032,12266,12029,83,15,12183,137,12252,12208,144,48,144,12178,207,11870,50,12137,210,37,236,189,12274,12088,224,12103,12250,52,12247,12187,12150,12075,11882,20,12199,12135,8,12132,21,270,12198,12248,12258,36,12273,12217,56,279,17,121,145,12008,66,12209,296,146,173,82,123,24,12004,12055,225,12280,11962,77,152,11851,20,14,12237,151,20,284,97,232,12116,12274,187,54,24,43,12238,12217,12236,12263,93,12238,12226,12230,12131,26,222,43,12206,12268,11934,12130,146,12035,12252,12231,62,12171,12197,33,29,12130,491,11834,12151,12248,59,29,12084,12217,12270,12075,12017,12198,12149,12081,12213,12199,45,12230,12093,5,97,130,12255,12242,12160,12201,92,47,103,12137,12172,12111,167,58,128,12053,151,12133,12025,76,12212,12208,12137,133,12129,12085,12175,293,155,12174,132,12250,12203,33,12220,12262,24,4,12170,18,178,187,12281,12270,12288,12082,12161,12252,132,12094,12220,12252,86,230,124,235,142,234,11949,102,6,200,185,11999,12260,45,268,85,32,161,52,12164,12014,111,12250,27,12211,12266,51,18,12167,12038,12081,12244,11956,12084,12087,126,303,138,119,12216,12248,12175,92,79,12127,11981,219,168,6,12129,166,12042,45,14,131,12178,174,11,12125,60,31,12245,12105,307,31,12259,220,12151,222,12283,69,11883,59,377,12226,12243,135,12093,11985,37,12242,12191,69,12265,157,210,12222,12191,402,11970,169,257,12247,346,47,12128,103,114,50,126,102,12151,69,11983,12183,11993,12238,12046,12076,120,108,187,12073,12205,56,12045,253,12239,45,12120,12267,12188,8,11985,12282,20,175,12119,175,244,239,12074,80,12045,12204,8,137,119,12287,12248,12225,12179,145,338,40,12230,93,287,246,22,12266,12263,123,12113,344,12202,158,113,11974,146,12032,102,210,12022,236,3,12245,121,12285,1,12063,11951,12243,12262,12276,112,2,84,41,79,254,11794,12076,195,12118];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(105), 102,12212,12109,12279,30,11986,116,12217,12231,12046,228,138,12127,168,169,12288,60,11909,12005,7,12226,120,12256,59,356,12198,107,12208,58,12162,12285,20,359,4,12175,12125,12254,12219,12259,333,277,300,12196,118,12235,12184,64,228,135,12224,12270,12135,43,81,135,11995,159,144,11952,106,12190,77,12099,12005,13,12270,1,12237,27,12128,12195,187,12239,12150,122,189,12246,12130,122,12276,213,14,11912,153,284,334,76,12045,309,177,29,12184,12187,12270,12278,264,114,12200,12223,527,131,12212,12189,11995,12251,71,128,111,194,162,115,319,12149,91,12278,192,12266,2,12191,12173,58,111,12223,118,12144,106,84,12263,12123,25,12165,12032,78,59,12224,11832,12121,18,22,203,280,12186,101,12212,75,45,12138,12109,12004,88,5,168,30,63,137,6,12074,12234,109,124,12086,44,127,36,251,12174,11939,63,31,12012,12106,50,12215,12257,12281,99,11842,12222,12270,158,12128,64,4,76,234,74,11969,74,81,161,12094,12129,146,124,12204,12169,12227,261,207,12089,0,131,12250,395,12214,604,12211,312,116,36,22,276,12142,155,148,137,57,63,134,11981,11983,12235,12108,63,234,217,12279,12259,120,12152,224,0,12227,48,203,115,12149,9,36,13,80,261,12185,12208,61,12275,91,12224,137,98,294,11791,12221,16,12161,161,12196,12141,52,46,164,145,12219,82,12127,259,12112,12060,141,12236,12110,12191,74,12205,36,496,12252,12141,56,92,5,12154,97,12144,12181,165,12207,12275,12125,136,290,34,92,12284,83,12108,61,12189,12223,141,12286,12268,11975,152,12252,11960,119,12238,104,12261,221,12209,12125,12225,12248,98,12065,53,12074,106,12112,12208,12220,11982,93,12233,175,12288,235,11895,425,12174,12056,12268,72,129,12104,79,12213,12110,68,12055,131,12272,12031,316,12171,12243,12093,153,64,12263,159,12138,0,267,12227,12236,364,12081,299,59,12015,48,12086,12043,139,12101,252,12061,12262,123,12193,12254,12238,75,11877,46,251,52,102,12225,56,12172,12051,12008,220,11939,168,12254,12105,21,292,12035,12236,17,374,12022,269,206,155,12145,12164,12083,109,12236,12175,313,12114,12132,111,12060,12065,12251,12139,12140,16,12241,29,12176,139,12063,120,12266,259,12171,12083,12217,229,52,337,9,12244,12221,205,110,12180,2,12202,12244,11793,12128,12140,122,134,12249,184,133,303,105,12234,257,12171,12136,12135,83,133,12246,69,54,12072,12267,12198,12043,105,12032,12178,12281,88,1,12250,99,30,12254,128,21,12248,81,279,181,300,31,122,111,181,54,131,215,203,337,92,12184,12187,114,12288,11902,12090,46,185,12222,12004,12232,12232,11994,27,37,116,12199,278,51,205];

        ZKNOX_falconrec_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(7348), 11341,1127,10897,5852,136,4056,5800,3069,7275,11120,8976,8823,11674,9143,8434,4257,10177,11885,1449,3487,8153,4299,7244,4322,10735,11117,3889,4570,2339,4796,8939,10838,2015,7412,3869,7,5108,2372,1500,5644,494,9869,5708,6030,9492,12132,5116,6810,2768,8853,1360,1626,11073,3008,5095,4970,9351,1056,8315,6483,8739,5847,8215,8415,10554,6368,1950,10764,2891,6048,6556,12267,4757,6663,9014,11355,6261,8395,2111,10003,3710,12237,2060,565,5676,224,3201,3651,1930,2990,10169,8087,8872,2060,9764,2937,11379,7088,11546,5628,10898,8911,1166,4320,11876,2013,7121,6534,6171,6349,6677,5632,2844,10373,9084,977,11411,8249,8097,11510,9618,1343,5812,11303,5695,4484,7325,3342,10107,383,4125,262,1086,12159,4769,604,8275,5113,2511,2958,10612,5367,7279,11471,966,11129,1987,5840,11421,2090,6281,571,6311,6177,2243,1630,6720,4669,9120,1252,3075,7641,4200,383,9718,2645,4344,8008,9420,8654,7237,1673,9339,11517,9251,2105,9814,10173,10991,8020,12230,9479,2611,11088,3979,7451,10926,4520,11683,6979,1452,1369,7129,9514,9198,6472,9613,8711,675,6294,1099,8336,2739,11236,3033,8407,4976,2846,5750,10271,4344,7283,2831,5656,2631,4045,6839,9519,10247,10232,10419,7844,1046,7649,2308,11754,7040,12053,3374,7807,5094,7361,11556,10352,3410,8544,7437,1230,903,2557,889,6611,6409,6050,3342,2854,3454,9138,11067,11221,10441,11593,4053,2874,4567,4490,11693,6840,4076,819,1271,8472,5837,8906,6121,6636,5770,4348,122,7321,3177,7389,10028,1606,9347,11369,9835,6005,2728,888,5542,145,12253,5737,3828,5573,886,4857,10897,3294,3181,10200,4160,10457,10491,2908,6286,12118,8917,1336,4585,5435,2426,2642,3565,5635,11762,14,9038,6763,11665,10043,3197,5041,4517,3579,4438,6043,2875,10069,10719,11575,2536,10904,9314,898,7985,5958,1901,5545,6729,8656,1664,8046,1349,2808,11664,11685,11670,2179,3204,2499,10185,5448,12062,11758,4598,11066,5174,214,10932,4750,6632,1829,7906,10105,4105,2151,10983,1238,8626,31,550,4214,600,2023,6582,3339,280,8767,11201,4670,3411,2259,1214,7759,5040,9932,10562,1472,7797,9773,6183,2580,307,10871,3330,4188,2897,455,6542,3212,1903,9723,137,7432,3052,4294,8706,898,2971,8939,8070,7099,2291,9990,1406,9920,11574,5196,4788,5856,786,10871,7691,7453,4478,8814,37,8265,9956,875,2676,11270,211,5691,3656,753,9873,10668,2923,7,4843,6148,4394,8640,7685,7040,4342,2169,9952,1747,5056,10625,11857,843,3628,1410,5174,12218,5387,8821,6799,7742,2902,2495,6967,10341,2258,2335,5223,8154,10262,5124,3170,11233,5777,4625,2709,848,9132,7824,2183,4725,7774,1292,7307,8687,1507,3808,11168,11760,6094,2853,485,6496,9744,10733,1341,9902,1856,7925,11705,11013,5171,6220,9134,3363,10044,327,9724,6140,7610,1857,6432,5167,1440,3652,10475,5270,2565];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.ntt_sm2[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "My name is Renaud";
        sig.salt =
            "\x16\x1a\x97\xe0\xf4\xc6\x89\x2a\xea\x94\x2a\x85\xf1\x01\xad\x3a\x6b\x54\xe0\x5c\xa4\x30\xfa\x33\x8c\x46\xd5\xc4\x50\x04\xa5\x7b\x73\x4f\x55\x14\x41\x5c\x71\x93";
        address recovered_pk_0;
        recovered_pk_0 = falconrec.recover(message, sig);
        assertEq(pk_0, recovered_pk_0);
    }

    function testVector1() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_1 = address(589959844205978517058917870757624514131424632278);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(12184), 11980,12194,208,326,12023,68,12047,12132,12077,162,5,304,142,12197,0,85,17,153,215,347,12246,135,97,12142,12130,12198,12275,11991,103,43,12177,12279,202,134,12134,12280,12180,152,12170,12222,12175,6,11949,12041,11957,135,12215,97,12109,286,12128,283,12157,12232,12107,4,127,89,12278,16,12171,12222,12181,90,12092,88,12145,12196,12172,22,123,60,12229,6,12244,258,12281,12152,17,24,12014,11919,19,41,12034,12005,12202,12113,41,175,12108,179,12281,12049,110,135,51,12202,12176,399,12136,227,12277,12280,238,118,69,12075,465,12210,219,12153,170,200,11922,73,12246,12228,12077,60,305,12243,12190,12195,12206,61,27,11870,12250,234,12037,23,11949,12276,12194,104,148,117,92,38,12144,96,12181,63,12,12065,41,40,66,12179,15,28,12129,12108,309,12204,12169,34,12266,11958,12273,12174,127,12248,12062,12201,328,88,12179,12107,12249,12137,214,12243,255,12123,181,12265,12185,12041,12116,302,12237,12235,271,12147,166,41,1,12131,12133,100,12236,129,10,133,245,12139,132,12090,58,111,12280,12271,12154,12171,12204,35,11948,235,150,12098,12254,55,12208,108,12156,144,23,12065,195,12131,12197,312,216,12202,444,12103,12154,158,11912,79,12043,12218,31,44,93,12132,12169,12076,38,12080,84,208,12186,12223,170,276,384,135,12167,12083,12171,2,11923,10,12040,56,12247,224,83,12017,150,36,123,12181,245,22,2,12276,105,12218,15,12264,12076,221,66,12060,12260,12151,239,184,12178,12268,12224,12283,252,11992,101,12167,12227,119,83,182,315,12115,12278,79,69,12170,55,12232,12131,12287,12151,113,12075,12250,12229,196,126,37,12101,12192,12136,8,45,107,153,12014,12081,12068,12102,12070,12232,41,70,12213,91,12246,52,150,12143,25,103,194,12287,12163,79,210,46,38,12127,12173,12046,12004,12161,12251,448,46,12106,17,153,12070,92,12169,12098,12214,41,12199,12119,129,326,15,101,12182,12100,12194,200,11991,62,11971,16,12068,29,11902,12277,39,63,47,45,131,30,69,202,16,12244,14,12155,12050,41,12227,23,90,18,11944,11977,47,151,38,42,31,21,12149,186,63,284,96,189,196,218,12151,41,23,55,12131,12253,29,11963,377,230,11942,12004,11887,12260,12123,90,294,4,12258,137,12244,12266,78,192,228,40,12162,128,94,226,12134,12014,12181,12096,208,218,12286,12015,12269,12133,11943,69,11974,72,127,12164,12187,240,224,12020,12008,12154,12229,12217,97,229,80,12097,4,12239,126,33,142,12200,12283,12095,168,12183,12279,12095,12246,101,12097,12032,42,69,235,284,12188,229,75,12007,208,103,11924,12051,12215,12251,50,12268,217,12273,12275,12193,12025,173,35,89,96,12232];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(12149), 170,350,11941,46,12248,12149,99,12154,147,154,12221,214,234,12151,424,150,326,233,12140,12098,19,312,3,59,193,11994,12283,235,12234,203,87,87,88,102,12232,12270,105,12273,328,39,96,273,142,12036,361,12168,12191,12288,51,33,11990,12140,11887,12246,127,11,12255,12237,12141,12254,12093,12273,11990,95,12274,12195,1,12162,12179,267,12080,90,11959,12232,12108,12142,350,11978,24,12269,416,12272,12142,187,251,12195,141,12207,14,12116,12223,23,12202,12246,21,12253,21,61,12126,64,250,6,12105,12200,12121,257,12229,49,12012,12282,12047,12128,122,12191,46,53,12269,18,1,17,64,76,12166,12193,314,12023,12243,12143,12211,12198,12163,274,384,232,12006,12249,12166,12103,12093,12271,12247,11903,7,12273,119,12095,75,295,12191,12250,12068,31,26,195,12240,12059,12258,227,12204,38,159,12139,357,127,188,12228,12066,151,12012,12142,36,248,12039,12170,125,209,12094,10,83,12254,12090,27,12185,94,11970,259,12226,12062,12223,12224,12219,12136,12111,115,12169,12263,11981,121,12098,12285,97,380,300,446,12192,12210,26,91,12187,38,12235,70,213,12090,12003,12061,12246,273,27,12148,12185,12226,12208,12179,275,12181,218,12246,12231,12235,12249,12286,12190,56,11999,12114,12177,309,12171,130,182,7,336,12169,299,11934,49,31,59,12239,99,12228,12018,61,12182,112,12278,12028,12272,11981,32,27,261,12268,12142,22,12074,12260,25,99,183,12274,12186,55,214,157,149,118,12176,61,12002,12209,12198,47,225,12177,12207,12053,298,12246,43,12178,64,12187,12217,23,12210,12091,12269,331,12066,12180,12164,12254,12191,132,90,253,12197,12216,33,26,285,12163,12236,201,12202,12065,180,12214,17,12225,12035,48,64,62,0,99,12126,139,12132,281,12108,12097,364,181,12208,12070,11989,12097,27,288,12142,12268,25,201,12137,12281,12189,144,246,25,12199,162,95,152,12161,28,12159,344,12248,12161,230,62,65,128,162,11982,12156,12185,12054,12157,350,12218,12158,11869,11954,119,7,102,12232,205,12190,12218,101,77,223,12017,12209,46,12242,92,11,153,45,187,12040,12189,12157,120,138,12246,12191,12145,104,12127,346,364,179,12152,11976,34,12,142,294,86,8,12129,172,12041,12281,254,410,81,12237,196,239,36,11984,21,7,12156,12136,12119,12078,3,290,60,12150,50,12169,12227,12234,12175,254,11939,11935,12186,255,15,88,12089,12134,58,12176,11851,12197,31,34,103,12191,12055,120,12101,67,11924,316,12109,12222,152,12118,194,279,12237,96,233,11972,143,73,288,122,12198,12269,19,12177,72,12263,14,12166,353,204,39,11886,60,12222,12282,63,12164,12248,12184,12130,12098,67,12068,12103,12067,127,12168,12272,12014,50];

        ZKNOX_falconrec_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(3090), 8956,23,2529,1475,11268,5408,4240,2040,5350,12181,11215,2439,8029,10248,9685,12108,725,6271,10870,6141,8711,3708,7124,259,5856,8816,7452,4146,298,4380,4145,11806,1985,4912,537,2276,2435,4008,4405,11208,1157,1792,4811,11106,3352,10717,10425,5065,418,11986,3789,5340,2502,4910,3390,8478,4549,3165,9881,406,1931,3868,5302,8496,1867,366,9823,7814,3333,2079,4431,2198,10170,8504,5106,10855,6924,11524,8767,2862,3546,7538,9739,7837,10977,7924,8681,10693,11364,1208,10835,3207,6219,1209,7099,1699,676,4852,7180,5000,11318,5811,2017,371,11382,3195,9166,1541,1650,5935,5572,4660,5912,8517,11188,4278,9841,7633,9056,6120,8731,12041,4070,10069,9404,920,10594,4818,11899,11263,3986,11092,1092,10224,8476,11918,2623,3622,7171,6492,2555,380,4860,7121,2115,11012,11025,4745,5475,3472,6336,7647,10604,5596,4864,4334,1726,688,7352,4040,12063,9692,2322,8845,9165,7081,11570,12241,7054,4973,3924,12001,4849,4623,5878,10538,10054,6837,8170,237,9076,5208,5187,3641,4248,6505,9112,5600,11920,1428,215,3187,11295,158,5681,1902,1129,4955,2324,11724,3067,8385,9763,10056,1534,40,1094,5166,1407,4171,2285,9272,669,7744,863,8251,1491,10418,6294,4773,1734,5487,11033,7182,3744,4680,4985,8319,10067,12028,10030,7800,8824,10224,5183,6364,4588,8380,5254,3900,2217,746,9996,10294,2298,11147,6448,2993,10504,7909,5142,2550,10397,2293,3094,6866,10791,11483,9252,4933,9035,4529,7766,9797,4545,3129,6219,1159,10352,8129,11695,11011,3820,4760,4605,2403,9477,5398,11972,5754,2856,5566,5535,10747,342,8140,6698,6093,9861,12132,4138,11383,7445,10614,5124,9387,1955,6543,5540,432,3875,579,8307,5753,11964,9749,6516,572,7423,10666,5044,9859,10502,522,5824,9441,7727,132,12192,2506,635,7448,3247,4177,2578,156,2772,9826,7760,12132,11022,10919,11530,7488,2854,6264,11510,2690,4761,5823,672,5143,4322,11240,2720,7063,8226,4788,8802,462,10377,9447,2379,4540,2815,265,9308,3459,9067,10504,258,10574,8218,7342,8458,6538,3876,6546,11393,8192,7170,244,10924,6791,3629,1674,2769,10052,3920,2003,11822,11920,6882,10612,10455,11683,5766,9456,1883,10496,1701,4261,1900,7586,5189,10659,8165,11045,7884,7551,11177,2128,8368,4437,11633,11333,7204,7237,6476,7663,10921,7419,10326,6301,5502,2823,1345,4881,3538,556,5456,7477,783,11377,5359,5154,1422,7446,11088,10908,9914,5205,8058,11447,6266,6462,11203,8516,12185,7727,4816,10593,7149,7958,3210,4676,8772,2529,9236,936,8738,8823,5548,11762,3329,10792,10486,8250,3495,5729,1700,11605,9408,5295,9948,9773,7338,2131,3826,9964,3409,10302,614,6813,11172,5803,11782,8086,5743,10978,7944,9877,9909,7782,9863,10815,9748,2005,10125,6224,3979,12182,4361,10565,5575,3040,5381,5532,6443,6240,4013,2018,10761,9697,2218,9246,2625,7440,11866,1284,3992];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.ntt_sm2[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "My name is Simon";
        sig.salt =
            "\x16\x1a\x97\xe0\xf4\xc6\x89\x2a\xea\x94\x2a\x85\xf1\x01\xad\x3a\x6b\x54\xe0\x5c\xa4\x30\xfa\x33\x8c\x46\xd5\xc4\x50\x04\xa5\x7b\x73\x4f\x55\x14\x41\x5c\x71\x93";
        address recovered_pk_1;
        recovered_pk_1 = falconrec.recover(message, sig);
        assertEq(pk_1, recovered_pk_1);
    }

    function testVector2() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_2 = address(589959844205978517058917870757624514131424632278);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(12247), 12183,22,161,12208,12244,12113,131,12240,12285,42,10,12268,43,0,12272,12170,12131,62,2,221,120,84,245,109,20,213,12175,56,11969,3,12110,139,12254,12047,12257,12169,12010,172,12184,252,12074,12191,12266,12156,198,66,12179,195,176,229,93,12117,12196,12096,117,57,12272,559,12035,12276,12152,12287,12225,12024,12285,182,11972,329,261,12044,12087,150,12143,43,12195,165,76,12088,115,77,11999,12207,84,86,12228,12187,12061,11966,154,12139,68,62,36,12242,12047,96,12191,12037,12035,289,12265,12198,171,12242,12193,12262,12144,173,12267,210,12124,9,119,36,12044,346,13,128,12217,12217,12161,12247,60,37,12207,58,12139,12264,12154,12217,12191,12158,12254,12110,63,2,12146,12106,143,171,41,46,12090,12273,24,32,12104,12001,12231,12183,38,36,10,12269,12165,132,12245,92,11798,277,12178,12260,12165,12131,14,12166,12,12266,207,8,12186,37,12058,250,86,12234,12253,30,125,12217,12063,11885,100,48,75,12203,39,12239,12201,12283,12164,12159,101,12253,12182,325,140,12242,12279,12129,226,12248,253,12261,298,173,12280,12144,36,12216,385,329,74,69,12244,156,12041,12127,92,194,12210,12174,115,12193,12050,103,111,12171,12207,198,11946,12230,185,12002,1,44,170,12186,104,12185,11828,12150,12281,42,12142,143,12240,182,12176,428,100,118,12015,55,68,121,12064,12225,244,92,142,12199,12259,125,245,29,54,29,12242,50,31,12073,46,11809,12134,181,12246,186,11970,12205,405,184,12013,12158,12227,90,12259,12267,12003,12191,12147,12157,12203,12138,12266,60,175,12161,532,117,149,12236,12273,12051,12023,12250,12213,12,305,150,24,12249,190,12096,156,116,12,102,221,223,85,77,12239,12084,12190,12222,12004,242,12226,12237,12100,115,4,12161,12053,12027,198,12145,12128,91,12159,44,30,12266,12135,12129,101,6,12254,12222,12193,23,234,149,72,12203,118,11992,12120,157,12144,12286,448,12232,89,82,12163,11834,170,44,12171,12097,38,12153,12133,159,12109,12138,12149,12249,79,12135,66,2,221,10,12216,217,12144,12099,12112,176,51,12246,146,12272,30,12062,83,12201,12040,12263,12193,97,12006,12,30,12285,12266,12228,12196,12286,12153,37,229,12129,251,11,12168,30,12243,12179,53,12258,170,12239,150,102,12060,0,170,12254,89,12246,192,12267,130,118,12269,127,12149,12208,141,28,12208,43,12052,20,210,265,12043,11775,12026,11,383,12281,12265,12221,55,11936,12161,12238,12067,11980,25,116,12228,12284,24,12273,12093,12237,404,12114,12247,12088,12281,12027,11980,12259,12277,12219,54,12173,12156,51,42,12184,12179,12241,102,61,178,12273,12215,12025,12219,12239,79,302,12070,11980,12241,12253,12274,11982,318,12008,12248,12101,12039];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(12096), 83,12279,12226,12281,328,96,1,271,11902,12107,12054,12203,12281,90,208,12267,178,12166,12016,169,380,12230,120,12276,124,42,12079,12257,143,224,97,12265,12283,438,12233,224,11963,311,251,93,12186,39,12230,12210,12022,200,12209,65,12082,12142,12099,12209,33,12166,12175,12262,12284,11981,201,12161,62,96,68,12052,162,287,299,175,315,74,258,136,12234,74,12212,12288,86,12096,373,14,177,101,12168,12057,283,12005,12119,12236,11,162,184,12148,269,12206,6,39,9,34,79,7,223,86,325,12201,23,4,12113,12082,12265,203,16,12251,12088,133,12099,11903,12171,222,241,236,12223,12208,12270,12265,142,189,12248,12176,12154,4,12196,11893,112,12207,203,11949,12063,12110,116,12128,245,12223,11980,108,12083,50,32,195,92,36,123,12143,34,12266,12210,12176,12143,12267,12268,12122,12187,73,12255,12100,12264,12185,114,11973,12171,169,56,12192,12192,12130,11911,31,177,11934,36,154,36,117,202,12211,2,148,12107,12209,118,93,129,12241,12270,12229,12227,37,12284,362,12230,12267,213,56,169,33,12246,80,37,106,12174,12284,204,12130,12264,12089,12239,12172,218,66,231,11954,12265,12174,145,57,12259,12230,12281,12182,12109,53,12256,76,12173,12145,12080,122,12157,133,66,115,12258,12241,12228,131,12255,136,12210,55,12152,111,12181,120,12122,12085,183,12185,304,35,249,159,4,123,12236,30,280,134,12031,12194,11,12265,12279,12275,12252,21,223,12167,12060,12241,93,106,12023,133,5,12261,258,12285,12251,12176,11901,12158,164,12262,271,12112,12258,12241,12243,11962,12188,12156,12209,12202,11746,128,12077,12213,63,342,12191,12091,89,270,12035,12229,12250,11956,12273,196,321,12082,254,12093,7,197,12251,25,194,12236,96,232,61,278,12034,42,12226,44,105,144,12146,257,187,299,203,12185,12279,85,11997,182,12098,12173,12263,293,12283,12283,12116,12116,12171,12248,353,12268,160,12218,143,12257,36,31,146,373,105,141,127,12232,255,121,79,286,12264,105,58,12262,12195,12231,12085,83,12074,12058,297,26,11916,12177,107,12189,184,133,58,12218,12176,12231,217,13,66,12088,195,59,12039,12169,68,326,12222,161,133,12133,121,138,204,293,12268,12238,12181,12253,12166,47,296,145,147,53,12077,12253,12189,152,12113,81,12175,12166,12276,200,12263,225,11979,12166,12041,65,12229,12048,12001,558,126,11983,11844,174,295,298,12194,118,12253,12162,173,12117,47,12235,78,119,12238,25,12218,240,168,11982,290,69,12252,327,147,12033,139,12224,12192,12125,250,12160,138,16,386,235,398,12278,263,12067,221,185,12274,12262,11979,12219,205,21,54,12156,94,308,205,12211,362,243,12236,12229,321,11950,337,11,12146];

        ZKNOX_falconrec_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(10272), 11535,1700,7988,2258,395,1980,10561,7000,9355,5185,11426,7608,10606,11035,10777,9020,12200,655,11325,2133,5304,2090,1938,7759,6515,10221,11873,7158,8904,423,591,9066,8497,8966,5620,7073,6292,11228,488,2484,7417,5472,5651,4292,836,4086,432,9958,3995,4662,10917,8905,3138,3734,8727,3820,2204,2127,8588,10196,125,11635,5419,3421,6740,4440,12078,6261,10718,9403,2724,5790,9019,7540,44,7366,6837,9752,3437,4321,6441,4991,11822,1931,7616,9722,4701,690,11741,7131,148,5151,10306,2763,3243,9562,3987,10873,5116,915,6865,6121,8517,3381,6203,114,10470,9693,99,9793,1063,3028,7364,11552,11296,6244,10049,5409,7203,3269,4848,3394,1410,9158,9005,6789,6748,10604,9345,8060,11714,2759,1100,2769,11398,1973,668,4260,5054,5949,5564,5409,7460,438,2109,4424,5314,3327,4383,502,3089,12061,6503,7569,5104,10880,5587,10868,1657,5650,9054,2118,9858,8887,11055,5133,3180,4406,2381,8144,3168,11250,712,10803,5202,2781,10546,4302,8290,6293,1326,11192,6310,11595,10699,9843,5288,8508,5560,5246,6408,816,4164,4779,2386,11212,9005,2046,10933,3946,11203,9821,7593,8190,11328,5173,1844,5969,8973,4214,4453,8338,6891,7224,10815,10047,10789,12061,9462,7573,1299,1412,353,1300,5006,4804,3684,7406,4397,3573,10122,4702,8568,8596,1808,1945,3124,10955,8947,8282,12193,4209,7649,4209,6657,4635,9738,4219,11733,4775,5401,7601,7755,2102,6227,7384,756,157,5727,2300,11579,2147,10819,1344,4743,10425,6349,3187,1182,6385,1550,6770,4081,11155,11225,779,8683,870,1352,6498,11134,12027,1042,3823,4542,8186,3916,897,3406,5480,11484,9688,2384,11740,1444,11508,4011,4577,7337,10268,7538,10957,10297,6168,1165,7607,9673,3333,667,4525,1483,4544,7265,692,4205,69,4947,3801,303,8326,9205,9765,8143,7634,2620,4718,7620,5293,9014,2085,8153,4076,2121,487,6879,7849,382,6729,11680,12151,11814,224,2874,923,11735,5645,3719,4887,8775,514,2513,793,2433,93,9434,443,10347,7573,4837,7176,7258,2077,12136,5701,3309,1624,298,313,2036,9533,3742,4078,10734,1648,2331,3301,12046,5620,10358,2805,11452,1584,5247,2093,9703,1284,1727,6271,2771,6027,622,9159,4207,6546,3318,6900,11200,875,5113,2302,5698,103,11097,3486,5021,10216,12266,8485,5625,5365,11946,1367,6688,10615,4401,5165,7874,10400,4833,6145,8436,8573,10976,4066,4899,6991,2777,10492,2573,1144,1358,3686,10562,10298,5890,12102,4139,10755,1429,8453,2607,5262,4886,7214,4374,227,7548,11282,8748,187,11286,4972,3874,5553,2603,4433,4068,8455,10430,2006,1740,8226,7210,12259,10195,9567,445,11956,7213,8244,3345,3236,12277,1270,2251,1831,2289,9024,2634,1555,5034,9806,8158,3650,8160,4791,10505,3308,8735,4919,6429,4588,2938,905,9220,10111,6008,9972,3793,663,8239,9076,1587,2682,12274,4568,3940,11604,9066,6823,11182];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.ntt_sm2[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "My name is Nicolas";
        sig.salt =
            "\x16\x1a\x97\xe0\xf4\xc6\x89\x2a\xea\x94\x2a\x85\xf1\x01\xad\x3a\x6b\x54\xe0\x5c\xa4\x30\xfa\x33\x8c\x46\xd5\xc4\x50\x04\xa5\x7b\x73\x4f\x55\x14\x41\x5c\x71\x93";
        address recovered_pk_2;
        recovered_pk_2 = falconrec.recover(message, sig);
        assertEq(pk_2, recovered_pk_2);
    }

    function testVector3() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_3 = address(589959844205978517058917870757624514131424632278);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(15), 154,12130,70,346,241,12175,12097,213,12239,193,76,165,12276,12278,12210,92,12237,12267,12288,182,23,57,12055,257,12056,12258,3,97,12130,11957,12207,12179,12126,12208,20,222,259,99,12170,12170,12067,12254,26,361,22,120,12051,28,12260,102,12073,170,72,12014,160,12103,11891,111,177,12206,186,86,50,351,11983,12134,12271,339,12232,225,12265,150,53,12110,191,11971,116,12210,12216,66,157,105,11,153,12264,12265,71,12151,11985,12276,11943,12173,246,12210,12260,94,269,11926,33,111,12220,11934,95,12086,12278,12256,146,82,12280,12031,12061,208,118,86,56,218,12091,108,114,12233,200,85,65,12277,12127,65,12240,95,12099,93,12288,164,12143,111,279,12213,12192,48,145,55,123,12067,12168,12147,47,198,213,12288,12257,74,116,12273,57,11974,64,10,12154,130,235,12256,11902,211,97,90,52,12155,12267,63,12202,12249,12123,206,12024,12254,11922,12196,241,152,12231,12225,91,12081,12201,12159,92,35,12226,12187,143,12266,1,12010,44,183,12247,12276,12283,122,64,37,12204,12280,87,12230,189,12149,274,11995,12226,12137,12260,249,12142,11946,12151,12034,87,12282,12250,24,12189,12194,277,12262,306,65,12201,80,12019,12200,119,12172,12134,153,12142,71,188,80,56,71,94,12186,19,70,12265,12240,90,69,3,125,12069,12270,12053,12242,98,12141,92,12197,12028,12225,12188,288,11807,26,12037,12203,12267,148,12271,12066,12061,12202,12234,5,12010,102,12024,56,205,92,324,101,12064,12211,12033,12187,156,12150,129,12036,22,12042,22,78,167,42,332,22,66,12217,12278,190,217,12226,62,12271,97,134,12035,12036,136,31,47,12018,12186,12134,12213,19,56,12112,12192,316,251,12200,11991,12228,11,12244,12248,12084,81,12272,12103,12231,12010,12090,50,12160,170,12185,71,81,134,12091,103,12244,58,12045,66,12061,342,130,226,12233,12218,12156,11977,45,10,339,3,28,111,45,72,67,12259,126,12246,11963,12085,233,12121,12036,12246,12256,12263,111,144,272,12170,12080,242,12235,12137,211,26,11885,12084,23,11870,12080,150,254,228,2,139,12027,41,12197,12186,1,12253,12229,123,76,12127,12278,202,12229,12170,211,12091,12202,17,180,12118,12086,158,400,12194,12256,12075,12236,12190,11924,325,12193,154,12254,12228,11999,115,83,154,12145,231,11903,54,12096,232,11990,80,309,12181,50,190,115,12064,11895,124,57,12116,31,12106,12273,193,12280,12035,269,107,11983,100,17,12194,12184,12221,4,330,85,30,12209,0,12037,12178,12279,152,12055,46,12204,12235,11839,125,42,159,132,12142,111,12121,148,21,267,12257,62,12176,12283,5,12155,12105,136,12103,118,82,12046,12219,12238,16,12186,110,12285,74];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(117), 12239,231,12195,12175,12281,11956,69,12287,28,12256,139,280,12192,12213,136,75,201,119,133,145,12242,84,12279,12064,83,311,12049,35,12183,11999,12114,12125,61,232,12063,128,441,12170,18,26,106,191,128,12201,12248,105,222,12284,12194,85,16,12196,9,12068,253,12100,12261,128,101,12216,12067,302,12139,5,24,12231,8,12111,188,12006,33,12233,301,3,120,50,88,12287,81,12265,89,12097,53,12275,49,12105,346,12081,69,12265,12276,12167,12216,12288,7,179,274,112,18,101,12135,152,182,136,297,12229,12199,91,12131,61,12191,209,12288,12045,268,12051,12234,11786,63,12062,11998,196,12071,12224,12084,12241,12239,12259,104,12140,12190,12060,188,20,5,12078,12156,12023,47,76,12107,12280,11998,28,102,43,12285,11928,12257,172,207,12131,12189,12194,1,12075,12181,68,48,105,12139,49,12169,231,117,16,138,12176,12102,242,12141,177,2,154,124,72,20,12180,12213,12261,76,12258,85,36,218,83,333,154,70,12095,25,12024,305,346,34,12040,216,236,116,89,180,12012,141,12000,15,157,11935,87,29,116,11854,12165,12221,12246,11927,12228,12249,72,12206,38,12266,12194,12195,97,247,12186,129,18,12229,12161,12253,12231,11993,12206,12162,12101,12072,12169,12019,12178,237,84,244,12215,152,12156,12218,12261,12241,170,12154,120,22,12058,12051,12213,12032,136,116,304,12204,252,12265,143,44,11978,12199,139,12180,12045,49,175,12274,111,52,90,186,12217,12264,12122,19,201,124,195,173,12188,12286,288,126,51,155,49,230,38,39,103,58,7,12222,25,12239,269,150,10,29,104,121,54,170,12215,101,12264,12017,91,240,5,12202,191,310,36,71,12131,219,12161,95,12148,129,12191,96,12135,288,12206,64,12254,12066,31,245,198,12231,11996,12282,12196,12159,38,11832,354,12189,12235,12121,198,12148,12205,337,11760,12287,64,12148,12252,137,36,12181,68,110,4,12229,268,133,12069,12145,12135,12222,12271,12270,12251,47,88,12122,30,52,6,102,12198,289,12210,218,169,12197,85,12255,12223,49,12126,21,298,111,72,12217,238,12284,12274,170,12155,176,11992,12237,12176,219,12146,12283,49,317,128,12213,12225,113,12144,12021,12249,12261,12132,12272,12201,47,346,120,172,21,70,29,12024,12165,119,12108,306,157,12118,12118,12262,71,9,145,97,88,12169,12168,12035,353,101,35,12113,96,160,12136,12152,12110,12206,12248,12101,11975,12288,12286,158,12272,238,12149,58,220,12153,200,235,180,12260,12265,12224,61,17,12162,12114,220,25,179,12222,218,12191,12181,306,124,93,72,138,213,0,169,12260,113,208,12278,12129,125,12056,12285,48,21,66,2,11921,181,12245,257,112,20];

        ZKNOX_falconrec_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(4618), 4675,9231,3628,10612,11800,6464,2963,3787,10064,1467,7880,3045,6505,7034,9732,4964,6558,2165,7246,9763,2836,11815,998,8549,2860,3315,3499,1618,10088,5707,6626,6130,5383,4781,4519,10429,9064,2117,8666,1342,1510,2423,6841,166,3757,11847,8129,8451,5303,5813,10282,2759,9293,12078,8906,12011,8608,127,11330,5177,3676,10238,1399,5941,7216,9520,6873,6432,10199,7020,10900,2353,4436,12015,584,8197,3205,103,11807,9631,4484,5426,7854,8011,9063,6623,3554,9636,6187,7356,10976,11082,11106,1677,7085,10274,766,6849,8249,8527,7165,1640,6120,9490,10841,99,9964,7685,8760,10489,10654,3333,4536,11237,5259,9530,4304,2419,8637,4597,9557,826,1948,2049,11446,4791,5883,9755,7482,1893,1125,4627,4796,12201,4828,8802,11421,9558,8071,7473,4550,5133,3176,11350,11730,9230,12148,4693,6025,1265,5716,3133,627,9844,2015,7015,1032,7618,8218,3835,9904,6922,11721,9174,8082,777,10690,11489,11206,135,8523,1548,11044,6143,8857,10579,6954,5117,679,4424,10025,7179,4849,7309,6194,11609,3239,8196,3825,4575,1395,6621,8101,6483,1731,9394,4158,11609,4981,9377,7282,2227,5595,10468,1397,3855,1821,6494,7099,11910,1588,8208,2310,7350,1603,11779,11694,3553,8211,3875,3403,9997,2430,3184,9286,12217,7681,4824,4822,2519,7794,3307,3181,2488,3965,2259,6854,8979,7588,5393,5994,8584,2029,11755,4024,8766,11399,6663,7444,11903,911,5208,7576,2908,10865,11483,7988,5093,1816,4676,3001,904,12252,10186,4608,1944,7879,11383,7405,557,6923,3287,9657,10897,5219,6409,9265,7287,3804,10101,8021,5281,3623,9504,4646,8803,4465,8816,2843,10323,100,4501,1069,3347,10370,8666,8751,6333,6784,2196,12270,3279,7529,915,9455,7154,10135,1710,8511,6976,8373,9010,11213,9913,4101,12209,9562,11350,4151,7802,3954,2342,1011,8234,5167,5770,7352,12168,6421,6253,5869,4916,4752,10011,9190,1163,6614,2181,10034,243,2773,7545,8934,7854,877,3189,12203,5496,5111,6489,2765,10278,857,10024,7630,5700,8221,11141,4362,6360,5145,6762,5691,8617,10075,7289,872,1414,90,2408,9189,4561,1274,7699,526,6795,8265,2803,11306,8861,2845,5057,3366,5921,8108,5780,10446,4259,9905,1616,8774,232,2070,4435,3736,513,1963,10878,10797,8532,3961,2762,3585,3665,3971,4137,9074,5552,2358,2729,4914,313,3504,7056,2583,11050,7736,4894,3764,1716,3401,7957,5578,9689,9729,1323,7262,2326,1008,8622,1908,6670,12098,8542,7614,11331,9447,10176,11576,7133,9790,8550,3175,1929,4702,9353,3352,1788,6913,6131,5845,4293,11041,10834,11262,8277,5617,11590,6508,60,3290,5166,2551,1831,7975,10611,8820,10173,8465,1985,11964,1626,1710,7496,4220,1958,8533,10371,9148,4021,2711,3983,782,4934,8191,1679,10030,5146,7093,2100,1535,1433,9465,3855,9679,778,11238,5661,4664,9177,9826,11481,11955,8750,3282,1234,4320,7581,11158,11355,11397];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.ntt_sm2[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "We are ZKNox";
        sig.salt =
            "\x16\x1a\x97\xe0\xf4\xc6\x89\x2a\xea\x94\x2a\x85\xf1\x01\xad\x3a\x6b\x54\xe0\x5c\xa4\x30\xfa\x33\x8c\x46\xd5\xc4\x50\x04\xa5\x7b\x73\x4f\x55\x14\x41\x5c\x71\x93";
        address recovered_pk_3;
        recovered_pk_3 = falconrec.recover(message, sig);
        assertEq(pk_3, recovered_pk_3);
    }
}
