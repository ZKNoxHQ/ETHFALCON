// code generated using pythonref/generate_falcon_epervier_tetration_test_vectors.py.
pragma solidity ^0.8.25;

import {Test, console} from "forge-std/Test.sol";
import "../src/ZKNOX_NTT.sol";
import "../src/ZKNOX_falcon_epervier_tetration.sol";

contract ZKNOX_falcon_epervierTest is Test {
    ZKNOX_falcon_epervier_tetration epervier;
    //exemple of stateless initialisation, no external contract provided
    ZKNOX_NTT ntt = new ZKNOX_NTT(address(0), address(0), 12289, 12265);
    // forgefmt: disable-next-line
    uint256[1024] psi_rev = [uint256(1), 1479, 4043, 7143, 5736, 4134, 1305, 722, 1646, 1212, 6429, 9094, 3504, 8747, 9744, 8668, 4591, 6561, 5023, 6461, 10938, 4978, 6512, 8961, 11340, 9664, 9650, 4821, 563, 9314, 2744, 3006, 1000, 4320, 12208, 3091, 9326, 4896, 2366, 9238, 11563, 7678, 1853, 140, 1635, 9521, 11112, 4255, 7203, 10963, 9088, 9275, 790, 955, 11119, 2319, 9542, 4846, 3135, 3712, 9995, 11227, 3553, 7484, 544, 5791, 11950, 2468, 11267, 9, 9447, 11809, 10616, 8011, 7300, 6958, 1381, 2525, 4177, 8705, 2837, 5374, 4354, 130, 2396, 4452, 3296, 8340, 12171, 9813, 2197, 5067, 11336, 3748, 5767, 827, 3284, 2881, 5092, 10200, 10276, 9000, 9048, 11560, 10593, 10861, 334, 2426, 4632, 5755, 11029, 4388, 10530, 3707, 3694, 7110, 11934, 3382, 2548, 8058, 4890, 6378, 9558, 3932, 5542, 12144, 3459, 3637, 1663, 1777, 1426, 7635, 2704, 5291, 7351, 8653, 9140, 160, 12286, 7852, 2166, 8374, 7370, 12176, 3364, 10600, 9018, 4057, 2174, 7917, 2847, 7875, 7094, 9509, 10805, 4895, 2305, 5042, 4053, 9644, 3985, 7384, 476, 3531, 420, 6730, 2178, 1544, 9273, 243, 9289, 11618, 3136, 5191, 8889, 9890, 9103, 6882, 10163, 1630, 11136, 2884, 8241, 10040, 3247, 9603, 2969, 3978, 6957, 3510, 9919, 9424, 7575, 8146, 1537, 12047, 8585, 2678, 5019, 545, 7404, 1017, 10657, 7205, 10849, 8526, 3066, 12262, 11244, 2859, 2481, 7277, 2912, 5698, 354, 7428, 390, 11516, 3778, 8456, 442, 2401, 5101, 11222, 4976, 10682, 875, 3780, 7278, 11287, 5088, 4284, 6022, 9302, 2437, 3646, 10102, 9723, 6039, 9867, 11854, 7952, 10911, 1912, 11796, 8193, 9908, 5444, 9041, 1207, 5277, 1168, 11885, 4645, 1065, 2143, 3957, 2839, 10162, 151, 11858, 1579, 2505, 5906, 52, 3174, 1323, 2766, 3336, 6055, 6415, 677, 3445, 7509, 4698, 5057, 12097, 10968, 10240, 4912, 5241, 9369, 3127, 4169, 3482, 787, 6821, 11279, 12231, 241, 11286, 3532, 11404, 6008, 10333, 7280, 2844, 3438, 8077, 975, 5681, 8812, 142, 1105, 4080, 421, 3602, 6221, 4624, 6212, 3263, 8689, 5886, 4782, 5594, 3029, 4213, 504, 605, 9987, 2033, 8291, 10367, 8410, 11316, 11035, 10930, 5435, 3710, 6196, 6950, 5446, 8301, 468, 11973, 11907, 6152, 4948, 11889, 10561, 6153, 6427, 3643, 5415, 56, 9090, 5206, 6760, 1702, 10302, 11635, 3565, 5315, 8214, 7373, 4324, 10120, 11767, 5079, 3262, 11011, 2344, 6715, 1973, 5925, 1018, 3514, 11248, 7500, 7822, 5537, 4749, 8500, 12142, 5456, 7840, 6844, 8429, 7753, 1050, 6118, 3818, 9606, 1190, 5876, 2281, 2031, 5333, 8298, 8320, 12133, 2767, 453, 6381, 418, 3772, 5429, 4774, 1293, 7552, 2361, 1843, 9259, 4115, 218, 2908, 8855, 8760, 2882, 10484, 1954, 2051, 2447, 6147, 576, 3963, 1858, 7535, 3315, 11863, 2925, 347, 3757, 1975, 10596, 3009, 174, 11566, 9551, 5868, 2655, 6554, 1512, 11939, 5383, 10474, 9087, 7796, 6920, 10232, 6374, 1483, 49, 11026, 1489, 2500, 10706, 5942, 1404, 11964, 11143, 948, 4049, 3728, 1159, 5990, 652, 5766, 6190, 11994, 4016, 4077, 2919, 3762, 6328, 7183, 10695, 1962, 7991, 8960, 12121, 9597, 7105, 1200, 6122, 9734, 3956, 1360, 6119, 5297, 3054, 6803, 9166, 1747, 5919, 4433, 3834, 5257, 683, 2459, 8633, 12225, 9786, 9341, 6507, 1566, 11454, 6224, 3570, 8049, 3150, 1319, 4046, 11580, 1958, 7967, 2078, 1112, 11231, 8210, 11367, 441, 1826, 9363, 9118, 4489, 3708, 3238, 11153, 3449, 7080, 1092, 3359, 3205, 8024, 8611, 10361, 11825, 2068, 10900, 4404, 346, 3163, 8257, 7449, 6127, 12164, 11749, 10763, 4222, 8051, 11677, 8921, 8062, 7228, 11071, 11851, 3515, 9011, 5993, 6877, 8080, 1536, 10568, 4103, 9860, 11572, 8700, 1373, 2982, 3448, 11946, 4538, 1908, 4727, 11081, 1866, 7078, 10179, 716, 10125, 6873, 1705, 2450, 11475, 416, 10224, 5826, 7725, 8794, 1756, 4145, 8755, 8328, 5063, 4176, 8524, 10771, 2461, 2275, 8022, 5653, 6693, 6302, 11710, 3889, 212, 6323, 9175, 2769, 5734, 1176, 5508, 11014, 4860, 11164, 11158, 10844, 11841, 1014, 7508, 7365, 10962, 3607, 5232, 8347, 12221, 10029, 7723, 5836, 3200, 1535, 9572, 60, 7784, 10032, 10872, 5676, 3087, 6454, 7406, 3975, 7326, 8545, 2528, 3056, 5845, 5588, 11877, 5102, 1255, 506, 10897, 5784, 9615, 2212, 3338, 9013, 1178, 9513, 6811, 8778, 10347, 3408, 1165, 2575, 10453, 425, 11897, 10104, 377, 4578, 375, 1620, 1038, 11366, 6085, 4167, 6092, 2231, 2800, 12096, 1522, 2151, 8946, 8170, 5002, 12269, 7681, 5163, 10545, 1314, 2894, 3654, 11951, 3947, 9834, 6599, 7350, 7174, 1248, 2442, 8330, 6492, 6330, 10141, 5724, 10964, 1945, 1029, 8945, 6691, 10397, 3624, 6825, 4906, 4670, 512, 7735, 11295, 9389, 12050, 1804, 1403, 6195, 7100, 406, 10602, 7021, 12143, 8914, 9998, 7954, 3393, 8464, 8054, 7376, 8761, 11667, 1737, 4499, 5672, 8307, 9342, 11653, 5609, 4605, 2689, 180, 8151, 5219, 1409, 204, 6780, 9806, 2054, 1344, 9247, 463, 8882, 3981, 1468, 4475, 7043, 3017, 1236, 9168, 4705, 2600, 11232, 4739, 4251, 1226, 6771, 11925, 2360, 3028, 5216, 11839, 10345, 11711, 5368, 11779, 7628, 2622, 6903, 8929, 7605, 7154, 12226, 8481, 8619, 2373, 7302, 10891, 9199, 826, 5043, 5789, 8787, 6671, 10631, 9224, 1506, 7806, 5703, 4719, 11538, 6389, 11379, 4693, 9951, 11872, 9996, 6138, 8820, 4443, 8871, 7186, 10398, 1802, 10734, 1590, 4411, 1223, 2334, 2946, 6828, 2637, 4510, 881, 365, 10362, 1015, 7250, 6742, 2485, 904, 24, 10918, 11009, 11675, 980, 11607, 5082, 7699, 5207, 8239, 844, 7087, 3221, 8016, 8452, 2595, 5289, 6627, 567, 2941, 1406, 2633, 6940, 2945, 3232, 11996, 3769, 7434, 3944, 8190, 6759, 5604, 11024, 9282, 10118, 8809, 9169, 6184, 6643, 6086, 8753, 5370, 8348, 8536, 1282, 3572, 9457, 2021, 4730, 3229, 1706, 3929, 5054, 3154, 9004, 7929, 12282, 1936, 8566, 11444, 11520, 5526, 50, 216, 767, 3805, 4153, 10076, 1279, 11424, 9617, 5170, 12100, 3116, 10080, 1763, 3815, 1734, 1350, 5832, 8420, 4423, 1530, 1694, 10036, 10421, 9559, 5411, 4820, 1160, 9195, 7771, 2840, 9811, 4194, 9270, 7315, 4565, 7211, 10506, 944, 7519, 7002, 8620, 7624, 6883, 3020, 5673, 5410, 1251, 10499, 7014, 2035, 11249, 6164, 10407, 8176, 12217, 10447, 3840, 2712, 4834, 2828, 4352, 1241, 4378, 3451, 4094, 3045, 5781, 9646, 11194, 7592, 8711, 8823, 10588, 7785, 11511, 2626, 530, 10808, 9332, 9349, 2046, 8972, 9757, 8957, 12150, 3268, 3795, 1849, 6513, 4523, 4301, 457, 8, 8835, 3758, 8071, 4390, 10013, 982, 2593, 879, 9687, 10388, 11787, 7171, 6063, 8496, 8443, 1573, 5969, 4649, 9360, 6026, 1030, 11823, 10608, 8468, 11415, 9988, 5650, 12119, 648, 12139, 2307, 8000, 11498, 9855, 9416, 2827, 9754, 11169, 21, 6481];

    // forgefmt: disable-next-line
    uint256[1024] psi_inv_rev = [uint256(1), 10810, 5146, 8246, 11567, 10984, 8155, 6553, 3621, 2545, 3542, 8785, 3195, 5860, 11077, 10643, 9283, 9545, 2975, 11726, 7468, 2639, 2625, 949, 3328, 5777, 7311, 1351, 5828, 7266, 5728, 7698, 4805, 8736, 1062, 2294, 8577, 9154, 7443, 2747, 9970, 1170, 11334, 11499, 3014, 3201, 1326, 5086, 8034, 1177, 2768, 10654, 12149, 10436, 4611, 726, 3051, 9923, 7393, 2963, 9198, 81, 7969, 11289, 8652, 8830, 145, 6747, 8357, 2731, 5911, 7399, 4231, 9741, 8907, 355, 5179, 8595, 8582, 1759, 7901, 1260, 6534, 7657, 9863, 11955, 1428, 1696, 729, 3241, 3289, 2013, 2089, 7197, 9408, 9005, 11462, 6522, 8541, 953, 7222, 10092, 2476, 118, 3949, 8993, 7837, 9893, 12159, 7935, 6915, 9452, 3584, 8112, 9764, 10908, 5331, 4989, 4278, 1673, 480, 2842, 12280, 1022, 9821, 339, 6498, 11745, 10146, 11224, 7644, 404, 11121, 7012, 11082, 3248, 6845, 2381, 4096, 493, 10377, 1378, 4337, 435, 2422, 6250, 2566, 2187, 8643, 9852, 2987, 6267, 8005, 7201, 1002, 5011, 8509, 11414, 1607, 7313, 1067, 7188, 9888, 11847, 3833, 8511, 773, 11899, 4861, 11935, 6591, 9377, 5012, 9808, 9430, 1045, 27, 9223, 3763, 1440, 5084, 1632, 11272, 4885, 11744, 7270, 9611, 3704, 242, 10752, 4143, 4714, 2865, 2370, 8779, 5332, 8311, 9320, 2686, 9042, 2249, 4048, 9405, 1153, 10659, 2126, 5407, 3186, 2399, 3400, 7098, 9153, 671, 3000, 12046, 3016, 10745, 10111, 5559, 11869, 8758, 11813, 4905, 8304, 2645, 8236, 7247, 9984, 7394, 1484, 2780, 5195, 4414, 9442, 4372, 10115, 8232, 3271, 1689, 8925, 113, 4919, 3915, 10123, 4437, 3, 12129, 3149, 3636, 4938, 6998, 9585, 4654, 10863, 10512, 10626, 11848, 922, 4079, 1058, 11177, 10211, 4322, 10331, 709, 8243, 10970, 9139, 4240, 8719, 6065, 835, 10723, 5782, 2948, 2503, 64, 3656, 9830, 11606, 7032, 8455, 7856, 6370, 10542, 3123, 5486, 9235, 6992, 6170, 10929, 8333, 2555, 6167, 11089, 5184, 2692, 168, 3329, 4298, 10327, 1594, 5106, 5961, 8527, 9370, 8212, 8273, 295, 6099, 6523, 11637, 6299, 11130, 8561, 8240, 11341, 1146, 325, 10885, 6347, 1583, 9789, 10800, 1263, 12240, 10806, 5915, 2057, 5369, 4493, 3202, 1815, 6906, 350, 10777, 5735, 9634, 6421, 2738, 723, 12115, 9280, 1693, 10314, 8532, 11942, 9364, 426, 8974, 4754, 10431, 8326, 11713, 6142, 9842, 10238, 10335, 1805, 9407, 3529, 3434, 9381, 12071, 8174, 3030, 10446, 9928, 4737, 10996, 7515, 6860, 8517, 11871, 5908, 11836, 9522, 156, 3969, 3991, 6956, 10258, 10008, 6413, 11099, 2683, 8471, 6171, 11239, 4536, 3860, 5445, 4449, 6833, 147, 3789, 7540, 6752, 4467, 4789, 1041, 8775, 11271, 6364, 10316, 5574, 9945, 1278, 9027, 7210, 522, 2169, 7965, 4916, 4075, 6974, 8724, 654, 1987, 10587, 5529, 7083, 3199, 12233, 6874, 8646, 5862, 6136, 1728, 400, 7341, 6137, 382, 316, 11821, 3988, 6843, 5339, 6093, 8579, 6854, 1359, 1254, 973, 3879, 1922, 3998, 10256, 2302, 11684, 11785, 8076, 9260, 6695, 7507, 6403, 3600, 9026, 6077, 7665, 6068, 8687, 11868, 8209, 11184, 12147, 3477, 6608, 11314, 4212, 8851, 9445, 5009, 1956, 6281, 885, 8757, 1003, 12048, 58, 1010, 5468, 11502, 8807, 8120, 9162, 2920, 7048, 7377, 2049, 1321, 192, 7232, 7591, 4780, 8844, 11612, 5874, 6234, 8953, 9523, 10966, 9115, 12237, 6383, 9784, 10710, 431, 12138, 2127, 9450, 8332, 5808, 12268, 1120, 2535, 9462, 2873, 2434, 791, 4289, 9982, 150, 11641, 170, 6639, 2301, 874, 3821, 1681, 466, 11259, 6263, 2929, 7640, 6320, 10716, 3846, 3793, 6226, 5118, 502, 1901, 2602, 11410, 9696, 11307, 2276, 7899, 4218, 8531, 3454, 12281, 11832, 7988, 7766, 5776, 10440, 8494, 9021, 139, 3332, 2532, 3317, 10243, 2940, 2957, 1481, 11759, 9663, 778, 4504, 1701, 3466, 3578, 4697, 1095, 2643, 6508, 9244, 8195, 8838, 7911, 11048, 7937, 9461, 7455, 9577, 8449, 1842, 72, 4113, 1882, 6125, 1040, 10254, 5275, 1790, 11038, 6879, 6616, 9269, 5406, 4665, 3669, 5287, 4770, 11345, 1783, 5078, 7724, 4974, 3019, 8095, 2478, 9449, 4518, 3094, 11129, 7469, 6878, 2730, 1868, 2253, 10595, 10759, 7866, 3869, 6457, 10939, 10555, 8474, 10526, 2209, 9173, 189, 7119, 2672, 865, 11010, 2213, 8136, 8484, 11522, 12073, 12239, 6763, 769, 845, 3723, 10353, 7, 4360, 3285, 9135, 7235, 8360, 10583, 9060, 7559, 10268, 2832, 8717, 11007, 3753, 3941, 6919, 3536, 6203, 5646, 6105, 3120, 3480, 2171, 3007, 1265, 6685, 5530, 4099, 8345, 4855, 8520, 293, 9057, 9344, 5349, 9656, 10883, 9348, 11722, 5662, 7000, 9694, 3837, 4273, 9068, 5202, 11445, 4050, 7082, 4590, 7207, 682, 11309, 614, 1280, 1371, 12265, 11385, 9804, 5547, 5039, 11274, 1927, 11924, 11408, 7779, 9652, 5461, 9343, 9955, 11066, 7878, 10699, 1555, 10487, 1891, 5103, 3418, 7846, 3469, 6151, 2293, 417, 2338, 7596, 910, 5900, 751, 7570, 6586, 4483, 10783, 3065, 1658, 5618, 3502, 6500, 7246, 11463, 3090, 1398, 4987, 9916, 3670, 3808, 63, 5135, 4684, 3360, 5386, 9667, 4661, 510, 6921, 578, 1944, 450, 7073, 9261, 9929, 364, 5518, 11063, 8038, 7550, 1057, 9689, 7584, 3121, 11053, 9272, 5246, 7814, 10821, 8308, 3407, 11826, 3042, 10945, 10235, 2483, 5509, 12085, 10880, 7070, 4138, 12109, 9600, 7684, 6680, 636, 2947, 3982, 6617, 7790, 10552, 622, 3528, 4913, 4235, 3825, 8896, 4335, 2291, 3375, 146, 5268, 1687, 11883, 5189, 6094, 10886, 10485, 239, 2900, 994, 4554, 11777, 7619, 7383, 5464, 8665, 1892, 5598, 3344, 11260, 10344, 1325, 6565, 2148, 5959, 5797, 3959, 9847, 11041, 5115, 4939, 5690, 2455, 8342, 338, 8635, 9395, 10975, 1744, 7126, 4608, 20, 7287, 4119, 3343, 10138, 10767, 193, 9489, 10058, 6197, 8122, 6204, 923, 11251, 10669, 11914, 7711, 11912, 2185, 392, 11864, 1836, 9714, 11124, 8881, 1942, 3511, 5478, 2776, 11111, 3276, 8951, 10077, 2674, 6505, 1392, 11783, 11034, 7187, 412, 6701, 6444, 9233, 9761, 3744, 4963, 8314, 4883, 5835, 9202, 6613, 1417, 2257, 4505, 12229, 2717, 10754, 9089, 6453, 4566, 2260, 68, 3942, 7057, 8682, 1327, 4924, 4781, 11275, 448, 1445, 1131, 1125, 7429, 1275, 6781, 11113, 6555, 9520, 3114, 5966, 12077, 8400, 579, 5987, 5596, 6636, 4267, 10014, 9828, 1518, 3765, 8113, 7226, 3961, 3534, 8144, 10533, 3495, 4564, 6463, 2065, 11873, 814, 9839, 10584, 5416, 2164, 11573, 2110, 5211, 10423, 1208, 7562, 10381, 7751, 343, 8841, 9307, 10916, 3589, 717, 2429, 8186, 1721, 10753, 4209, 5412, 6296, 3278, 8774, 438, 1218, 5061, 4227, 3368, 612, 4238, 8067, 1526, 540, 125, 6162, 4840, 4032, 9126, 11943, 7885, 1389, 10221, 464, 1928, 3678, 4265, 9084, 8930, 11197, 5209, 8840, 1136, 9051, 8581, 7800, 3171, 2926, 10463];

    //stateful initialisation
    function setUp() public {
        bytes memory bytecode_psirev = abi.encodePacked(psi_rev);

        address a_psirev; //address of the precomputations bytecode contract
        a_psirev = address(uint160(0xcaca)); //here it is etched, use create in the future
        vm.etch(a_psirev, bytecode_psirev); //pushing psirev bytecode into contract todo : replace with create

        bytes memory bytecode_psiInvrev = abi.encodePacked(psi_inv_rev);

        address a_psiInvrev; //address of the precomputations bytecode contract
        a_psiInvrev = address(uint160(0xa5a5)); //here it is etched, use create in the future
        vm.etch(a_psiInvrev, bytecode_psiInvrev); //pushing psirev bytecode into contract todo : replace with create

        ntt.update(a_psirev, a_psiInvrev, 12289, 12265); //update ntt with outer contract

        epervier = new ZKNOX_falcon_epervier_tetration(ntt);
    }

    function testVector0() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_0 = address(1241080179793602647909185613605026912518406732206);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(58), 12021,12188,12280,75,12131,158,30,189,104,160,66,8,12129,96,12153,46,12071,47,114,12270,12239,139,161,148,12258,201,148,12229,12013,141,12143,23,12261,175,12278,12087,3,12255,12113,12252,12267,11971,12210,12084,12263,12225,414,12174,12059,12122,12251,12214,137,294,12254,7,9,12164,93,141,12287,111,11,5,12251,61,193,13,12180,65,260,12170,200,298,80,12062,12268,138,12231,11921,48,12266,294,12092,1,132,12271,12282,12260,12219,12204,11,110,101,12076,12157,12189,74,184,134,12255,11,12264,12196,12036,12000,12073,226,76,240,78,160,12174,12275,146,12226,11940,74,80,12253,12182,12211,12158,87,12199,12035,11787,221,6,12231,250,12042,12122,434,18,12154,61,12196,204,211,12268,12220,12194,12211,12191,11984,12273,7,12136,12202,160,80,126,193,108,170,12149,94,12264,110,12238,12195,15,12156,61,53,12262,97,12054,12260,12023,12242,12280,19,128,63,12234,12186,20,12113,12214,12261,12101,12092,133,12205,165,12201,43,12219,11976,3,257,12216,69,12118,137,3,11,18,10,12109,12243,361,59,40,176,122,110,12046,12201,12146,12186,99,12205,164,12068,12182,36,12271,128,164,63,113,24,12254,12136,12190,34,12184,102,12273,159,12259,12205,12172,12120,12199,12247,34,12132,12111,31,134,12247,12233,12103,12271,110,12123,91,259,12237,54,220,99,112,12258,12245,12114,51,12256,12117,12262,63,57,12278,12003,12169,79,102,12265,12219,125,12177,75,12252,12208,12107,111,66,171,0,153,12224,164,176,11868,395,12240,12170,12056,132,64,50,50,133,12146,73,12185,11993,256,12134,225,108,251,12197,12177,12268,9,38,230,75,12258,57,92,12044,12110,264,174,161,12197,12054,299,74,12109,329,97,50,12030,58,217,49,12207,340,287,12250,414,12183,12155,266,11907,78,137,189,88,12124,149,12178,12243,81,186,223,12181,12082,227,12161,12121,12244,65,12146,96,12232,64,187,143,72,12256,62,84,10,254,12181,12283,12261,58,11972,224,439,24,12019,12235,12181,12218,12276,70,35,98,12099,86,12020,4,224,42,60,12107,12225,289,12211,125,12263,12272,11987,12203,12134,461,253,12193,38,12188,82,444,12256,72,12110,12253,21,12281,204,172,182,12020,12195,12169,12020,12070,103,193,12142,12240,12273,12107,12160,11966,52,12179,12276,12126,12126,12197,12276,252,12050,92,128,11930,12278,37,12230,12274,248,80,99,110,12130,22,12015,12261,259,183,32,3,175,12155,42,51,12037,319,12094,12196,12242,12035,2,12248,12229,12200,224,12181,12109,12176,12268,12104,12207,12271,22,231,17,12212,12203,80,200,331,12272,80,12216,12150,12150,12178,12184,12089,149,12090,12173,12035,12182,12215,148,12158,12246,54,206];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(12189), 253,12275,406,12187,59,285,152,12257,165,12227,26,8,85,12137,12164,122,232,12110,118,149,12008,12286,12272,64,199,76,12237,12280,335,129,24,12251,137,12251,38,250,12245,12176,12048,109,35,173,404,12127,12088,3,206,325,222,299,147,190,182,152,12049,12264,46,173,112,168,114,12180,12282,114,12092,89,12215,12173,12160,186,21,12131,84,12189,12249,12207,39,63,172,93,12194,19,12252,12160,15,12140,4,396,12105,12219,153,12237,12043,12228,12245,269,12034,92,353,12256,12196,38,130,12240,12051,12154,12255,202,12160,12263,12251,123,41,12033,12079,69,12263,17,34,12278,12231,12265,12153,106,67,17,136,12256,15,12204,12185,12087,276,12112,12210,61,23,12152,12136,97,12272,6,12126,156,12127,12211,12091,104,12034,12254,67,12022,12260,12141,12244,276,66,12158,263,12158,11982,26,112,154,12288,64,12021,128,44,12257,128,12205,12288,12277,11956,11745,11940,12126,12240,12122,12181,12170,12064,279,12092,12194,126,108,141,395,4,12036,12257,12203,95,12089,12252,120,12214,12244,12272,130,12230,12123,12197,12122,60,12245,213,173,47,239,145,12090,12128,12157,12017,307,75,120,12205,12187,153,12190,12180,22,76,12007,121,12228,94,20,12148,79,51,12019,83,182,427,12203,63,40,216,12180,12093,12106,88,143,208,160,28,273,193,12205,89,196,12167,278,12243,12175,12249,12168,11958,12143,12165,12106,12272,89,336,18,58,12277,147,79,149,12266,81,12219,21,12202,12284,12179,12037,12106,339,11895,107,12112,12059,2,12265,208,355,361,12047,31,304,114,12217,12116,80,202,12055,12188,52,125,12258,12071,12237,12081,12041,12165,180,12128,85,327,12018,327,44,12246,51,135,33,12255,24,5,67,12089,12219,12097,12277,12181,12106,92,73,12272,12195,100,12033,12281,187,185,31,11963,12281,71,84,416,12186,12202,12157,12178,141,13,143,95,12068,12086,234,12209,40,12261,12074,12132,323,17,131,60,12074,12091,12060,133,43,12119,12180,83,12195,12263,11902,12192,12213,38,12278,508,12148,12217,62,12260,12171,162,44,11974,12133,83,12165,12225,50,12237,49,12221,149,12144,87,39,35,35,12279,12164,149,182,130,12258,167,11981,12193,12058,12081,95,318,170,12220,102,146,208,275,83,237,82,12247,12182,12233,60,12252,304,12033,12221,167,121,12152,82,11927,12099,12151,12206,89,12209,183,30,12283,78,12239,12111,12224,232,12272,12093,111,152,105,109,14,12248,12035,1,12003,165,225,12129,197,70,99,293,11985,26,12148,12183,12076,12134,129,12191,12279,12024,12006,17,12181,215,518,128,12256,12100,26,276,12185,15,41,12280,12128,102,269,231,12037,12094,96,134,12027,12125,12215,310,12065,12170,12034];

        ZKNOX_falcon_epervier_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(9700), 948,4244,10277,1362,4545,6161,5142,5343,8296,7061,2982,8285,6111,1394,10242,464,4647,2967,46,2365,10947,881,12041,5526,441,495,8162,1267,9768,3661,1275,8140,5082,7773,5656,10232,7963,11956,5836,10895,8523,1143,3847,2433,2735,3825,2035,8737,7424,9968,7509,8359,650,9796,8360,5820,5357,7896,9620,10322,6334,9046,3292,5656,4104,526,9354,11171,11360,7205,5881,1113,8444,4347,2207,1593,1523,9721,8592,4137,1174,9113,1256,3440,9140,10669,10181,10976,429,2013,8198,9542,6345,10242,393,8844,10428,3695,11560,9137,995,9246,7219,10086,9671,563,5382,5183,11188,8948,1928,3377,5806,10216,6937,4785,5348,3961,4292,4668,9795,11571,9181,4985,5203,8217,7318,3756,5109,2771,2930,4711,11682,3030,9399,10359,1380,1800,5239,4236,3909,2986,2605,3712,5439,1470,10987,8097,7605,6689,10112,1046,3491,738,3614,4624,4599,9548,3361,6589,8951,11247,6748,4011,3323,6886,10215,3620,8776,6237,6385,6559,3174,3367,10089,8271,3128,8618,3353,9448,1075,8329,1919,7759,8944,3982,4471,10185,8362,11965,6961,7661,276,7305,6312,7336,1837,6331,1467,4243,8296,6224,5945,9888,6710,8511,2124,6200,7053,3930,9721,5824,6682,8428,567,6110,8682,8537,1519,11807,4230,3905,4276,11495,4245,3314,12042,1024,2630,11373,3829,8082,8468,11017,8458,7721,1577,173,9143,2063,12186,688,6154,1396,7065,1412,7928,9942,6571,5740,2455,6205,4503,9575,3689,3057,6578,2385,9154,2203,6259,7529,752,8584,9990,7947,1184,8359,9941,3602,978,11187,2305,2399,2882,2383,403,10176,4531,3544,4289,4422,9451,11473,8093,10138,584,8228,5071,3456,3833,9661,8488,5453,2603,5192,8100,3303,1126,4525,6889,4600,8926,3274,2014,10038,4562,6417,5939,892,4005,4250,8117,10706,278,802,11863,5327,8460,1978,2727,11839,8906,11634,4448,3693,9035,4654,7781,11929,3424,9765,9965,5724,1646,11077,4982,6265,5900,2645,9127,8178,3948,1913,3458,159,10082,6625,9314,2934,10547,4395,7985,5299,11418,9036,1485,236,3684,10164,821,11762,6914,9112,2577,341,2397,10968,9080,5697,1581,2371,11748,11425,3661,1134,1717,2183,10408,2496,5757,9818,3252,3209,6082,6698,11289,4730,8611,8062,7255,1741,5363,2277,6417,2455,9346,8211,5570,7755,5912,6035,7915,4122,2815,11376,7948,10600,4921,5746,2536,2189,5110,11069,5463,7827,5070,10841,5177,788,1078,7144,2889,1007,4737,8778,6413,8916,7979,8202,6479,6751,10358,11415,9070,10409,5545,10831,12080,10750,8746,10922,4531,2499,4837,8026,1325,6827,1246,1940,2737,11671,10896,10488,8535,4304,10594,3966,5611,3922,5619,6950,6923,4225,502,6732,9329,11377,11396,5058,3512,3098,12085,4973,2599,6607,8110,4701,9756,6198,1290,5424,10386,6232,4277,5259,9632,5742,11600,10014,8674,2692,8405,3958,5035,4035,352,8223,181,4609,5244,11739,8611,4693,4147,8180,7910,5878,9412,1036,1491];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.hint[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "My name is Renaud";
        sig.salt =
            "\x35\x00\x31\x8f\x75\xad\x20\xf0\xaa\x20\x62\xba\x1c\x34\x8a\xfe\xaa\x49\x23\x87\xa4\x63\xeb\x8c\x28\xaf\x77\x9d\x6a\x3e\xa6\x96\xeb\xb9\x66\x0c\xcf\xf5\x06\x2d";
        address recovered_pk_0;
        recovered_pk_0 = epervier.recover(message, sig);
        assertEq(pk_0, recovered_pk_0);
    }

    function testVector1() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_1 = address(1241080179793602647909185613605026912518406732206);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(162), 12193,12062,7,12119,443,12055,140,35,86,12054,76,83,174,12058,12106,12159,117,12209,51,101,155,62,39,12102,118,159,14,12203,12130,41,110,145,12090,229,12143,12248,72,4,12211,283,12062,12020,71,77,12144,137,154,11911,12185,12171,118,12186,132,125,184,16,12192,12254,12278,114,12205,12243,73,82,12157,12281,382,31,8,172,12085,69,125,12059,24,296,166,12084,12069,12106,12201,45,313,45,62,12146,172,12168,12195,12215,12249,12210,12186,146,13,219,12208,12204,12277,12179,12118,12154,12062,12254,12088,119,12259,12056,12120,91,12247,76,256,12281,88,208,12202,12272,12162,11988,20,283,435,231,12054,540,12039,183,12190,233,31,12284,168,93,109,231,12197,12065,128,297,12209,12084,56,0,137,21,12278,29,12127,12221,12137,239,208,12201,12276,12280,12100,12265,121,12037,63,9,107,129,156,7,49,12254,64,12259,12181,178,19,114,180,43,152,274,2,12132,11938,12062,56,12173,132,12126,12165,12151,243,12266,105,39,12061,95,12254,79,101,12187,11929,84,12134,12055,39,12126,209,12288,12283,24,12234,12136,36,12058,281,12102,12015,39,11932,157,2,75,12265,12214,12277,30,102,12139,9,12055,12197,11792,12073,12049,12199,12237,69,0,12034,133,12279,32,121,12185,128,12252,11930,9,12281,0,12227,11,12251,12057,12269,11891,106,80,33,11977,12261,3,13,12080,12271,12252,52,12229,1,133,12285,138,12200,114,98,12182,12140,213,2,194,12028,12236,12130,12077,108,12232,9,47,14,12076,28,54,142,12112,126,12223,12239,202,12045,12175,12049,12287,12077,147,12287,22,100,12196,26,159,12087,12240,266,204,231,11994,102,255,12204,12237,12177,0,12257,12170,12110,12253,151,12037,82,12206,12270,12151,71,12151,12025,12130,11990,336,101,12284,9,12222,12166,12212,152,12080,144,129,12282,12204,12214,12235,12032,12228,12179,24,100,116,12240,28,164,12059,12110,246,239,174,12156,144,143,12014,12050,0,3,12059,12271,12202,12281,48,101,290,256,12251,128,12282,351,12020,82,79,12070,81,73,12061,12137,12253,36,420,129,12198,287,257,155,343,12231,19,12204,12259,12183,298,258,11841,12265,162,122,12133,12143,12125,12003,12288,12212,12194,11929,44,4,45,12275,12134,112,123,204,358,25,48,14,161,152,38,12183,216,12138,12233,12241,14,121,133,12287,11936,181,12247,95,12230,83,135,201,12093,173,12204,169,10,19,192,12121,12272,12288,12172,79,66,30,144,14,12133,154,102,155,122,124,12255,170,116,12153,12145,103,126,76,79,12150,12284,294,87,12199,277,12083,22,12190,82,76,12215,72,12189,12203,142,12220,12030,65,12086,12186,140,5,350,12125,40,395,40,12179];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(244), 12128,12021,12098,12064,289,12200,110,12235,220,12111,386,40,12187,145,12195,11826,47,216,119,178,12279,12164,62,135,121,152,12284,225,11950,12232,12139,69,235,12265,134,12020,12006,12090,50,139,12133,12248,196,12156,12256,12,12222,102,12212,44,12089,261,12059,12261,318,132,134,56,12278,56,79,12199,111,12219,329,12209,39,12234,415,12146,77,12063,29,51,143,157,12111,126,57,50,11976,127,70,12125,11952,12161,12252,11937,294,12118,11944,12203,131,87,12246,369,349,12285,12231,12136,12276,129,330,12060,12228,137,65,189,12286,12194,12208,139,12150,74,15,67,12137,100,39,40,12238,318,63,11944,5,12072,12172,12158,114,159,12220,12273,11970,12236,12032,12189,57,135,66,12228,12280,147,20,12083,12200,133,12233,12149,12160,12087,12055,12144,12211,27,12251,424,637,12286,107,12050,12190,12128,12058,130,61,371,12035,42,12023,80,157,12096,82,203,12240,179,12260,12245,310,72,94,105,113,170,11926,12254,167,102,181,198,12173,33,2,204,12189,12171,191,93,12072,99,10,12265,12103,68,12134,12247,69,131,12178,12215,119,11993,296,36,142,12166,182,12238,12253,39,12272,12147,206,183,365,48,44,194,12249,117,12251,81,155,12162,86,12074,12221,12067,12255,12001,12250,99,74,12235,114,205,168,11981,12014,12199,115,100,12,12268,135,9,12144,12281,43,2,261,48,12194,12236,220,90,73,12203,72,12141,12246,12260,12237,12080,37,50,75,12199,35,214,12078,12084,12,11915,11829,48,125,163,12095,185,193,122,63,107,234,12108,12023,12125,12073,12129,12227,12275,12183,148,11989,11974,12162,47,379,12174,12234,11995,12130,12160,12274,12260,62,12083,12093,86,56,12075,12235,12174,12147,11953,81,12072,102,12110,11947,89,226,137,180,12,12127,12013,12205,12010,38,12268,12238,12230,12112,12062,12263,12234,184,168,12158,220,12181,178,40,24,377,11,125,103,226,14,12225,12226,224,12134,210,53,11742,116,119,12232,12214,12158,12166,12174,272,31,12,60,1,21,145,314,12288,188,12000,42,47,12230,259,12152,12214,12259,357,47,36,266,12211,12172,114,180,130,12264,12274,12204,69,210,151,12223,86,12263,183,12037,12215,101,12137,12142,12133,12206,78,257,12229,149,342,26,288,13,12222,12151,11890,12187,20,24,12285,12171,13,12230,212,12192,197,12178,87,11888,102,12269,12241,12097,44,12098,90,24,43,298,12204,3,11929,12268,52,51,12172,12134,192,12178,218,20,12178,96,155,12172,181,322,11,163,12194,12288,117,12080,35,11922,169,209,87,171,12207,4,12090,12205,73,12078,12170,12022,194,12209,12122,26,95,12263,11991,12015,313,12002,12040,183,242,94,122,36,12215,193,12238];

        ZKNOX_falcon_epervier_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(383), 11021,4368,8563,6756,799,6521,5042,5918,9610,7123,4326,501,12228,4151,7762,5164,1683,694,6202,2733,10257,2794,3597,7207,4556,9425,10422,4425,11118,2986,2281,41,8975,7590,4336,5576,4417,9290,6997,8346,5698,11545,10779,5140,7386,11336,6511,1422,2480,7655,761,10751,4492,10222,5771,2043,8104,7994,9375,11093,2431,2106,300,3863,5831,11047,11092,1614,8178,12008,5734,6530,11314,6643,4771,10378,6191,5086,2224,2410,11993,7840,7127,910,1392,6298,8416,2421,1617,6061,6787,716,608,11336,4378,7353,1649,9869,7397,7291,11446,11603,11776,2722,9430,3323,6984,1617,753,5515,1642,2286,6607,5937,2278,1393,1657,2429,7643,2992,1135,11364,10138,5486,7563,9794,4068,6249,8514,9223,3192,3561,3517,9914,8495,40,4548,10287,8836,2945,11711,9431,9519,67,11129,1307,6179,7146,10855,974,10425,3616,8561,1802,8825,10888,2311,7471,7142,9339,4466,3213,11965,11763,2752,8889,2574,5060,5980,2181,4893,5035,4317,3322,629,2925,9065,11725,1012,7363,11480,3962,4362,969,2767,3937,2535,9896,7727,10466,11732,3719,3095,10853,5308,625,2409,10904,4978,951,5870,6043,10525,599,7896,9271,11228,6930,1040,2187,3562,9808,5009,4250,5156,7416,12083,3390,4392,7188,6442,1858,8114,5738,10274,10356,5931,3952,11416,7605,10498,3752,1132,7330,2800,5566,9283,2661,12200,10798,12117,8301,6446,3516,8075,8908,10620,9736,9828,10131,1180,6403,7358,10183,11519,4528,4940,5739,11383,2346,4349,8840,5990,8587,10956,2300,1649,10078,12256,2110,7082,3396,5151,9943,5735,6166,1650,8749,8344,12201,4044,2270,8700,6352,9825,11623,5275,2477,8406,1476,3990,7308,7836,7545,3337,10894,5915,2437,8358,5666,2901,814,10501,4137,3305,4050,8181,6199,2519,4371,8466,74,6683,9559,3737,8194,5256,433,11835,7317,9191,4246,9877,8288,5193,3668,9989,9388,2720,1433,3547,1671,716,2244,11120,9039,2893,7030,2117,11850,11877,4978,4381,7712,267,403,11061,3495,832,7976,1682,4867,11135,3804,4588,12002,9415,2753,4046,3265,5146,885,6193,6884,2046,1341,8517,4789,10532,2240,8217,6132,111,11828,6683,6670,2435,2063,7814,3429,5508,10975,4647,11870,651,7614,200,12079,11816,4378,10972,11357,1545,5892,2479,6463,6640,2532,603,368,10133,10902,4403,8238,2349,8281,10819,909,5962,5769,11403,12001,3596,4171,7964,3579,7486,3604,2663,12087,6576,8680,8844,1565,11374,6828,8911,9633,5614,874,3175,12120,1212,9783,4601,8452,8619,3061,82,12089,9068,3865,4896,11369,9094,6312,9403,7479,1999,11375,1513,7838,7818,3890,11713,6104,7146,7772,2429,6583,6111,478,11143,6245,4564,10224,7733,6231,3318,2251,5409,533,201,1284,1262,9631,8673,7882,4136,2139,9970,5815,1441,2761,9516,6404,442,5104,5365,3737,4758,4980,8995,3466,8414,2062,7838,12102,8969,1969,235,5036,4144,781,416,107,1016,4225,4169,10325,8070];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.hint[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "My name is Simon";
        sig.salt =
            "\xdb\xae\x77\x2d\xb2\x90\x58\xa8\x8f\x9b\xd8\x30\xe9\x57\xc6\x95\x34\x7c\x41\xb6\x16\x2a\x7e\xb9\xa9\xea\x13\xde\xf3\x4b\xe5\x6b\x8b\xbb\xb9\x64\xb3\x23\xd7\x67";
        address recovered_pk_1;
        recovered_pk_1 = epervier.recover(message, sig);
        assertEq(pk_1, recovered_pk_1);
    }

    function testVector2() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_2 = address(1241080179793602647909185613605026912518406732206);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(135), 120,104,12103,12275,12172,12162,81,12285,12205,12229,12213,12120,197,194,12231,174,58,223,6,12237,21,12215,14,25,12169,12022,263,319,12089,143,12079,12230,12119,165,12231,39,139,91,47,12216,12095,12162,77,12261,11994,12196,12204,12157,91,32,287,66,40,135,12110,136,129,12227,85,199,12178,11856,168,48,12185,77,12035,145,41,25,14,419,12197,12237,12159,12269,12241,12223,53,186,12151,70,111,141,157,12139,12026,165,174,12031,12111,12188,236,11971,70,172,148,12105,12192,12162,12162,88,224,11889,12202,23,116,210,153,105,182,12114,12053,348,12080,12221,12200,223,54,11823,82,12,12104,12171,90,263,12082,12090,89,12179,12252,12242,24,131,226,128,12129,71,109,12250,12191,171,12249,144,11876,230,11997,12086,12253,12141,220,160,12187,12260,164,12235,227,38,102,61,66,12242,102,109,12220,12070,12050,12284,12202,240,12184,12273,197,12232,12231,12169,11829,12189,115,12156,12263,3,12077,131,12205,12090,11970,12222,54,11963,12192,54,12219,12139,52,12256,147,21,12022,83,11,11899,50,11977,82,103,12277,63,112,12200,12208,194,11791,249,256,88,48,11958,76,12114,12031,264,12233,12177,12224,125,12024,43,12142,12158,12152,204,199,12250,12171,12066,12128,11951,12079,11822,11757,95,134,12211,12219,60,12204,24,12023,12196,12188,12094,12175,57,62,12263,160,12213,12183,11724,26,267,12149,329,511,12201,241,12096,12091,96,88,87,44,12195,12223,12234,73,5,216,12046,12088,117,6,198,148,12050,74,12055,26,268,269,40,115,164,158,12021,120,36,12227,173,12130,12251,12238,253,12070,107,138,378,127,181,12149,12070,12174,167,12000,11941,12166,12189,277,12150,129,164,113,12275,24,190,102,278,12241,12288,203,12108,12219,27,12202,307,80,12285,209,128,180,12258,13,74,12202,11972,12260,12244,12091,80,120,12281,12226,12260,12277,177,12260,12094,129,12095,12032,12251,12,12186,110,12122,253,80,329,172,12075,459,69,12132,163,108,154,12224,119,12068,86,12157,12277,125,12188,48,12181,12261,81,12113,12009,431,208,1,12226,11974,34,12113,12197,153,244,11855,36,12221,12140,12227,12180,12098,81,263,12130,12267,12059,12158,140,12148,12105,12224,63,12266,12272,206,2,11850,195,12083,12072,12161,12088,20,284,336,12093,168,12107,2,12046,120,12210,12252,12254,12239,200,12140,11902,12257,50,208,95,164,29,11974,12277,223,12202,12251,12180,12256,12154,8,12282,12245,114,12133,202,11960,203,11904,12044,277,232,12280,12160,152,12209,480,12239,116,49,12222,12100,112,24,12222,145,12089,12203,12097,89,12248,11989,1,376,12234,12063,12168,145,12045,34,12027,104,19,237,106,295,36,59,12008,64,220,12231];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(12188), 12192,11965,138,12168,12028,4,12130,231,12199,12168,12078,12119,258,17,335,12226,12273,12164,12138,12192,12109,105,132,12072,4,5,12206,11947,12262,12030,120,12274,373,12219,12273,12176,12219,173,12140,155,12273,12177,64,12238,12255,24,12113,12228,12113,142,101,12206,11965,11959,12182,127,12242,178,313,74,136,15,398,11721,266,44,5,12173,201,101,12112,29,237,12235,12238,11895,11992,12092,12271,59,185,50,12219,12131,306,12141,12093,12242,11902,12177,27,94,12064,12102,12131,12141,167,12283,12096,12223,155,53,228,49,120,395,325,12270,232,91,12,75,11988,391,67,18,81,12166,12096,23,12233,91,12231,414,114,140,12247,165,79,12284,13,12187,12280,192,112,347,119,30,87,171,12178,11815,91,12037,12212,12226,12085,12197,12185,12234,78,39,59,76,31,12186,133,8,305,12062,125,12213,41,12274,128,12170,215,212,275,97,193,102,213,42,216,37,12114,95,193,227,12202,212,111,12093,48,172,12262,12268,12053,12208,56,12139,122,12184,12187,14,12086,32,12224,12153,12214,12021,12264,12282,77,178,12215,16,12256,23,284,19,16,12254,107,62,12265,12278,35,12001,12281,12102,116,257,337,12235,12219,11,132,11961,247,81,10,100,45,12232,12261,30,360,12040,12074,12263,29,12271,69,232,11953,125,73,47,12158,210,67,12134,38,12284,12124,36,12268,464,12281,281,12143,12117,113,12164,247,274,280,12170,12254,12269,12282,12025,12272,12275,12213,12202,29,12269,12196,69,11903,194,188,266,141,12075,389,12101,12133,12095,165,134,399,61,12220,12205,224,49,12103,305,12282,53,12003,12007,239,103,41,11998,12267,12175,135,171,164,53,211,180,1,12277,113,11995,318,12205,12172,12174,90,194,12177,175,11927,170,12149,12150,12165,12197,11963,84,45,127,12135,362,12136,153,12115,12267,34,169,12248,94,29,140,105,12157,86,307,181,12197,12102,133,158,12101,176,12238,12118,12160,12079,149,12048,114,12275,12186,132,57,12215,12161,316,11999,123,99,12166,243,12202,12170,12131,92,208,12246,12255,3,12259,106,132,60,12150,85,15,96,12184,12115,296,12262,12155,12003,12208,12238,12285,105,12258,86,147,12216,12239,46,12099,6,12252,11989,8,12211,58,12,16,12199,382,129,120,12235,12209,12283,12161,12169,11930,12188,12120,55,256,128,12264,12124,29,12078,116,12175,117,12238,12200,12283,10,12162,116,329,162,239,12055,116,12210,12287,12155,0,58,12226,12233,12222,11994,284,12066,247,12222,12150,12128,158,145,12224,114,12238,12272,116,24,117,12229,28,12178,12187,366,12043,98,12096,22,125,12083,77,12077,12075,133,259,37,24,12041,12168,12164,235,12207,191,12250,208,12221,12279,13,47,12205];

        ZKNOX_falcon_epervier_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(6880), 4886,11450,8048,9101,7447,3917,11404,11558,4295,2968,4220,5865,1728,2677,32,10267,4846,11839,1135,262,249,8306,2612,9575,2271,1010,2883,7068,6439,2340,6836,4367,495,8904,5184,1614,4907,1940,6106,6084,3878,4289,4030,6073,2711,9329,1985,4746,1396,8137,9435,2907,9444,9096,1331,9483,11558,472,358,8377,6004,7345,5754,1916,6053,4690,11893,8328,11998,7862,7463,9303,3196,11222,2382,4547,6264,6105,3308,11410,10557,11347,8765,6134,5280,6263,5555,8581,12123,2065,4356,9388,6335,4885,9800,481,7401,8909,8779,7846,6017,11593,9152,8711,8832,383,10796,4708,10691,11158,4089,5717,8588,8969,1470,5274,10388,9332,2076,6820,3157,3890,6695,6341,1887,7384,7964,7636,8968,8839,4343,11028,693,10263,1750,11628,7410,9320,9702,7793,4351,3357,2381,1626,11597,11622,2206,9226,6726,8470,1430,9006,4664,5663,9348,11730,1466,11696,7676,6970,3252,9679,5245,3965,3109,2706,10662,10485,4621,6945,8961,5132,6957,9756,10817,5972,4063,7657,3817,8696,2078,1476,6899,7389,5644,1965,6844,10356,3634,10825,1052,1782,918,4430,9133,4791,7433,2850,12167,8927,4025,2841,3467,7335,761,11776,6346,8450,8373,9418,1802,89,306,5707,6313,9948,2009,2950,6461,10964,10823,7168,2170,10226,8240,4273,6512,8177,1836,7440,2097,5569,9821,2106,4538,744,11851,1799,1117,4970,6126,4929,6458,1428,12196,10746,9648,12024,6877,12239,5242,12247,3124,6132,7841,1165,8901,4850,8076,2642,6803,10101,11487,11214,6260,3303,11629,9630,3533,6257,5589,4196,783,7698,12099,1644,3683,1186,7639,3846,11482,8326,3876,11418,7605,3880,4172,6110,566,2126,7174,1398,11898,10453,136,8440,8707,11888,2354,11549,6332,12074,4772,3819,5607,1530,732,4913,11976,6482,4411,8115,6465,4736,3603,4323,10388,4665,12200,9533,8508,1464,3274,3449,6933,2511,8199,3185,10541,11458,11326,5967,10079,9002,8916,10399,8397,8635,5664,7136,10818,3081,3719,5109,2371,5349,12160,4606,1223,2862,6114,11758,6376,5016,331,5322,3619,8839,2298,9107,4847,7079,7997,7226,11501,11957,7674,5966,4690,593,4976,733,3613,8288,4347,3105,11025,10150,2933,8585,9548,11871,6044,9316,5355,11330,11516,4121,3943,10304,1171,11388,6654,2222,3156,8704,2678,6277,4789,2778,3272,3877,2059,6701,11911,941,2935,4422,4029,2924,2794,9710,11506,1992,391,6959,7557,8812,6804,4651,8399,527,701,4954,7359,1515,2291,6229,9312,1941,860,10907,75,5257,11501,3434,3161,7831,3146,3784,1347,1688,7965,7920,4834,8183,1160,9344,7631,9344,7873,11892,633,9011,5232,4586,6030,3732,2066,3017,9464,291,986,7552,9284,8253,3185,2220,10867,4847,3607,302,1064,2706,8413,8799,1649,2930,9409,9923,6463,2474,5347,11030,5109,594,8135,10905,4741,7557,579,1262,12154,5710,7010,9452,7933,1521,4193,2060,7814,4013,5809,8384,6104,3701,8381,8607,4884,1414,3650];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.hint[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "My name is Nicolas";
        sig.salt =
            "\x6a\xf1\xf6\x92\xe9\x49\x6c\x6d\x0b\x66\x83\x16\xec\xcb\x93\x27\x6a\xe6\xb6\x77\x4f\xa7\x28\xaa\xc3\x1f\xf4\x0a\x38\x31\x87\x60\xba\x53\x0a\xf5\xf0\x89\x98\x14";
        address recovered_pk_2;
        recovered_pk_2 = epervier.recover(message, sig);
        assertEq(pk_2, recovered_pk_2);
    }

    function testVector3() public view {
        // public key
        // forgefmt: disable-next-line
        address pk_3 = address(1241080179793602647909185613605026912518406732206);

        // signature s1
        // forgefmt: disable-next-line
        uint[512] memory tmp_s1 = [uint(239), 95,12255,12256,113,12078,12282,12284,12113,194,57,195,27,12286,233,12231,132,130,11939,12240,12253,116,12273,11936,22,12274,129,12258,76,11999,12169,12081,156,31,12092,126,64,12111,12101,82,42,11856,249,12205,247,12217,9,12114,12094,52,35,66,12028,249,12271,56,11893,36,11993,12154,11761,170,266,38,12194,12075,20,12181,12006,173,12115,12147,12269,160,12184,212,110,92,12276,12106,41,195,11897,12244,307,12114,12177,12231,12240,53,213,105,12171,9,228,12195,12216,12054,60,12218,104,3,12225,12196,222,12276,12243,252,120,66,11960,368,12042,45,12226,201,12034,11999,69,12179,38,22,454,139,12077,12140,175,12158,21,12260,12043,53,97,12278,223,118,12087,12206,12279,21,12022,12188,12247,47,11926,55,12164,153,12259,12053,12,272,53,12240,82,190,12120,12150,73,200,12060,12245,154,12155,11955,12018,12069,12274,12223,38,49,137,211,324,12173,118,12283,277,12117,132,32,12105,94,130,5,238,199,12100,128,12235,12102,12201,12282,11999,52,35,12195,12176,158,12010,41,12169,11982,87,12149,12126,290,149,12003,12246,12249,11907,67,12046,12265,12286,255,3,9,12165,12128,12218,12214,12142,92,12253,12107,37,12166,12192,165,11929,12235,44,12119,386,49,231,11883,12201,12219,12270,12065,12139,27,12150,174,148,32,225,371,12068,29,24,180,12210,56,99,21,135,76,12165,12266,12202,102,12107,49,12226,12253,12259,12215,122,351,177,12224,12103,12222,89,12051,12054,8,101,11903,34,12254,12179,12261,12253,241,12229,12187,12171,77,30,2,157,167,296,12262,12251,12178,190,12139,22,12090,12081,12049,148,12120,12183,253,170,12266,153,12249,11765,12143,227,148,12228,12181,83,12113,379,12278,25,12257,12157,12113,12211,100,99,12009,332,11944,12019,12190,12179,87,137,12171,11978,239,346,12256,123,42,69,35,13,28,45,12199,12068,122,12227,214,12285,12134,11991,12218,55,55,25,12128,12098,194,76,14,12258,12070,12078,12088,114,12280,192,6,12122,165,16,69,12162,11985,44,67,12152,55,283,102,12221,12118,7,12211,68,12102,12260,52,12120,12033,115,132,12250,12287,12127,243,56,149,12044,15,93,79,206,12158,12143,12013,12239,12097,12091,12066,12208,12214,18,12251,12011,246,11990,12271,12263,141,90,68,107,12170,12172,183,11999,1,12119,140,12171,85,88,315,12150,53,57,461,12098,12215,35,62,43,51,12225,49,109,12266,12014,405,156,320,178,22,60,12195,12177,12158,12191,12200,367,254,12087,12281,12248,11970,171,12251,64,12217,159,130,12184,134,12080,334,12150,133,232,39,193,12252,201,310,12187,7,117,150,12287,122,12272,60,10,231,19,12251,12106,485,12164,12021,291,29,7];

        // signature s2
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2 = [uint(660), 29,49,104,60,185,183,122,12149,70,89,11915,193,102,140,192,227,12172,12194,12233,225,12104,100,55,1,39,196,12283,259,147,12162,12256,12250,12175,165,12206,59,67,62,12239,12271,284,12252,11946,12162,97,319,12233,12091,12271,12073,11929,12187,80,195,12120,12245,12179,1,131,12178,12102,12168,87,132,162,12,111,12253,12171,320,113,166,97,63,12157,101,70,12051,12075,42,12175,12195,12110,224,12033,254,12250,12240,11999,336,58,90,12180,258,12212,288,151,12242,12285,30,12026,11,48,161,52,12221,12053,12156,126,350,13,149,58,12024,12285,47,12007,12211,12234,65,12214,11863,12203,11981,6,219,354,261,114,12194,12151,49,12123,12188,77,113,292,12202,187,148,11949,187,24,112,12180,155,12213,31,44,12252,12019,12239,12286,80,12248,202,12189,85,12281,12228,265,12168,12277,183,131,440,11943,197,12188,63,71,12235,247,12195,12255,12251,12127,12014,12261,12220,78,213,26,138,12017,254,12258,12260,197,2,12228,70,245,12218,12213,249,208,12235,11988,216,11961,11954,45,12052,58,13,12214,12210,273,8,79,65,44,12023,12288,278,121,12067,12134,17,12070,12225,69,143,35,12105,198,11933,12135,12281,10,209,74,239,12235,248,122,12113,40,12203,12065,12073,242,251,3,161,12270,12083,15,37,253,133,12129,181,12020,54,178,188,86,12199,232,12079,12186,12281,98,12213,256,12228,12191,12256,33,35,12047,12256,122,56,12234,121,12121,143,158,12287,12209,12153,98,12098,143,12239,316,165,12212,178,60,24,107,12117,207,165,12217,12194,99,12172,16,38,12164,100,105,12228,12120,162,77,12137,62,256,12266,10,20,11996,11907,12073,213,183,111,103,12212,12232,12141,284,226,9,335,12154,301,254,12039,12146,54,12266,123,12175,142,12278,12154,84,12210,12250,31,102,12079,408,12246,155,12060,12026,48,93,12144,205,12207,320,12168,12267,134,12136,34,1,249,32,31,12243,12177,12121,39,21,12203,12284,133,102,103,12223,12249,12258,11956,12010,19,65,12082,12149,12189,27,83,12102,62,97,264,12273,92,11967,29,12287,12155,6,33,327,5,11,55,12130,12240,128,254,4,12243,108,12282,12102,12085,220,242,73,12195,12165,12131,93,165,12070,107,12212,34,12184,156,12250,11988,38,12190,12199,11899,12159,12245,12262,12125,26,12222,313,43,93,143,64,319,12200,207,12049,150,12153,26,12230,12213,282,12235,582,219,12138,12158,12283,12047,12053,12167,79,41,250,97,189,76,75,141,202,12224,107,26,12244,59,12202,12241,68,81,12211,43,8,12288,18,12158,12122,340,270,9,12159,365,44,351,189,32,132,12175,12025,233,12205,12197,12214,12098,12265,11999];

        ZKNOX_falcon_epervier_tetration.Signature memory sig;
        // signature s2 inverse ntt
        // forgefmt: disable-next-line
        uint[512] memory tmp_s2_inv_ntt = [uint(4334), 11186,4026,9789,7469,3952,11998,1726,8707,7653,7914,3855,8753,4763,4416,5048,6195,934,9790,4932,6487,7160,5215,5439,2760,1082,6669,502,4141,6313,7042,4487,7268,10881,8492,2960,10356,14,8779,10224,2940,9814,5259,5274,10236,9444,11127,7133,8551,9886,7996,10861,3971,9393,9471,8463,9567,7410,11279,1465,2521,11445,6387,745,1644,6743,8959,5182,11581,11691,9266,12156,721,6817,6431,6180,9201,10708,1086,4769,11220,3995,7771,10964,4600,1154,6904,9326,7693,3704,3933,8909,6670,7093,3776,1969,3102,10131,346,12102,8195,4046,1526,8965,4564,4287,3198,11295,6074,11494,7899,9748,3944,2290,11646,2682,427,4045,3359,5180,4880,4962,9818,6571,78,5855,4095,4868,4060,9596,6721,4776,3264,5874,3359,5872,1623,4087,7772,8543,11014,4973,4760,12143,6316,2142,7986,7307,1890,11342,333,12173,11898,11567,225,7840,10545,6534,1696,9406,8864,4590,8487,5724,8018,2485,166,3215,8155,6796,10010,4891,4650,5213,11457,7050,11534,4943,3989,2725,7433,2060,10778,5073,8123,8797,5606,10589,1411,820,612,2500,9395,2291,5259,81,10934,7547,6205,1323,4970,4761,9898,11970,10805,2483,1162,685,4871,5388,8517,2313,7969,4371,2680,4950,8824,2027,3312,4256,5873,2805,12037,3,6660,10497,2,12214,6484,11442,402,329,1359,11186,1629,10409,7260,6956,1275,5723,3399,646,260,2791,8498,8634,11404,4257,3664,10162,1479,1991,5633,3555,1701,5650,7514,10889,12203,5876,6423,7319,2748,6370,3748,508,10858,168,527,6468,6550,410,7523,8140,8831,2012,5025,491,8707,3288,7252,8540,10348,1842,3816,3571,10560,8390,10828,885,9756,9473,11032,11922,3023,8403,10786,1558,9603,9349,4856,908,1,4205,10364,3463,9343,5011,9723,4150,10913,2216,8011,229,10571,10180,4202,5146,11912,5629,11193,10041,5096,7895,10518,2201,10999,1438,5063,11634,10277,1523,7846,9521,5659,2932,10910,5493,2445,10408,5017,7442,3366,10933,3687,5875,2139,573,6982,322,9764,3004,11846,10978,3985,1191,7381,11259,8651,3970,10718,6330,4134,7865,7442,8334,8835,2968,7192,5407,10821,3252,9598,3517,4990,10170,1036,8021,6779,7139,9884,6719,1869,1125,2104,5257,9471,3395,43,2214,2818,9671,6866,8844,1891,3447,5345,6286,3563,11321,5156,12168,8356,4881,862,11417,81,8819,8141,9816,4838,10253,2786,703,8309,7775,213,10915,7206,9365,4818,6678,3719,4717,12258,9888,5375,7831,1481,11433,7590,2662,4866,7780,10558,9837,7809,8671,12002,980,3400,8632,3163,9899,6029,6736,8221,8266,5395,5241,10561,1786,10783,2073,574,11586,6633,514,9126,9556,3443,4691,1790,9390,4151,5984,1036,1284,3562,5948,4776,11123,8446,4370,11949,1060,5758,454,4064,399,5300,5489,778,755,9182,4209,6955,7446,8796,477,884,8763,3975,3990,9636,12085,4343,3400,1217,10329,201,3956,2180,9959,6846,4022,3480,11696,7926,4926,5637,8593];
        for (uint256 i = 0; i < 512; i++) {
            sig.s1[i] = tmp_s1[i];
            sig.s2[i] = tmp_s2[i];
            sig.hint[i] = tmp_s2_inv_ntt[i];
        }
        // message
        bytes memory message = "We are ZKNox";
        sig.salt =
            "\x96\x44\x29\x4a\xc4\xff\xb3\x09\x1e\xef\x01\x21\x9b\x3f\xe4\xfe\x46\x7f\x05\x89\x0c\xc5\x6a\xf9\x61\xdc\xe6\x8f\xdd\xbb\x77\x04\x71\x91\x37\x3e\xdc\x7d\xa9\x43";
        address recovered_pk_3;
        recovered_pk_3 = epervier.recover(message, sig);
        assertEq(pk_3, recovered_pk_3);
    }
}
