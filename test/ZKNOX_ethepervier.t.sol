// code generated using pythonref/generate_epervier_test_vectors.py.
pragma solidity ^0.8.25;

import {Test, console} from "forge-std/Test.sol";
import "../src/ZKNOX_ethepervier.sol";
import "../src/ZKNOX_falcon_utils.sol";

contract ZKNOX_epervierTest is Test {
    ZKNOX_ethepervier epervier = new ZKNOX_ethepervier();

    // forgefmt: disable-next-line
    uint256[512] psi_rev = [uint256(1), 10810, 7143, 4043, 10984, 722, 5736, 8155, 3542, 8785, 9744, 3621, 10643, 1212, 3195, 5860, 7468, 2639, 9664, 11340, 11726, 9314, 9283, 9545, 5728, 7698, 5023, 5828, 8961, 6512, 7311, 1351, 2319, 11119, 11334, 11499, 9088, 3014, 5086, 10963, 4846, 9542, 9154, 3712, 4805, 8736, 11227, 9995, 3091, 12208, 7969, 11289, 9326, 7393, 9238, 2366, 11112, 8034, 10654, 9521, 12149, 10436, 7678, 11563, 1260, 4388, 4632, 6534, 2426, 334, 1428, 1696, 2013, 9000, 729, 3241, 2881, 3284, 7197, 10200, 8595, 7110, 10530, 8582, 3382, 11934, 9741, 8058, 3637, 3459, 145, 6747, 9558, 8357, 7399, 6378, 9447, 480, 1022, 9, 9821, 339, 5791, 544, 10616, 4278, 6958, 7300, 8112, 8705, 1381, 9764, 11336, 8541, 827, 5767, 2476, 118, 2197, 7222, 3949, 8993, 4452, 2396, 7935, 130, 2837, 6915, 2401, 442, 7188, 11222, 390, 773, 8456, 3778, 354, 4861, 9377, 5698, 5012, 9808, 2859, 11244, 1017, 7404, 1632, 7205, 27, 9223, 8526, 10849, 1537, 242, 4714, 8146, 9611, 3704, 5019, 11744, 1002, 5011, 5088, 8005, 7313, 10682, 8509, 11414, 9852, 3646, 6022, 2987, 9723, 10102, 6250, 9867, 11224, 2143, 11885, 7644, 1168, 5277, 11082, 3248, 493, 8193, 6845, 2381, 7952, 11854, 1378, 1912, 2166, 3915, 12176, 7370, 12129, 3149, 12286, 4437, 3636, 4938, 5291, 2704, 10863, 7635, 1663, 10512, 3364, 1689, 4057, 9018, 9442, 7875, 2174, 4372, 7247, 9984, 4053, 2645, 5195, 9509, 7394, 1484, 9042, 9603, 8311, 9320, 9919, 2865, 5332, 3510, 1630, 10163, 5407, 3186, 11136, 9405, 10040, 8241, 9890, 8889, 7098, 9153, 9289, 671, 3016, 243, 6730, 420, 10111, 1544, 3985, 4905, 3531, 476, 49, 1263, 5915, 1483, 9789, 10800, 10706, 6347, 1512, 350, 10474, 5383, 5369, 10232, 9087, 4493, 9551, 6421, 6554, 2655, 9280, 1693, 174, 723, 10314, 8532, 347, 2925, 8974, 11863, 1858, 4754, 3030, 4115, 2361, 10446, 2908, 218, 3434, 8760, 3963, 576, 6142, 9842, 1954, 10238, 9407, 10484, 3991, 8320, 9522, 156, 2281, 5876, 10258, 5333, 3772, 418, 5908, 11836, 5429, 7515, 7552, 1293, 295, 6099, 5766, 652, 8273, 4077, 8527, 9370, 325, 10885, 11143, 11341, 5990, 1159, 8561, 8240, 3329, 4298, 12121, 2692, 5961, 7183, 10327, 1594, 6167, 9734, 7105, 11089, 1360, 3956, 6170, 5297, 8210, 11231, 922, 441, 1958, 4322, 1112, 2078, 4046, 709, 9139, 1319, 4240, 8719, 6224, 11454, 2459, 683, 3656, 12225, 10723, 5782, 9341, 9786, 9166, 10542, 9235, 6803, 7856, 6370, 3834, 7032, 7048, 9369, 8120, 9162, 6821, 1010, 8807, 787, 5057, 4698, 4780, 8844, 12097, 1321, 4912, 10240, 677, 6415, 6234, 8953, 1323, 9523, 12237, 3174, 1579, 11858, 9784, 5906, 3957, 9450, 151, 10162, 12231, 12048, 3532, 11286, 1956, 7280, 11404, 6281, 3477, 6608, 142, 11184, 9445, 3438, 11314, 4212, 9260, 6695, 4782, 5886, 8076, 504, 2302, 11684, 11868, 8209, 3602, 6068, 8689, 3263, 6077, 7665, 7822, 7500, 6752, 4749, 4449, 6833, 12142, 8500, 6118, 8471, 1190, 9606, 3860, 5445, 7753, 11239, 5079, 9027, 2169, 11767, 7965, 4916, 8214, 5315, 11011, 9945, 1973, 6715, 8775, 11248, 5925, 11271, 654, 3565, 1702, 1987, 6760, 5206, 3199, 12233, 6136, 6427, 6874, 8646, 4948, 6152, 400, 10561, 5339, 5446, 3710, 6093, 468, 8301, 316, 11907, 10256, 8291, 3879, 1922, 10930, 6854, 973, 11035];

    // forgefmt: disable-next-line
    uint256[512] psi_inv_rev = [uint256(1), 1479, 8246, 5146, 4134, 6553, 11567, 1305, 6429, 9094, 11077, 1646, 8668, 2545, 3504, 8747, 10938, 4978, 5777, 3328, 6461, 7266, 4591, 6561, 2744, 3006, 2975, 563, 949, 2625, 9650, 4821, 726, 4611, 1853, 140, 2768, 1635, 4255, 1177, 9923, 3051, 4896, 2963, 1000, 4320, 81, 9198, 2294, 1062, 3553, 7484, 8577, 3135, 2747, 7443, 1326, 7203, 9275, 3201, 790, 955, 1170, 9970, 5374, 9452, 12159, 4354, 9893, 7837, 3296, 8340, 5067, 10092, 12171, 9813, 6522, 11462, 3748, 953, 2525, 10908, 3584, 4177, 4989, 5331, 8011, 1673, 11745, 6498, 11950, 2468, 12280, 11267, 11809, 2842, 5911, 4890, 3932, 2731, 5542, 12144, 8830, 8652, 4231, 2548, 355, 8907, 3707, 1759, 5179, 3694, 2089, 5092, 9005, 9408, 9048, 11560, 3289, 10276, 10593, 10861, 11955, 9863, 5755, 7657, 7901, 11029, 11813, 8758, 7384, 8304, 10745, 2178, 11869, 5559, 12046, 9273, 11618, 3000, 3136, 5191, 3400, 2399, 4048, 2249, 2884, 1153, 9103, 6882, 2126, 10659, 8779, 6957, 9424, 2370, 2969, 3978, 2686, 3247, 10805, 4895, 2780, 7094, 9644, 8236, 2305, 5042, 7917, 10115, 4414, 2847, 3271, 8232, 10600, 8925, 1777, 10626, 4654, 1426, 9585, 6998, 7351, 8653, 7852, 3, 9140, 160, 4919, 113, 8374, 10123, 10377, 10911, 435, 4337, 9908, 5444, 4096, 11796, 9041, 1207, 7012, 11121, 4645, 404, 10146, 1065, 2422, 6039, 2187, 2566, 9302, 6267, 8643, 2437, 875, 3780, 1607, 4976, 4284, 7201, 7278, 11287, 545, 7270, 8585, 2678, 4143, 7575, 12047, 10752, 1440, 3763, 3066, 12262, 5084, 10657, 4885, 11272, 1045, 9430, 2481, 7277, 6591, 2912, 7428, 11935, 8511, 3833, 11516, 11899, 1067, 5101, 11847, 9888, 1254, 11316, 5435, 1359, 10367, 8410, 3998, 2033, 382, 11973, 3988, 11821, 6196, 8579, 6843, 6950, 1728, 11889, 6137, 7341, 3643, 5415, 5862, 6153, 56, 9090, 7083, 5529, 10302, 10587, 8724, 11635, 1018, 6364, 1041, 3514, 5574, 10316, 2344, 1278, 6974, 4075, 7373, 4324, 522, 10120, 3262, 7210, 1050, 4536, 6844, 8429, 2683, 11099, 3818, 6171, 3789, 147, 5456, 7840, 7540, 5537, 4789, 4467, 4624, 6212, 9026, 3600, 6221, 8687, 4080, 421, 605, 9987, 11785, 4213, 6403, 7507, 5594, 3029, 8077, 975, 8851, 2844, 1105, 12147, 5681, 8812, 6008, 885, 5009, 10333, 1003, 8757, 241, 58, 2127, 12138, 2839, 8332, 6383, 2505, 431, 10710, 9115, 52, 2766, 10966, 3336, 6055, 5874, 11612, 2049, 7377, 10968, 192, 3445, 7509, 7591, 7232, 11502, 3482, 11279, 5468, 3127, 4169, 2920, 5241, 5257, 8455, 5919, 4433, 5486, 3054, 1747, 3123, 2503, 2948, 6507, 1566, 64, 8633, 11606, 9830, 835, 6065, 3570, 8049, 10970, 3150, 11580, 8243, 10211, 11177, 7967, 10331, 11848, 11367, 1058, 4079, 6992, 6119, 8333, 10929, 1200, 5184, 2555, 6122, 10695, 1962, 5106, 6328, 9597, 168, 7991, 8960, 4049, 3728, 11130, 6299, 948, 1146, 1404, 11964, 2919, 3762, 8212, 4016, 11637, 6523, 6190, 11994, 10996, 4737, 4774, 6860, 453, 6381, 11871, 8517, 6956, 2031, 6413, 10008, 12133, 2767, 3969, 8298, 1805, 2882, 2051, 10335, 2447, 6147, 11713, 8326, 3529, 8855, 12071, 9381, 1843, 9928, 8174, 9259, 7535, 10431, 426, 3315, 9364, 11942, 3757, 1975, 11566, 12115, 10596, 3009, 9634, 5735, 5868, 2738, 7796, 3202, 2057, 6920, 6906, 1815, 11939, 10777, 5942, 1583, 1489, 2500, 10806, 6374, 11026, 12240];

    function testVector0() public view {
        // public key
        // forgefmt: disable-next-line
address pk = address(728199263750570446964354330903202655824594974439);

        // signature s1
        // forgefmt: disable-next-line
uint256[32] memory tmp_s1 = [127214665213589097161835274703357204562987795624039620550251278841594577059, 21159760717400281634852593057593485809071942971868994123744587935195754475332, 189383245899603158375809826367339927749837394292143291744422834584208682948, 21682747426563929267934057665394942211915145662596763200081090427159784271698, 21569675167645855832412093709743976790114326257518123198077994090411772412003, 180547716391800651022500299749613196982610219827087119674342150302064705840, 21697211486961872373358308952260967032135910855798862834650666694341534351852, 318362434553915395932315946694135742995838706477839664372531189198894411689, 394009348868192951615313671453490620308202296384602068843163152076802162885, 21610307527763657474579033160535761496088084045155786439665876926410317889618, 21619469218540454282593992979478620342090792577163628133508843773230071492314, 274187784953106640656286720905831775894032392013455400239831593255534723275, 203192049593739455123361931703060642950985388609865029827845241670227132789, 369272114969048241782424085407951524944258075394850078280984375966546407352, 21286974681594710810380239615221182427313380586492866019056688182089515020265, 21622679797721959875878107889378257143350554145766163293841509194131352924048, 127540233489563162770721969082820216312196622632599185141951537935395532561, 40640987313488343067132416451155019343194747750088334181139129759319851294, 148736704814963776929832768254778034998479006103505290760762777432652251227, 21568230707728709780104293759196958196447302173657478564489147369041103237028, 369600626809215313001214256563230605438148089472539722485725145132839415721, 79509223393450964750316832974784657227369592457786586946655140290602270758, 21195098440525252903355950731797024541328580061268899976086553708230419087636, 21253734518217209915730096964106833996754210625736070731303545589249329594385, 21645969606056682016014055570623518491010433520067812832282758386001522983117, 65381973537639725416383790152711348493509228084350381743323363074586968369, 21410654084013001974198814286820518184228306987212451148401398668655927885939, 201749939930855484125675043722049083765921599537596897353164045228231950356, 237084423025265759556348607433082282240394595400221762755889372920090865469, 145207841415351346144491575439351579938560441856595595454153849256922579008, 21395075947959285830246154403995015195591110341643615104408444911169818079125, 265032321921930865602047145312858918064071077800948613010348248772821254185];
        uint256[] memory cs1 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs1[i] = tmp_s1[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint256[32] memory tmp_s2 = [171713993326567253175735293446338435981493104966753997475473012450851368907, 21498996701926392219947085913669085296444180762927386610038095578288852107269, 452320855744196729263525382518648486101322119190782780004867998719352516502, 301610290073250114293558878833852160271555999703804794315220826784040, 21230437296011178897909094451396232506707694340005553747434364188325741539158, 113079641101639197312573870512454616690956622132413294170436606950500859993, 47705760438364264247831513345052003740603614300362326524637225085611487185, 21308177299717532146421932376243605433109172594072619233454442056084387528742, 21225462840353137318681158243153822002874523881659095747994777536124848963755, 56869284641350843956318120591835603320070954002021844040806879345489412451, 21600032768551756525717875771323281451008180779728001738465605849956021764098, 412002907472536653146653042179248206525093580814393915871751896796573609575, 162872263103356275677536393004004277077635753309055008061105861398154784617, 21571437032129491652615151942368309604066349406184110111399961220786151817439, 21711017487037039044426559292681573420864923961564567874932702928236539424739, 83366253048476995128888869219101971286361546157553550614273001086409584614, 21440694447247297679236873169747049084201317154134571922909870197279931564197, 21511693331965140538235096628936940874146144558128912970649527822622964514945, 259732886119142926121455742849322651542601696485034317796168847645296766822, 21642435081082330079651400829534483046221927125788251360706033919556091916240, 286230981838740379334973157250450897464863814923344128430119820165311496362, 290093555439276985977653448271580047616530031527161840144684355350551527590, 21684515163374002587819002216032060340928337616005165306699647558703425990587, 21249869680067953746801460782669147832805872704743189648058556680797325164641, 199981825896679593278755977572624847497063230090653413441505729053037375227, 203190005565667215998968389129208593620015712070760211618048962670963654748, 310971176450629075739182294296362528058135922433043711776810510569258626942, 21617374139137209449886180689670238479388919477407499396910815617076401483476, 346303561468237481218603219160810409761283516529772376289409239516912168935, 689400646614484187528313142788634824925237973753004202841513297306514435885, 21324082212406290182610070101453472806829671703313864561543447926298940157940, 21265774614747158490428496955547248558480155779892385808399539624318376476686];
        uint256[] memory cs2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs2[i] = tmp_s2[i];
        }
        // hint
        uint256 hint = 1387;
        // message
        bytes memory message = "My name is Renaud from ZKNOX!!!!";
        bytes memory salt =
            "\x46\xb9\xdd\x2b\x0b\xa8\x8d\x13\x23\x3b\x3f\xeb\x74\x3e\xeb\x24\x3f\xcd\x52\xea\x62\xb8\x1b\x82\xb5\x0c\x27\x64\x6e\xd5\x76\x2f\xd7\x5d\xc4\xdd\xd8\xc0\xf2\x00";
        address recovered_pk;
        recovered_pk = epervier.recover(message, salt, cs1, cs2, hint);
        assertEq(pk, recovered_pk);
    }

    function testVector1() public view {
        // public key
        // forgefmt: disable-next-line
address pk = address(728199263750570446964354330903202655824594974439);

        // signature s1
        // forgefmt: disable-next-line
uint256[32] memory tmp_s1 = [21527594411377244756639221511077728532340255124568806750436983122636425199653, 24737233914030977028276362203334744377882962840864178083075726196160987151, 219418864035343515008630684501400452782085887404019061607015884693498965988, 21377088406243630011256659446002941529875747795591087261030234661926362415303, 77747099195304350334889304408994222213354322438746529198454140310912630802, 54781942648185059434226115037659465061912548718435601346313486313023221718, 178453904110498823520791057871436694048362119811360457540382702538502320011, 459381778504980801097629159245971271456909390232106199376775176316330901528, 21340306384807265083589972330973296482878304032325653566257980900641503391658, 204956955597406059744512194272041161316823112081682472337540640553452318418, 21266099109652844901848344245612883683424676901925551017596629315768546176848, 21703952929454187697412253621201667190620425178136469804565206314559471616274, 438184326886618086763277921243829689902366667425228326205871921972885717036, 21127959330536823859192766967291884453686077262045427710088410258137446297579, 17669737832743684576481943825658924680589598553020514142206130569242738819, 21518436387172452515362633851223620125441969035707140471773460620130435936122, 21387689488579159119766978661351259095622884084167630894623103444625869582247, 21414195915046995064536474645590833236098708818993062359249789336570540469957, 210581555278764079651753509413667581804682203976861059817048888083416350825, 21585901469868293895611371175688741164822589102337292416313740983383113412555, 270652823748091680084626638475647329169178475569275435697875695979771199500, 74208385622424142868590469881189878664689890503017508319740727560977723292, 21488721133844025001404126272661177918458377276421696714436605515882858086470, 21412424193196695938006005808926578047985720398610056644131697435648535768965, 21700744539046816611731274949195316030504572282195683989360463088987234185182, 3539953759300310156590379356609578185791827483407340733577446638880161915, 185848149781240211970185494630495979532591922727143646247904874122804985856, 139906135986714004301512558170909196566385715627943237365821547766252109957, 495042072500484890189055089723279214479201237943807780042327399729956258001, 21506066246903825141249093774480679498803078455490064780566677896667999645575, 130752047992550942893049448713240668697401960979758751043307483426247541102, 21331149120431480484253578857880960291904174503833607389125201362836219768831];
        uint256[] memory cs1 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs1[i] = tmp_s1[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint256[32] memory tmp_s2 = [21292276754526296644248833603578664644992418116379054323074144394731582205749, 21603566386711994297489092577104263353416247967198113911544767696515391631341, 21398612769398638278105747176221612223321598939379342983605805026384507437274, 307758629165868013007061549612329858314437101060016273558980371538063929228, 1768874103429239374399123279943733541907117909383370977754158941160800354, 356906562985835525388885607631202158938552079934687665393466433914268626862, 21448084325412101909287127183067080534021438080273536051513484392084869742715, 21670385158763942246666791128775217729288193315901693607409144645322736402559, 243827402264233596509720725093921072305647288902062744637365385070103298182, 21513460901959720074564205290375129454183684762466124718910922640351018942700, 404935244702948439381081029707701624197173472215640427947960908992057192269, 21409215177670294662732925294135865123868631347811572887175620467694862282668, 14464173273311276851605022253396425872207318732817712814043877574380433091, 14465629041732033815674070141151947315092033836155899143092647776910192544, 167851091249997930987927526860443309528042792199272411044255823647855554520, 643137507986663766718740798882144225562475637325596469338716883572145532862, 21686607115432072248077385245104932173116559950853743487084748762276411420582, 21619463934448500387713062512818406906996958240743708505332343333918136086302, 773886729945518926389050078972508676259017757547064793543742610459638038665, 176688728563724335826608764758040515812749344547144038418958882292532523003, 21534332295135692948239394775460851300131437568856357541805170636133941444679, 21555539204868173829892523728429494495311407955037527170868626580404551155779, 90437168078014954643285395652578827116426846217642089191414419817285693299, 21269635953146895544339660338422668319761786722344264975513357685862453227467, 498252489936371137079971852035778218183441305973630485669821165597245255603, 21516993436941077197101195751875658270658750283908183300676015216972777259051, 21681306924696473567560517837726743301689914340747718091461022277659960487859, 146656744875367615910368206168950464340028102343926897704456474725262241474, 332171480973137684097356733339014788859002906076393708928366595825350279352, 312738918123990305070441163996643865746676690805773716964953502985510649927, 21446318125366710208769392672165308160062254001614014372698235674406630666150, 21449846373542946516106928441172781179569439395984627541222176027643561062248];
        uint256[] memory cs2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs2[i] = tmp_s2[i];
        }
        // hint
        uint256 hint = 9154;
        // message
        bytes memory message = "My name is Simon also from ZKNOX";
        bytes memory salt =
            "\x54\xda\xfc\x3b\xe8\x75\x67\xd6\x77\x23\x13\x95\xf6\x14\x72\x93\xb6\x8c\xea\xb7\xa9\xe0\xc5\x8d\x86\x4e\x8e\xfd\xe4\xe1\xb9\xa4\x6c\xbe\x85\x47\x13\x67\x2f\x5c";
        address recovered_pk;
        recovered_pk = epervier.recover(message, salt, cs1, cs2, hint);
        assertEq(pk, recovered_pk);
    }

    function testVector2() public view {
        // public key
        // forgefmt: disable-next-line
address pk = address(728199263750570446964354330903202655824594974439);

        // signature s1
        // forgefmt: disable-next-line
uint256[32] memory tmp_s1 = [21523731864803710125896524703534585438352661071976832732089946414141548265647, 288000708678007210325288568082192811447166927872506196704850082720638643923, 21640345739149840910327905128743285041418068646879347916142683884426680926426, 21571761333314788133325703709632732176342789534564570504223945520019781791686, 220858686970832754451451409643114084803422918531197290292019788608479506337, 21386243146285764958625546937428967371774711823577953809899288406816165003567, 56547167100254155265250830135283860751770121299964074416359356509199925450, 242385346659953864347395852301549576273242613470645679937420393616000167560, 21566458765167293979777392858995967292036561074830107374352851482706513702818, 21361184652800567413531135792825230854448020761282438179800173984182309761024, 21541401413810355140513904875133781175831700758451848166069063322146722676853, 194356929483615653093497684851151963205656823660347647275838766940425355273, 21304972279338050043990771797166515291629713249968142498629527469237272915815, 244153563670292620395323525732540440419119803225899518775665706985534128158, 406379057621838957633544892834887357814462992690336526973257855787269500828, 21635049857029781116521055157023634609892738522470182228736833512009929851129, 63937185143566237159299354408939374829412306755514397209806156811506298807, 305664784928943823526372640490349924621842165057212220074206230097086394354, 46267177673584577527902412791124211739316302957712860585299508556743508190, 21693677851670210321754616210542956238014479807190549232778076557827834839192, 21213095881409151651699697595544262987512066700690245193723162534168298336078, 21354115916553581943907544316802089331301031736086926386959190557846107270956, 21370015545075028651473203275614295226496138723848893426639864495634585616531, 21550236134428431413651941482016273350010357602609788209374045123195778302056, 49796612217881274006687976142658642766679121769105002982730420993925185691, 21352674885436249398297767732176235254821227468869356047286162634712900239700, 21619466231021281476826496118055264739860182553681322809845732361987930402743, 21624448100642779084187937340570812058407406150999842989472912777968550752218, 21509598544118153159519438416854425661112517931705660164362934089906367180718, 21592645478534427289110141313185174371240144597997740785416432443503835164658, 21574972397724656383072313270777589062013575428577407730629029627862093398051, 21389781742240934801232376297053470510619074919127957148286904623353190559472];
        uint256[] memory cs1 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs1[i] = tmp_s1[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint256[32] memory tmp_s2 = [21702506991560815803887780408817728782522613383619096739939269365248854601519, 190821801555181405916512142091816980332340204414807874523705811982816379274, 28597363984315820200873038489453140385943321982091929978974294069857419292, 268891768178864411353302594055745333753111464773959629345011244158955225223, 21623002184781481453583400571607053104559281141108081739833500439722896338863, 302454830787409960660863133424151221638520200951576814123949139693641608887, 413762987623611661258617473649081528974966435420490599017792486476640944271, 237085641135108104149402743323021276711962875968432370122723487790613933983, 69234356261880852478966246767989433985662807054383359036936478666579574926, 21615933534426542458990852920382017714777881526961087427944247563583450906721, 21424794144629764158487418497623087524585981839185921251564598748751996858204, 21288741011454293185356635897339493054227475168018902043453856289639069909149, 21587340834488881516474367563960215169978250672576733315587397567734168223812, 21221928736872234340094421876557500560422800702185621978417264070356753723328, 21398614553625812570653268742852668471169436307398677289294908529014550834962, 21545260913963396092237567479450187274163746606037478628746581297180220915881, 267121690766907166741946503567305198804008461761166371935960685123687165799, 21532895464839027661523481555736275432710140659957504233226700714520333320350, 21628302483520182105689484268553792525250640471246673944328161367443181404289, 21608542271282588053327042775432732238695806647522513466395728604913736298421, 141678245235534257680337258181543470350281329894463572058425128087351656451, 26831994842619430667950214950069034076201791839797610759022980587205886175, 21569671479131046814842980075941224467904668575797226663758903246452122267425, 21479560790996683879038995605461896403984545517494147305745110998303417892952, 379878890868073321074349273963708057428072836489929082912963395915665256427, 2096572265863721448613454725003690938681766286205436448987449885778259830, 494718504223817642302718849445544263265689912993915843932491174613141893057, 21552002280572856304755863715924224869084860520870892885352073031214996991982, 97177159695230016101966798290501554427114621326607159476436205503900561314, 31805651653787087031825717906072502519853647161004344922350864961445494823, 21391219224610069673079798438150796080589238114560478297749292904767477186625, 203513358304275065861381374764384933013832662610654732290138008071834632532];
        uint256[] memory cs2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs2[i] = tmp_s2[i];
        }
        // hint
        uint256 hint = 1945;
        // message
        bytes memory message = "My name is Nicolas from ZKNOXtoo";
        bytes memory salt =
            "\x36\x06\x33\xe5\xdb\x4b\x60\x26\x01\xc1\x4c\xea\x73\x7d\xb3\xdc\xf7\x22\x63\x2c\xc7\x78\x51\xcb\xdd\xe2\xaa\xf0\xa3\x3a\x07\xb3\x73\x44\x5d\xf4\x90\xcc\x8f\xc1";
        address recovered_pk;
        recovered_pk = epervier.recover(message, salt, cs1, cs2, hint);
        assertEq(pk, recovered_pk);
    }

    function testVector3() public view {
        // public key
        // forgefmt: disable-next-line
address pk = address(728199263750570446964354330903202655824594974439);

        // signature s1
        // forgefmt: disable-next-line
uint256[32] memory tmp_s1 = [95417510935387961583619771841735389138166748997870492071117677118408687668, 683771490582091607252702062215069633382790424060392495150893131115769692295, 235318524573707415826929635062045355759144561158594459295749370458245050294, 21578507790379806259730823038837206823295731606671754496249076834345259380642, 145208515410390625936466358908934832078175994936585353222119914629566574590, 21684518748986512037747647179402095577778692513613722084676192087679627505518, 191144566165518254794534892251004420394569682010703683057455932339611107448, 201424744248049643130272709975836193217397542076339101243825201703224946521, 9163717773562083413950154029758306632725736099872107671489128387377889298, 21700743024259831662190715774988861739475660053085698674741836369007212769181, 21331475034191419864153510295704173109434116398980798767757501501760584560367, 145210968833825957795196913842202852788669996896749742264867312235607228476, 20972797617147153847930743647815246191320402013818664671201960367425828290591, 406701422741362605753089418802647141893272979299091790464377067422360666163, 646992758286858162311228320871192219953733471810262333797581744381899309184, 21421255323264665422992634690603949537993764457163838389623516539332944920673, 424045430424013859074550652540227933602337273657844266848339734850555817669, 58306546291480414804076411073949189658789995341884504801968540337672880344, 231457509739480395745315354304447510923970960303473740732339452460104089675, 224390736608228792916927643384373855403428705560333533490548508413299654877, 21658013692658327244837875277144327666182340650660013534062141838019090526143, 21322314723348243198270253117245517166079674231526101826849734683395161796337, 21504619068852496268635628600584526267137775987849490278353388809362419298226, 139911285338919526849455323911760241116138131833075901995136347258862764329, 429345243681765109965745658996751489759275913839340205358302704331777048684, 21547028785558392692138800955002536269994450515947990603848027819437530873864, 21438922855200718380034740549105997276393125999878401096855018889192422649653, 17995499749300299527202214813638276520609469269579187033464805603409592500, 219418976911120087229648889885272419478079496431521955387709200326000050263, 85137705281547021228123616361994927259423205486443702595953571535410692113, 279167907213465874560255541820782369097821454692818207870667802058248630190, 48033409664728154878924332938408162944233427576681496075170770015344603047];
        uint256[] memory cs1 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs1[i] = tmp_s1[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint256[32] memory tmp_s2 = [21458688216559808245543122379520925543421122845264988061050217915716701651121, 526849557330269173960678565552509746445812831284339853102209306750219988898, 143116984732640676578639890817830917141770435667057311732507876428954939379, 157577464433607878567356436521445885249296331187999466171348992474410909819, 21211327735329671273757668371987689534369970842800904412079099655362568269708, 35337512504501328702550930364562854285035110200589362246317414348932775965, 224719113698028106766142345332081447183663189380342804517036125254431289295, 95740513140462793351797848708518343088312305204400990002297897918368317513, 21029339122593608248292265070545822163473316284701752767018635449852604919565, 21578830118469047700299567701545607441927398747096620779627985312458500341762, 21589105174243651677582839686371729856347791895206613090245604691678698680308, 21600030508860154545750716158081049455406449914939567051630496841441650159507, 7070623512775102948365036845254265766924478225534485572395165166110584529, 21426556214915271384031567489556939050109829263755409612748736246861651509351, 21623002890759295012696894908256637030501859990336289272037043913349865406726, 21266102317864619773649219781841068614709887149550515956849321296921030242118, 21620910151827527557496037212336507736016606431559544021715761650296416895140, 21619145272852020394968906394738245753587529154285908850554131496585951248401, 21481334917246574931992238569918184776584544012742752218180272968722475593657, 21532569982358351964161894028029742767603812999524591627938116692772325097759, 21507833309669979270920759784336782877750889924854019797345992279272152182726, 173476612660247842711313469087601853643017391252956967123595180145145753501, 182307289249378007943501779593580168990216505231827080654748443900539449255, 21451618235208481025685320647491912658734789502505027820801934357968480764049, 161109271320488496290240608335170608936421510661025633814222866240413368349, 173163117567630007760962826169906655099237997690091581865156947736643579883, 21605007368934803247893618508181618251055746565368869748022137041978434453596, 21619466985891486195240568650296111290403254542995161544691053477886830641555, 48026071570139889738235886492819381819248305776999108524843614013934862625, 21437160564392767042338857103752548646462121315096478361743736278744774553594, 21304971093093328152937509245914534654134941146894025910215693159856954278202, 181990644640392963962978277452396410359450402188537004145714814469873479646];
        uint256[] memory cs2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs2[i] = tmp_s2[i];
        }
        // hint
        uint256 hint = 1219;
        // message
        bytes memory message = "We are ZKNox, you already know!!";
        bytes memory salt =
            "\xf2\x3a\x52\xb5\xda\x67\xea\xf7\xba\xae\x0f\x5f\xb1\x36\x9d\xb7\x8f\x3a\xc4\x5f\x8c\x4a\xc5\x67\x1d\x85\x73\x5c\xdd\xdb\x09\xd2\xb1\xe3\x4a\x1f\xc0\x66\xff\x4a";
        address recovered_pk;
        recovered_pk = epervier.recover(message, salt, cs1, cs2, hint);
        assertEq(pk, recovered_pk);
    }

    function testVector4() public view {
        // public key
        // forgefmt: disable-next-line
address pk = address(728199263750570446964354330903202655824594974439);

        // signature s1
        // forgefmt: disable-next-line
uint256[32] memory tmp_s1 = [21444226464876750546421487147896023058374046126567209080672280026363399372810, 30356630437426328241388652843306670583692741844769148898383564281539014560, 93649585504008406847473253303289409507219825695808868404544075521785069640, 21472499177150802350877808703273708931384872280558216783433267506284605472771, 21365041925191374736736909829051225847606661701063890101794274225733818003214, 150511909416388672434032519684082899589538622409240963628386599953499684883, 333935448173747057295741742707110961207337961850653613198428108055919931283, 21530186467440113461774921723268870700959354615758671630848294000616407226, 26830759540881095235822401032357301838946533597855752214002648982501392715, 21693674939981496721755860835998819566999611516115965792121871721982214209577, 260052356479467155656795769176131259856371619896595310302102077998884126925, 21695123088686344987970738398798714724970047642379882307980963530573332557692, 21361185143045739579924210435538889573484940340397666798264398085945703334010, 254428754282401683843055700096308745766881354068667012624411303158504751506, 21643886335050427302698896519240114438656046654890827640487614708500523712795, 21578505363935729135513939642211815673382029327549382353158465083657693310897, 21479568263871745886897385630988078652360410083616553632721774419378488606910, 21688376523762616202393848582549911504821195783837420132839885014958268362647, 360438742393069761618915230215721593061887793744796924222157188559062564905, 328963063548975337941820202442849049979179105907755635606814385467147026503, 252988014655170911391657626744817979720132742374272979099528491776922038103, 260055650604269441158825193194782499066031722909502177203312327549365846080, 509182052363364432150047259881464834186783799937785067355590065878104735995, 791550132096589488294490638185256637711367701555915546999205616738128363737, 21317335976015621487667403393934180196926873021404816956032509194688870756270, 21508156128050056421389079584819861223795034057557119743699835821332999831863, 21488395916049750823968316073806727884111419686494804875970356144958813187975, 21391218901055331425980234417303106116245748757447892845411136064637370892318, 21636816461497000013351439513717567205943753425164723382181005555647843467328, 21695123331244001868740328914854426610099953232835657121059682700605807263880, 93646507215028046651092619675034708248791683750252002279893284151285853990, 21405357371059027312830225887843639957445391707296667163878043795987069611918];
        uint256[] memory cs1 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs1[i] = tmp_s1[i];
        }
        // signature s2
        // forgefmt: disable-next-line
uint256[32] memory tmp_s2 = [21635047861961639605023706401238226438172916350695713901979206289214419763261, 413772396570614947990293279815549923933714078936624122365708805690116603958, 28600756050371863796129311170850019276743385646681017971248407234675420838, 389032111299988399033341155859192129382308464032817608889136297545913532796, 21640348349300668508196930371670192203722394321515650230334732961934667755411, 21566137914805472348214556999750555674131687277196019442782047164154616229662, 21509922467790894213158230519204798585578394237796918032262778698298636501110, 21589109088392926534806687456252993288138676776264808996447364934949414252411, 21483423045994963438766386155092621815638276861316695207462956343128610635871, 145211071738257237797993631204697447139232176515155472375860009070017130221, 21642437556422163929408848159675285561445567572671999980639356378878098145408, 21099689485756111885134215362018209944310136003961991481411249258994244857840, 286560297600855056960748399147850277620106178544415602834480414192514510503, 166094143358472392974854395155781512296893720273834626463174287570164985791, 270329407248164751052223729780750675275866654147964953293087679664319496246, 21656246850499619048409216224363062807785012813587490508989456799824556589354, 21335004150045575744505420637273526306247203740038374999186855639794005913432, 21468965586014533923963029904034867070647223749842412314374774919860790636342, 21438923227638459455756530428440205578775390412889200067122375494571247742700, 21483103656509207273801825845116072421908727334074663980653532869970700152742, 45944709810661087732997447558953851455528284920453407862122656723859406848, 74536272455532305353705337888201263235369848421320376906088359476708388768, 21453068329812893237688172119561213658930585809845905323617146164520907976700, 21619465422212186674481843492462484469404575163736121929636527164794466348888, 118379508283656663784162977402699504085468587500784174333140313133539995606, 21619144459068152358982502387331019922901359624847294093829149755891366559781, 21463987323924826754608864378875064524225593915586279164710047036625782177903, 21462218023497009057841330668611748629453020765278266223417535281198291157308, 349840064404550396795782018535340873446866021594182528100299038950945140466, 12376130242210956298722141856410460335865961473476087704783930542350217095, 132517735645848776164241652685397504048886625671765669344002566651038215960, 21059378407442867279210168785420669317591691544733158457118235917012887351236];
        uint256[] memory cs2 = new uint256[](32);
        for (uint256 i = 0; i < 32; i++) {
            cs2[i] = tmp_s2[i];
        }
        // hint
        uint256 hint = 3280;
        // message
        bytes memory message = "Practical security on the chain.";
        bytes memory salt =
            "\x1f\xd1\x66\xc7\x96\xb9\xcc\x25\x8a\x06\x4a\x8f\x57\xe2\x7f\x2a\x5b\x8d\x54\x8a\x72\x8c\x94\x44\xec\xb8\x79\xad\xc1\x9d\xe0\xc1\xb8\x58\x7d\xe3\xe7\x3e\x15\xd3";
        address recovered_pk;
        recovered_pk = epervier.recover(message, salt, cs1, cs2, hint);
        assertEq(pk, recovered_pk);
    }
}
