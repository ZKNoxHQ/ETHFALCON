
pragma solidity ^0.8.13;

import {Test, console} from "forge-std/Test.sol";
import {NTT} from "../src/NTT_Recursive.sol";
import {NTT_Iterative} from "../src/NTT_Iterative.sol";



contract NTTTest is Test {
    NTT ntt=new NTT();
    NTT_Iterative ntt_iterative=new NTT_Iterative();
    // prettier-ignore
    uint256[] f = [uint256(12255), 12139, 4897, 5862, 7302, 11341, 1213, 3476, 3122, 7098, 6744, 10065, 10973, 4082, 78, 10588, 3680, 6090, 608, 1196, 11606, 11387, 3840, 11805, 11976, 5643, 4923, 1573, 7108, 11292, 4717, 12166, 2947, 4196, 9354, 7018, 9523, 8393, 8168, 714, 5801, 5269, 2010, 563, 9598, 6272, 3704, 2726, 6318, 3914, 5933, 12076, 3485, 2448, 12200, 6410, 7291, 4062, 2938, 4842, 9921, 9406, 949, 838, 11945, 5374, 1806, 4419, 9800, 39, 4150, 10519, 1452, 7352, 10910, 7836, 503, 9383, 7676, 8761, 8062, 10273, 5150, 9236, 2700, 8903, 2300, 162, 10759, 2470, 637, 12282, 7619, 11385, 3049, 6706, 427, 3851, 10127, 8785, 4666, 7926, 9523, 10211, 10384, 2792, 114, 8208, 3623, 10282, 1103, 8125, 5571, 6078, 4327, 4523, 4842, 9535, 9425, 5546, 7556, 8069, 3266, 11526, 6981, 7796, 7366, 6133, 6598, 9457, 6888, 3797, 2926, 7706, 9915, 9360, 4389, 9697, 6131, 7874, 6057, 9126, 4781, 6304, 1407, 8309, 5340, 8503, 2899, 3974, 9101, 4982, 4619, 8450, 10678, 3874, 1898, 4157, 8236, 9174, 7905, 1512, 8767, 4817, 827, 3645, 9196, 5887, 3502, 8622, 9031, 6605, 3713, 4928, 9252, 7073, 182, 6492, 5206, 9158, 9034, 1133, 2718, 10062, 9151, 3628, 237, 10134, 816, 5665, 9593, 1928, 11259, 6264, 6015, 10591, 4403, 11157, 11186, 2089, 2393, 766, 7569, 1947, 8571, 9679, 3700, 7004, 11354, 11431, 10480, 810, 301, 973, 7446, 244, 11587, 1946, 4672, 2123, 10901, 8253, 4540, 10760, 11259, 7831, 12010, 7264, 1842, 8076, 8274, 9520, 1385, 8420, 10375, 9312, 5526, 3583, 2101, 12110, 10327, 12281, 145, 4766, 10057, 2118, 11083, 2622, 2599, 11097, 1081, 6575, 2066, 9639, 2750, 6615, 4138, 8218, 8686, 9499, 10686, 5946, 8032, 8655, 1077, 10421, 4916, 11341, 6815, 1856, 9487, 10798, 10263, 4662, 4880, 995, 5938, 5567, 10730, 697, 4257, 4481, 771, 7970, 3900, 9026, 4553, 8000, 4491, 7849, 8982, 3915, 11361, 3017, 7277, 2287, 8704, 1112, 5669, 5222, 6642, 9164, 2095, 779, 11845, 3037, 10284, 11599, 4517, 8395, 12251, 8805, 4764, 2656, 5150, 3802, 7642, 590, 3446, 7097, 6381, 10982, 5496, 3282, 3029, 4318, 7681, 11146, 3368, 11651, 2333, 8528, 3391, 9750, 97, 4698, 12073, 10956, 10200, 2695, 4629, 11392, 1721, 2419, 2282, 7150, 1157, 5233, 3330, 11898, 8609, 4228, 9125, 3779, 9369, 10727, 9864, 3460, 10497, 6415, 2608, 3942, 4040, 10833, 3977, 750, 403, 9763, 8507, 11159, 10803, 9095, 6014, 11255, 5381, 11007, 3605, 7411, 10551, 10740, 8410, 7424, 9486, 3539, 10437, 5638, 11213, 6635, 2711, 11895, 11615, 11496, 1667, 8418, 9157, 7592, 9757, 774, 6452, 11412, 7654, 7798, 5799, 10625, 4489, 334, 11866, 2665, 5028, 7865, 209, 9672, 2041, 5457, 10081, 8209, 7732, 3971, 10795, 9617, 649, 11631, 3123, 8598, 3563, 4810, 280, 4338, 1689, 6980, 851, 10234, 4235, 2499, 7247, 3410, 5706, 551, 9998, 8212, 3579, 8014, 7169, 531, 5564, 6217, 4746, 6988, 11608, 2998, 148, 6738, 55, 9677, 7432, 11415, 346, 1497, 2242, 11694, 4773, 2215, 1342, 11841, 10435, 7406, 4801, 9420, 4496, 5673, 10976, 4313, 3776, 4138, 8696, 9206, 7236, 632, 3481, 5909, 4705, 10029, 11310, 11798, 10840, 6825, 5273, 2705, 4299, 8578, 2806, 1922, 3913, 7146, 6590, 2383, 7646, 10313, 6916, 5683, 1478, 5942, 11377, 8701, 9768, 6220, 11297, 3377, 2000, 5713, 8842, 10683];

    uint256[] g = [uint256(12251), 12134, 4897, 5862, 7302, 11341, 1213, 3476, 3122, 7098, 6744, 10065, 10973, 4082, 78, 10588, 3680, 6090, 608, 1196, 11606, 11387, 3840, 11805, 11976, 5643, 4923, 1573, 7108, 11292, 4717, 12166, 2947, 4196, 9354, 7018, 9523, 8393, 8168, 714, 5801, 5269, 2010, 563, 9598, 6272, 3704, 2726, 6318, 3914, 5933, 12076, 3485, 2448, 12200, 6410, 7291, 4062, 2938, 4842, 9921, 9406, 949, 838, 11945, 5374, 1806, 4419, 9800, 39, 4150, 10519, 1452, 7352, 10910, 7836, 503, 9383, 7676, 8761, 8062, 10273, 5150, 9236, 2700, 8903, 2300, 162, 10759, 2470, 637, 12282, 7619, 11385, 3049, 6706, 427, 3851, 10127, 8785, 4666, 7926, 9523, 10211, 10384, 2792, 114, 8208, 3623, 10282, 1103, 8125, 5571, 6078, 4327, 4523, 4842, 9535, 9425, 5546, 7556, 8069, 3266, 11526, 6981, 7796, 7366, 6133, 6598, 9457, 6888, 3797, 2926, 7706, 9915, 9360, 4389, 9697, 6131, 7874, 6057, 9126, 4781, 6304, 1407, 8309, 5340, 8503, 2899, 3974, 9101, 4982, 4619, 8450, 10678, 3874, 1898, 4157, 8236, 9174, 7905, 1512, 8767, 4817, 827, 3645, 9196, 5887, 3502, 8622, 9031, 6605, 3713, 4928, 9252, 7073, 182, 6492, 5206, 9158, 9034, 1133, 2718, 10062, 9151, 3628, 237, 10134, 816, 5665, 9593, 1928, 11259, 6264, 6015, 10591, 4403, 11157, 11186, 2089, 2393, 766, 7569, 1947, 8571, 9679, 3700, 7004, 11354, 11431, 10480, 810, 301, 973, 7446, 244, 11587, 1946, 4672, 2123, 10901, 8253, 4540, 10760, 11259, 7831, 12010, 7264, 1842, 8076, 8274, 9520, 1385, 8420, 10375, 9312, 5526, 3583, 2101, 12110, 10327, 12281, 145, 4766, 10057, 2118, 11083, 2622, 2599, 11097, 1081, 6575, 2066, 9639, 2750, 6615, 4138, 8218, 8686, 9499, 10686, 5946, 8032, 8655, 1077, 10421, 4916, 11341, 6815, 1856, 9487, 10798, 10263, 4662, 4880, 995, 5938, 5567, 10730, 697, 4257, 4481, 771, 7970, 3900, 9026, 4553, 8000, 4491, 7849, 8982, 3915, 11361, 3017, 7277, 2287, 8704, 1112, 5669, 5222, 6642, 9164, 2095, 779, 11845, 3037, 10284, 11599, 4517, 8395, 12251, 8805, 4764, 2656, 5150, 3802, 7642, 590, 3446, 7097, 6381, 10982, 5496, 3282, 3029, 4318, 7681, 11146, 3368, 11651, 2333, 8528, 3391, 9750, 97, 4698, 12073, 10956, 10200, 2695, 4629, 11392, 1721, 2419, 2282, 7150, 1157, 5233, 3330, 11898, 8609, 4228, 9125, 3779, 9369, 10727, 9864, 3460, 10497, 6415, 2608, 3942, 4040, 10833, 3977, 750, 403, 9763, 8507, 11159, 10803, 9095, 6014, 11255, 5381, 11007, 3605, 7411, 10551, 10740, 8410, 7424, 9486, 3539, 10437, 5638, 11213, 6635, 2711, 11895, 11615, 11496, 1667, 8418, 9157, 7592, 9757, 774, 6452, 11412, 7654, 7798, 5799, 10625, 4489, 334, 11866, 2665, 5028, 7865, 209, 9672, 2041, 5457, 10081, 8209, 7732, 3971, 10795, 9617, 649, 11631, 3123, 8598, 3563, 4810, 280, 4338, 1689, 6980, 851, 10234, 4235, 2499, 7247, 3410, 5706, 551, 9998, 8212, 3579, 8014, 7169, 531, 5564, 6217, 4746, 6988, 11608, 2998, 148, 6738, 55, 9677, 7432, 11415, 346, 1497, 2242, 11694, 4773, 2215, 1342, 11841, 10435, 7406, 4801, 9420, 4496, 5673, 10976, 4313, 3776, 4138, 8696, 9206, 7236, 632, 3481, 5909, 4705, 10029, 11310, 11798, 10840, 6825, 5273, 2705, 4299, 8578, 2806, 1922, 3913, 7146, 6590, 2383, 7646, 10313, 6916, 5683, 1478, 5942, 11377, 8701, 9768, 6220, 11297, 3377, 2000, 5713, 8842, 10683];

    function test_correctness() public view{
        uint256[] memory res1=ntt.mulZQ(f, g);
        uint256[] memory res2=ntt_iterative.mul_NTTPoly(f,g);

        for(uint i=0;i<512;i++){
            console.log(12289+res1[i]-res2[i]);
        }
    }

    function testbench_recursive() public view{
        uint256[] memory res1=ntt.mulZQ(f, g);
    }

    function testbench_iterative() public view{
        uint256[] memory res2=ntt_iterative.mul_NTTPoly(f,g);
    }

    function testbench_iterative_opt() public view{
        uint256[] memory res2=ntt_iterative.mul_halfNTTPoly(f,g);
    }

    function testbench_iterativeNTT() public view{
        uint256[] memory res2=ntt_iterative.iterativeNTT(f);
    }

    function testbench_iterativeINTT() public view{
        uint256[] memory res2=ntt_iterative.iterativeINTT(f);
    }

}