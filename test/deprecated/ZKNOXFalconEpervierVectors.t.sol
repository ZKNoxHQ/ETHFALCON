// // code generated using pythonref/generate_deprecated_falcon_epervier_test_vectors.py.
// pragma solidity ^0.8.25;

// import {Test, console} from "forge-std/Test.sol";
// import "../../src/ZKNOX_NTT.sol";
// import "../../src/deprecated/ZKNOX_falcon_epervier_old.sol";

// contract ZKNOX_falcon_epervierTest is Test {
//     ZKNOX_falcon_epervier epervier;
//     //exemple of stateless initialisation, no external contract provided
//     ZKNOX_NTT ntt = new ZKNOX_NTT(address(0), address(0), 12289, 12265);
//     // forgefmt: disable-next-line
//         uint256[512] psi_rev = [uint256(1), 10810, 7143, 4043, 10984, 722, 5736, 8155, 3542, 8785, 9744, 3621, 10643, 1212, 3195, 5860, 7468, 2639, 9664, 11340, 11726, 9314, 9283, 9545, 5728, 7698, 5023, 5828, 8961, 6512, 7311, 1351, 2319, 11119, 11334, 11499, 9088, 3014, 5086, 10963, 4846, 9542, 9154, 3712, 4805, 8736, 11227, 9995, 3091, 12208, 7969, 11289, 9326, 7393, 9238, 2366, 11112, 8034, 10654, 9521, 12149, 10436, 7678, 11563, 1260, 4388, 4632, 6534, 2426, 334, 1428, 1696, 2013, 9000, 729, 3241, 2881, 3284, 7197, 10200, 8595, 7110, 10530, 8582, 3382, 11934, 9741, 8058, 3637, 3459, 145, 6747, 9558, 8357, 7399, 6378, 9447, 480, 1022, 9, 9821, 339, 5791, 544, 10616, 4278, 6958, 7300, 8112, 8705, 1381, 9764, 11336, 8541, 827, 5767, 2476, 118, 2197, 7222, 3949, 8993, 4452, 2396, 7935, 130, 2837, 6915, 2401, 442, 7188, 11222, 390, 773, 8456, 3778, 354, 4861, 9377, 5698, 5012, 9808, 2859, 11244, 1017, 7404, 1632, 7205, 27, 9223, 8526, 10849, 1537, 242, 4714, 8146, 9611, 3704, 5019, 11744, 1002, 5011, 5088, 8005, 7313, 10682, 8509, 11414, 9852, 3646, 6022, 2987, 9723, 10102, 6250, 9867, 11224, 2143, 11885, 7644, 1168, 5277, 11082, 3248, 493, 8193, 6845, 2381, 7952, 11854, 1378, 1912, 2166, 3915, 12176, 7370, 12129, 3149, 12286, 4437, 3636, 4938, 5291, 2704, 10863, 7635, 1663, 10512, 3364, 1689, 4057, 9018, 9442, 7875, 2174, 4372, 7247, 9984, 4053, 2645, 5195, 9509, 7394, 1484, 9042, 9603, 8311, 9320, 9919, 2865, 5332, 3510, 1630, 10163, 5407, 3186, 11136, 9405, 10040, 8241, 9890, 8889, 7098, 9153, 9289, 671, 3016, 243, 6730, 420, 10111, 1544, 3985, 4905, 3531, 476, 49, 1263, 5915, 1483, 9789, 10800, 10706, 6347, 1512, 350, 10474, 5383, 5369, 10232, 9087, 4493, 9551, 6421, 6554, 2655, 9280, 1693, 174, 723, 10314, 8532, 347, 2925, 8974, 11863, 1858, 4754, 3030, 4115, 2361, 10446, 2908, 218, 3434, 8760, 3963, 576, 6142, 9842, 1954, 10238, 9407, 10484, 3991, 8320, 9522, 156, 2281, 5876, 10258, 5333, 3772, 418, 5908, 11836, 5429, 7515, 7552, 1293, 295, 6099, 5766, 652, 8273, 4077, 8527, 9370, 325, 10885, 11143, 11341, 5990, 1159, 8561, 8240, 3329, 4298, 12121, 2692, 5961, 7183, 10327, 1594, 6167, 9734, 7105, 11089, 1360, 3956, 6170, 5297, 8210, 11231, 922, 441, 1958, 4322, 1112, 2078, 4046, 709, 9139, 1319, 4240, 8719, 6224, 11454, 2459, 683, 3656, 12225, 10723, 5782, 9341, 9786, 9166, 10542, 9235, 6803, 7856, 6370, 3834, 7032, 7048, 9369, 8120, 9162, 6821, 1010, 8807, 787, 5057, 4698, 4780, 8844, 12097, 1321, 4912, 10240, 677, 6415, 6234, 8953, 1323, 9523, 12237, 3174, 1579, 11858, 9784, 5906, 3957, 9450, 151, 10162, 12231, 12048, 3532, 11286, 1956, 7280, 11404, 6281, 3477, 6608, 142, 11184, 9445, 3438, 11314, 4212, 9260, 6695, 4782, 5886, 8076, 504, 2302, 11684, 11868, 8209, 3602, 6068, 8689, 3263, 6077, 7665, 7822, 7500, 6752, 4749, 4449, 6833, 12142, 8500, 6118, 8471, 1190, 9606, 3860, 5445, 7753, 11239, 5079, 9027, 2169, 11767, 7965, 4916, 8214, 5315, 11011, 9945, 1973, 6715, 8775, 11248, 5925, 11271, 654, 3565, 1702, 1987, 6760, 5206, 3199, 12233, 6136, 6427, 6874, 8646, 4948, 6152, 400, 10561, 5339, 5446, 3710, 6093, 468, 8301, 316, 11907, 10256, 8291, 3879, 1922, 10930, 6854, 973, 11035];

//     // forgefmt: disable-next-line
//         uint256[512] psi_inv_rev = [uint256(1), 1479, 8246, 5146, 4134, 6553, 11567, 1305, 6429, 9094, 11077, 1646, 8668, 2545, 3504, 8747, 10938, 4978, 5777, 3328, 6461, 7266, 4591, 6561, 2744, 3006, 2975, 563, 949, 2625, 9650, 4821, 726, 4611, 1853, 140, 2768, 1635, 4255, 1177, 9923, 3051, 4896, 2963, 1000, 4320, 81, 9198, 2294, 1062, 3553, 7484, 8577, 3135, 2747, 7443, 1326, 7203, 9275, 3201, 790, 955, 1170, 9970, 5374, 9452, 12159, 4354, 9893, 7837, 3296, 8340, 5067, 10092, 12171, 9813, 6522, 11462, 3748, 953, 2525, 10908, 3584, 4177, 4989, 5331, 8011, 1673, 11745, 6498, 11950, 2468, 12280, 11267, 11809, 2842, 5911, 4890, 3932, 2731, 5542, 12144, 8830, 8652, 4231, 2548, 355, 8907, 3707, 1759, 5179, 3694, 2089, 5092, 9005, 9408, 9048, 11560, 3289, 10276, 10593, 10861, 11955, 9863, 5755, 7657, 7901, 11029, 11813, 8758, 7384, 8304, 10745, 2178, 11869, 5559, 12046, 9273, 11618, 3000, 3136, 5191, 3400, 2399, 4048, 2249, 2884, 1153, 9103, 6882, 2126, 10659, 8779, 6957, 9424, 2370, 2969, 3978, 2686, 3247, 10805, 4895, 2780, 7094, 9644, 8236, 2305, 5042, 7917, 10115, 4414, 2847, 3271, 8232, 10600, 8925, 1777, 10626, 4654, 1426, 9585, 6998, 7351, 8653, 7852, 3, 9140, 160, 4919, 113, 8374, 10123, 10377, 10911, 435, 4337, 9908, 5444, 4096, 11796, 9041, 1207, 7012, 11121, 4645, 404, 10146, 1065, 2422, 6039, 2187, 2566, 9302, 6267, 8643, 2437, 875, 3780, 1607, 4976, 4284, 7201, 7278, 11287, 545, 7270, 8585, 2678, 4143, 7575, 12047, 10752, 1440, 3763, 3066, 12262, 5084, 10657, 4885, 11272, 1045, 9430, 2481, 7277, 6591, 2912, 7428, 11935, 8511, 3833, 11516, 11899, 1067, 5101, 11847, 9888, 1254, 11316, 5435, 1359, 10367, 8410, 3998, 2033, 382, 11973, 3988, 11821, 6196, 8579, 6843, 6950, 1728, 11889, 6137, 7341, 3643, 5415, 5862, 6153, 56, 9090, 7083, 5529, 10302, 10587, 8724, 11635, 1018, 6364, 1041, 3514, 5574, 10316, 2344, 1278, 6974, 4075, 7373, 4324, 522, 10120, 3262, 7210, 1050, 4536, 6844, 8429, 2683, 11099, 3818, 6171, 3789, 147, 5456, 7840, 7540, 5537, 4789, 4467, 4624, 6212, 9026, 3600, 6221, 8687, 4080, 421, 605, 9987, 11785, 4213, 6403, 7507, 5594, 3029, 8077, 975, 8851, 2844, 1105, 12147, 5681, 8812, 6008, 885, 5009, 10333, 1003, 8757, 241, 58, 2127, 12138, 2839, 8332, 6383, 2505, 431, 10710, 9115, 52, 2766, 10966, 3336, 6055, 5874, 11612, 2049, 7377, 10968, 192, 3445, 7509, 7591, 7232, 11502, 3482, 11279, 5468, 3127, 4169, 2920, 5241, 5257, 8455, 5919, 4433, 5486, 3054, 1747, 3123, 2503, 2948, 6507, 1566, 64, 8633, 11606, 9830, 835, 6065, 3570, 8049, 10970, 3150, 11580, 8243, 10211, 11177, 7967, 10331, 11848, 11367, 1058, 4079, 6992, 6119, 8333, 10929, 1200, 5184, 2555, 6122, 10695, 1962, 5106, 6328, 9597, 168, 7991, 8960, 4049, 3728, 11130, 6299, 948, 1146, 1404, 11964, 2919, 3762, 8212, 4016, 11637, 6523, 6190, 11994, 10996, 4737, 4774, 6860, 453, 6381, 11871, 8517, 6956, 2031, 6413, 10008, 12133, 2767, 3969, 8298, 1805, 2882, 2051, 10335, 2447, 6147, 11713, 8326, 3529, 8855, 12071, 9381, 1843, 9928, 8174, 9259, 7535, 10431, 426, 3315, 9364, 11942, 3757, 1975, 11566, 12115, 10596, 3009, 9634, 5735, 5868, 2738, 7796, 3202, 2057, 6920, 6906, 1815, 11939, 10777, 5942, 1583, 1489, 2500, 10806, 6374, 11026, 12240];

//     //stateful initialisation
//     function setUp() public {
//         bytes memory bytecode_psirev = abi.encodePacked(psi_rev);

//         address a_psirev; //address of the precomputations bytecode contract
//         a_psirev = address(uint160(0xcaca)); //here it is etched, use create in the future
//         vm.etch(a_psirev, bytecode_psirev); //pushing psirev bytecode into contract todo : replace with create

//         bytes memory bytecode_psiInvrev = abi.encodePacked(psi_inv_rev);

//         address a_psiInvrev; //address of the precomputations bytecode contract
//         a_psiInvrev = address(uint160(0xa5a5)); //here it is etched, use create in the future
//         vm.etch(a_psiInvrev, bytecode_psiInvrev); //pushing psirev bytecode into contract todo : replace with create

//         ntt.update(a_psirev, a_psiInvrev, 12289, 12265); //update ntt with outer contract

//         epervier = new ZKNOX_falcon_epervier(ntt);
//     }

//     function testVector0() public view {
//         // public key
//         // forgefmt: disable-next-line
// address pk_0 = address(728199263750570446964354330903202655824594974439);

//         // signature s1
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s1 = [uint(163), 41,12227,12103,12236,12150,309,74,5,32,347,297,12167,12234,62,72,12100,357,12173,12070,188,183,12085,12206,12214,158,307,75,11899,36,10,11976,12228,2,12185,12208,336,377,12145,122,85,12287,12144,12249,99,346,12263,107,12114,12193,154,118,12175,25,119,12061,92,235,12205,81,143,12067,9,12272,99,37,12154,34,264,12220,12278,52,12264,101,43,104,99,106,230,12208,304,12036,12280,12283,8,12129,4,57,177,78,155,111,12184,87,12215,102,492,19,22,17,51,12216,12087,59,150,45,52,241,12079,134,12223,12280,12201,12272,323,11967,46,12132,291,12127,12150,12207,24,100,86,259,12239,180,197,245,65,294,12196,12274,12159,12210,12207,341,12026,12018,135,164,91,223,82,11852,89,159,12182,12279,12192,307,67,12168,12172,12276,12268,149,40,12231,11994,245,12246,12123,12088,12187,7,12287,12236,219,12257,113,135,5,12186,12236,203,286,337,98,3,12193,12040,383,41,12236,132,3,202,12053,12110,155,373,107,12110,170,22,12257,12176,141,238,102,309,12068,12273,81,172,115,12216,12174,12021,164,61,147,45,12090,12137,4,119,11949,82,79,40,209,12265,20,12026,168,12260,12102,12284,11966,129,12125,12036,225,12232,12123,46,12048,12176,165,324,12129,12053,215,11949,227,12274,42,12154,17,448,36,201,12238,12049,67,87,283,99,226,12107,12177,12029,126,170,12269,225,12137,12138,72,286,102,289,92,74,12252,56,0,12016,12269,278,12081,12257,74,130,23,91,12044,12127,149,12170,12190,243,247,12160,173,12031,101,62,218,11927,84,12196,11869,129,187,85,12064,12207,83,12279,12170,260,12279,11928,362,12188,12207,12201,51,200,212,12110,249,12007,12033,111,106,139,77,30,11966,12225,209,38,12077,144,12203,12202,12118,12023,307,99,23,67,14,12284,293,41,45,276,12271,39,12050,12259,12063,108,230,295,98,54,12219,11980,14,39,11996,17,12236,12157,12056,15,175,12229,288,155,117,64,287,239,32,12284,12029,205,12176,142,12064,161,120,139,12239,25,12214,12288,205,285,248,12100,12251,305,12184,25,11867,12223,110,12277,12186,12201,12270,11981,12221,125,12052,320,37,115,11982,65,11990,12269,46,12272,38,12184,6,6,186,12287,12230,50,12118,20,12129,12210,236,149,12216,29,11962,12060,12130,282,32,33,11857,12217,114,12093,10,12266,109,12121,12213,62,90,56,19,121,12139,68,77,12126,134,64,12,274,12284,12079,136,215,12144,39,12043,131,24,237,12128,12106,82,12181,252,12203,12053,12098,78,12100,245,11970,12117,315,99,126,390,12049,12109,41,130,197,99,12265,12182,133,12016,196,295,12185,109,11985,12192,195,150];

//         // signature s2
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2 = [uint(12235), 1,12107,280,94,12229,12223,141,17,129,12123,12095,362,135,12234,97,5,12125,253,12242,12146,50,12279,24,239,12169,12164,115,12207,258,60,12168,12182,12176,12235,103,101,12256,221,82,20,12073,12169,12277,46,138,297,256,296,12161,104,12198,12192,189,344,127,12207,12225,16,48,79,12278,11,0,12118,147,311,228,136,57,19,12122,12155,7,12020,55,12095,97,110,12016,89,58,164,12214,89,221,10,136,240,40,12255,188,12171,191,53,64,12241,71,20,11798,185,12110,12145,12169,12162,293,12134,276,114,27,33,27,38,11952,12195,220,6,200,34,10,13,171,12052,196,269,33,63,12060,171,12240,11801,32,12213,57,51,12120,110,12066,12139,392,12209,12206,12205,12013,355,159,16,12273,44,35,94,69,219,12172,12104,12213,7,247,12247,32,2,11969,12044,53,203,12148,12225,49,12278,12225,12224,365,12163,106,12144,12225,11879,12194,65,76,12204,12232,7,12251,3,104,12002,106,152,12123,12149,233,12137,12101,21,23,12148,12043,12176,12119,105,328,0,12097,144,52,11956,92,223,12169,41,12268,38,12154,131,11,12077,156,29,91,12045,12282,45,12209,12259,11990,12032,98,26,12169,12100,12243,49,12117,12288,12052,11932,393,28,12288,12262,341,12236,133,12203,12131,71,11877,12125,12176,12256,12144,12040,12168,12034,47,165,41,34,12274,12103,33,23,205,12265,12001,12114,129,7,12281,197,12135,129,251,107,12227,12084,12150,20,12052,12071,297,12267,41,12245,12207,12252,12175,12134,35,86,12237,12182,162,231,7,11892,12232,215,280,12147,12274,236,147,12240,404,59,41,12277,12165,74,12181,12205,12143,104,12214,12218,12192,12069,12249,170,74,119,12112,12248,12152,30,41,80,164,90,317,12195,12028,65,162,166,3,199,272,12166,12115,66,12185,12200,127,11946,123,12257,72,12264,164,12219,12087,113,12136,12237,12276,12200,12258,12266,46,12250,24,240,12230,42,12273,97,129,12177,11917,145,197,12178,12282,263,12041,12208,285,195,12199,1,12027,12027,12103,161,73,11998,11965,12195,197,13,12097,208,102,103,12217,12170,113,92,12115,12168,194,156,297,220,12260,12272,12064,12287,213,12224,12060,96,115,12158,12252,177,168,138,12171,33,12284,262,12090,32,12011,12227,247,226,176,11988,12191,63,418,12077,12235,12260,12026,12240,164,12176,12061,12,12189,11,12235,12263,126,87,12243,293,12277,322,54,12244,12159,12191,105,175,133,57,196,12077,185,11973,12226,4,12273,12167,12248,173,256,12162,118,130,12262,12251,390,12276,12190,8,31,12219,12102,12216,376,125,327,352,125,12270,14,185,12069,14,12250,372,12130,50,12134,105,12191,163,12202,12206,12077,57,100,124,12036];

//         ZKNOX_falcon_epervier.Signature memory sig;
//         // signature s2 inverse ntt
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2_inv_ntt = [uint(9084), 8305,7958,10380,8813,6729,4400,1767,7875,6776,1105,6598,1469,2100,9306,6150,9289,2792,11189,1385,4314,3895,10624,1115,7136,2599,4631,3671,10382,11628,667,5272,6074,11120,8047,7095,1294,11532,7315,3987,6016,4091,1454,8894,4349,1486,2126,5531,9356,10507,3148,2573,1275,1960,6126,11100,7981,6840,4518,7011,6311,10264,8323,1654,1089,4184,9314,514,8883,8511,10711,9820,4374,10101,2760,10103,8769,5244,11174,442,3887,4735,12190,4547,288,5995,8452,4859,9427,12074,1284,7915,1203,4018,4245,4337,10242,9317,153,11025,5353,5439,6182,6556,446,2178,317,2683,1204,7067,6077,3194,8084,12120,10525,6764,3971,5250,2615,7405,11014,7758,9607,8744,12174,1535,3526,1482,5177,9730,9250,2074,3395,8902,5405,5009,10299,747,2189,6792,9708,7203,594,3232,8837,8835,1993,2226,1207,4220,8171,5590,9897,5064,6904,10152,3277,7393,4600,2223,6837,3682,18,303,6543,2833,4459,11856,10060,8438,10492,3145,10380,441,10035,1366,10686,5080,6228,8409,353,8412,1545,8052,2970,11491,11114,1906,9791,4367,6810,10091,2533,2552,3809,8791,1288,3573,6486,1659,1975,9396,2817,11114,1951,6858,4082,10781,10916,7452,7916,953,10011,3854,2052,8215,6738,9444,252,9051,439,601,10064,584,8388,7100,3341,5471,2747,11863,4469,1775,2091,297,7623,280,6913,10260,3953,4119,4208,11809,10379,12176,2883,5882,4469,7520,1202,3798,6493,5386,5105,11358,4472,881,4571,2344,8406,4721,11032,11962,10253,6253,650,231,5644,6136,8836,2881,3180,2331,8864,267,5065,10428,9113,3436,3733,10894,10330,8418,3777,10459,2833,10931,5604,10329,571,7728,2376,10706,7869,5364,91,12176,9213,5402,10198,5788,12088,6297,3844,751,11499,1870,9651,9322,8919,11517,1518,5863,10467,6490,7968,8462,3499,164,5628,8142,11790,2913,5409,2620,1419,2812,4471,6686,9667,7426,6662,11673,6523,7604,7931,2837,9082,474,4640,4610,2002,12135,999,10897,11855,12210,6679,10528,12261,11899,246,1290,6447,10086,3674,11035,9244,10093,10601,6660,2772,4272,10469,8081,1953,612,1519,7484,9381,794,6309,1785,11102,5076,10155,410,8726,1069,6788,5221,5535,7265,10421,8311,9457,655,11810,6535,4498,4624,4170,5192,3457,279,11499,344,8159,6609,2146,11945,2908,2039,3388,5899,2515,4525,6970,2557,11664,2406,4924,4658,4579,9073,3158,9553,11285,1367,11555,9167,7416,1701,4128,8687,6963,7763,4636,11510,1206,3859,8824,9498,690,680,4485,10246,7863,10500,9582,1838,5263,4616,6582,11829,9798,4043,8485,8474,11148,12175,10066,5741,7668,6417,2747,3031,6116,6047,487,5619,144,971,1943,6883,5791,344,1273,4638,12055,9813,10056,11963,4754,167,4232,3383,4233,4795,2216,4882,9155,7643,10699,4480,9023,5958,4625,11544,3609,7182,10369,9014,9023,10307,4560,10088,6924,8753,11276,12030,8589,8373,10595,2728,11566,8714,6832,938,9992,11324,11189,1776];
//         for (uint256 i = 0; i < 512; i++) {
//             sig.s1[i] = tmp_s1[i];
//             sig.s2[i] = tmp_s2[i];
//             sig.hint[i] = tmp_s2_inv_ntt[i];
//         }
//         // message
//         bytes memory message = "My name is Renaud from ZKNOX!!!!";
//         sig.salt =
//             "\x46\xb9\xdd\x2b\x0b\xa8\x8d\x13\x23\x3b\x3f\xeb\x74\x3e\xeb\x24\x3f\xcd\x52\xea\x62\xb8\x1b\x82\xb5\x0c\x27\x64\x6e\xd5\x76\x2f\xd7\x5d\xc4\xdd\xd8\xc0\xf2\x00";
//         address recovered_pk_0;
//         recovered_pk_0 = epervier.recover(message, sig, true);
//         assertEq(pk_0, recovered_pk_0);
//     }

//     function testVector1() public view {
//         // public key
//         // forgefmt: disable-next-line
// address pk_1 = address(728199263750570446964354330903202655824594974439);

//         // signature s1
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s1 = [uint(37), 12245,12152,2,40,159,12136,12219,12263,39,90,67,157,121,12232,12184,15,12042,12168,12148,195,12089,12147,12089,11919,12088,12137,12232,12276,121,51,14,12260,11931,11970,12179,12052,12036,335,12083,282,160,116,204,12270,37,12234,124,199,252,12225,175,12090,236,12287,42,21,12243,129,12219,12138,149,214,12099,18,26,12158,5,12245,12201,12274,234,116,12226,72,147,119,12146,216,44,12246,12154,12152,90,130,12171,12,71,12089,396,12124,390,217,12201,359,31,12171,162,67,146,12179,12169,87,9,12088,99,273,12256,35,12282,87,101,24,115,101,276,364,12072,37,12284,12258,11941,12286,180,12251,12022,57,260,12202,12007,67,292,72,199,12,128,438,12209,12240,12200,12267,53,12149,12078,11986,12118,12096,217,9,12222,26,12211,42,12272,12263,11948,142,215,100,116,12112,47,292,12232,12035,12217,22,12140,12129,34,12181,12239,12208,12224,12160,12036,274,128,12253,12122,12236,33,61,12195,331,12176,12270,12170,317,106,133,12284,44,138,12162,145,12191,195,12239,208,12269,86,12071,153,128,277,232,248,12267,467,83,35,59,138,12103,155,14,135,12135,98,12146,197,79,11958,131,12232,12142,155,27,12089,12270,12252,12227,283,12268,12095,127,164,47,10,12154,91,48,156,74,8,1,12144,12178,309,3,12045,48,312,222,12179,12199,12285,213,11901,60,12155,12208,12286,12030,196,12162,207,401,20,214,12105,11973,12270,188,12047,12168,11937,12256,12176,208,12274,54,12193,11819,77,352,12120,105,12236,12023,8,12224,134,12108,12239,105,12029,159,12239,12017,40,12120,119,12235,53,12184,116,12275,187,12178,120,12184,144,12282,12283,11984,110,12273,12217,12,420,131,12041,12057,115,12261,2,52,12254,12272,124,12118,12155,12063,153,12188,12167,142,12111,12075,280,46,47,12264,32,68,12225,12199,251,30,42,70,45,12147,12169,12264,12080,12184,237,12143,12286,115,229,85,40,12134,12162,12165,12119,12085,12194,59,12244,38,12238,138,269,187,12197,251,12146,171,12119,12254,12093,79,18,139,41,24,117,52,12211,12068,12244,12262,12274,12199,12282,123,6,12226,124,145,12121,47,232,12134,12150,12199,434,200,11965,232,2,0,120,12051,58,142,43,48,12152,12126,12024,1,12175,93,172,12211,105,133,45,11991,12209,12190,12231,11961,12154,165,176,12243,32,12281,79,12063,79,209,130,198,15,89,305,134,189,12218,30,45,12227,11,110,12051,280,12167,290,20,12155,87,12117,205,12163,154,12109,12132,11919,215,70,140,12172,366,12026,97,12064,156,12184,12112,120,12097,148,12170,12197,12230,412,199,74,12287,12236,12162,12271,12253,160,129,454,105,132,190,12206,12238,12278,167,12073];

//         // signature s2
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2 = [uint(12085), 45,12185,12217,12102,12274,12276,12209,35,12232,12188,35,12044,18,103,12051,12269,25,12238,80,35,11981,12180,131,12237,12244,12103,12272,60,12043,12141,12227,218,278,93,243,12109,12140,82,12287,118,87,161,12002,52,283,12165,12111,12172,11980,12175,23,146,98,12249,12164,181,12101,11,154,12242,150,12138,174,98,12023,194,12142,12211,12199,12129,239,12095,240,12128,72,335,12258,75,1,12206,81,91,17,12119,12194,38,11933,12063,12172,12201,180,111,12221,128,202,123,12272,11923,243,363,12153,206,58,68,16,12222,8,12018,184,12159,12139,127,324,12097,12166,48,146,11976,12029,129,322,12,47,12173,12224,219,12265,134,145,12260,307,104,371,175,12092,12205,12196,63,12098,0,121,93,138,236,37,12153,81,12150,376,268,12188,83,340,353,12117,12178,80,12279,12176,12109,216,12147,11994,371,30,12184,32,12140,12244,50,12047,207,185,12139,229,12204,155,332,12084,12203,3,244,12177,12122,12237,12272,12255,27,12062,12214,12117,11971,133,12181,388,49,114,12254,12105,244,53,12140,149,176,308,12218,8,12192,12210,161,142,326,114,33,12012,12161,42,24,43,263,141,12272,8,12248,12195,12155,75,12165,12278,92,12146,12170,177,12246,12199,44,42,23,95,12222,52,32,11949,12009,12207,72,12025,104,12258,12237,78,12049,237,192,364,12198,231,47,12106,12037,11937,283,40,167,12186,64,12120,254,67,12101,12274,12062,296,241,12235,12212,266,12249,84,143,87,12114,49,168,145,11990,12236,137,12275,12123,12237,12278,306,12265,12224,12248,12181,11968,12265,97,12222,286,438,12283,216,42,156,12283,43,11854,11,54,11887,12035,12208,12207,12285,149,100,71,1,199,12245,12246,85,12041,12247,12211,191,12247,47,43,42,10,12188,67,206,12231,29,3,51,212,25,119,208,12153,90,316,53,186,12200,12147,110,12167,38,222,12226,12079,82,11964,12276,187,126,11853,56,12165,51,12235,12152,11861,12201,12188,12030,37,8,70,207,12203,125,12232,193,12277,12038,12211,263,12070,12243,195,289,135,119,12256,12222,24,22,12092,175,60,282,43,12162,12110,12115,12080,12195,24,194,12017,203,12140,12234,0,395,12236,12178,12211,83,12248,12038,12115,114,12082,12206,308,38,12257,12085,32,17,12114,12271,11970,12243,138,207,12130,12226,12084,12250,11879,200,12030,12180,12195,86,313,83,184,37,28,147,91,243,12159,12252,108,103,160,12083,12220,202,157,188,71,179,12236,159,246,105,12210,12224,14,175,11987,12263,12195,12232,259,177,12198,12039,199,12278,12262,184,19,12062,12240,12212,12257,12204,12233,137,12183,12138,12136,243,12268,11736,12282,138,12174,12044,259,12270,12241,72,54,30,11981,12140];

//         ZKNOX_falcon_epervier.Signature memory sig;
//         // signature s2 inverse ntt
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2_inv_ntt = [uint(10955), 1524,9262,7922,6900,7802,1288,9651,132,766,5553,3008,895,8182,8066,10784,383,9007,2521,8097,3220,3104,8602,309,11871,9010,12273,4110,7123,994,5234,3372,5437,5296,5188,2994,4218,7613,6515,2342,2424,9578,7831,8390,7821,338,5066,9568,5185,5776,8378,736,3316,10171,6142,9509,8213,9323,10891,2856,9827,10083,4397,4052,1056,9720,4519,11051,4325,4312,2918,447,11092,9847,2803,3571,5245,4002,3753,2975,8233,26,4963,7972,10483,5266,3933,1807,2439,4156,6705,3423,5411,2041,8605,7715,6649,895,3803,5278,9418,2847,3697,5813,851,6368,227,10872,10209,391,2740,4401,631,294,756,11721,2974,9797,4616,10596,5091,1332,1207,4232,6379,2434,5286,7613,9972,10252,4682,3926,3562,1058,2331,9493,3984,6735,8361,10170,2784,8071,2179,10789,4038,4004,431,8891,7751,5101,10270,9084,7348,5679,7438,6735,5285,10964,5294,7451,4233,6804,5957,8058,941,118,8986,3456,6563,7939,346,2512,8474,1227,7337,9602,11924,8131,8272,715,3863,584,10538,8779,11864,11891,5707,7534,3108,2211,6506,9305,8007,9726,8026,874,1520,12270,10551,12285,2317,12096,5494,6267,180,6262,11385,8499,4874,11030,5710,3483,2978,11123,11644,9972,11428,12158,7399,9455,9875,7816,10465,176,11238,10191,8746,9933,7557,1632,844,7949,1178,4383,391,11897,3721,6752,8249,1628,8739,5066,3123,11110,8846,2597,3054,2940,11028,4255,8440,4583,9081,7600,9117,3104,7366,10414,5499,5960,9169,12010,11849,9802,5445,10646,3803,7731,1469,4891,4911,6909,4472,10494,4260,819,9852,9549,4016,2723,1586,10897,6167,11437,10215,10539,3224,669,2488,6515,2207,4436,3090,3443,3675,3742,7505,5972,6351,10457,6002,5542,3233,12054,4282,7297,8856,5709,10231,2903,1937,5398,6149,5405,5970,6412,11395,3627,8186,5107,2428,6401,435,1595,10631,10686,9330,39,10082,5434,4122,7255,3610,8520,9175,9699,3051,11137,11491,3644,4825,4816,4190,41,12158,5466,627,2862,2373,11535,2523,9877,441,7680,570,7887,6547,5695,10850,12002,12286,7383,6925,12283,1903,2151,8517,3151,5925,6750,7894,6322,2026,9179,5001,6994,6650,3940,11154,11949,10754,9051,10163,1669,5081,10124,5089,10626,1036,1255,5185,1920,11174,610,3456,5759,11539,8114,8806,9244,1919,9340,7185,8588,7266,112,10103,2544,11332,2248,1855,9655,7212,8757,4101,10519,5809,10489,8726,200,9528,11013,10728,11658,11154,5367,4548,8155,10261,7377,11532,10607,9836,2623,5613,9612,884,11435,9299,7709,5985,4463,5422,2990,4172,6016,10085,538,3836,7322,1412,10119,11132,7801,5716,7565,5677,3600,3977,10837,5775,2874,1807,6931,3580,9078,3678,5601,5069,8918,136,8759,11842,299,5401,7163,9804,10809,10849,1076,6080,2893,1333,548,10534,710,3132,10532,3030,2631,270,9978,8554,6722,7100,7705,12019,8702,10878,6822,8225,10991,9407,9238,5114,7224,1374,6750,852,8225,4192,82];
//         for (uint256 i = 0; i < 512; i++) {
//             sig.s1[i] = tmp_s1[i];
//             sig.s2[i] = tmp_s2[i];
//             sig.hint[i] = tmp_s2_inv_ntt[i];
//         }
//         // message
//         bytes memory message = "My name is Simon also from ZKNOX";
//         sig.salt =
//             "\x54\xda\xfc\x3b\xe8\x75\x67\xd6\x77\x23\x13\x95\xf6\x14\x72\x93\xb6\x8c\xea\xb7\xa9\xe0\xc5\x8d\x86\x4e\x8e\xfd\xe4\xe1\xb9\xa4\x6c\xbe\x85\x47\x13\x67\x2f\x5c";
//         address recovered_pk_1;
//         recovered_pk_1 = epervier.recover(message, sig, true);
//         assertEq(pk_1, recovered_pk_1);
//     }

//     function testVector2() public view {
//         // public key
//         // forgefmt: disable-next-line
// address pk_2 = address(728199263750570446964354330903202655824594974439);

//         // signature s1
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s1 = [uint(175), 168,12077,127,71,12248,54,416,12221,12260,75,45,254,12240,34,12182,11987,221,150,12282,4,12180,11872,12225,157,12077,48,126,12154,20,172,163,218,181,11914,12183,12244,150,12183,11943,203,100,43,150,32,12227,107,12248,12230,57,155,35,12181,12199,291,60,269,47,295,7,12262,12250,12074,12209,12193,12117,12179,121,12007,187,133,59,12224,64,293,271,95,95,104,125,303,285,71,12183,12150,93,12067,230,12080,125,12190,12140,181,11993,12102,12104,202,12118,12203,129,12280,45,55,12117,125,52,12269,12053,218,8,299,32,11912,12268,285,137,12176,12176,12176,12237,11884,13,12079,56,50,12234,12140,137,12194,99,199,12184,157,40,11,95,12023,86,46,12047,77,200,11999,12206,12288,12156,12096,201,12155,72,103,96,67,12176,12206,29,12259,90,135,12090,117,12166,12214,419,118,381,12149,12002,78,12163,12206,277,12237,12145,74,12192,9,12081,76,177,12172,12240,12205,12257,12206,219,12178,12076,20,11973,139,110,12135,12173,110,12161,58,12105,12050,12284,327,11986,12272,199,12213,12285,12254,12058,30,12222,12251,275,12065,97,12174,68,12125,109,53,50,12134,51,12191,138,12188,12110,268,12228,12096,12051,12201,196,12189,12215,12197,12252,12213,27,157,230,249,12260,250,37,156,149,47,12228,8,284,12283,178,12224,81,280,12245,12215,12252,133,107,12274,37,12163,12126,42,12283,41,12257,233,257,12266,36,12274,12092,48,11979,29,12139,12271,4,209,128,163,11827,12223,201,9,173,222,231,170,12169,12286,78,12193,12268,11972,10,12222,12246,12102,1,12209,26,152,199,17,12234,12066,12139,95,12267,12098,12046,12173,12063,12021,12089,12225,12278,12110,85,12213,106,160,12192,12220,9,12183,11985,238,129,323,12088,12241,12006,12076,319,12212,90,199,12222,149,12186,12137,12232,12171,6,12223,113,85,12086,147,12086,11912,42,11995,188,12270,302,65,12251,25,12078,12213,51,11,12095,104,55,20,174,12267,100,60,219,12230,11921,12171,146,38,12182,92,12197,155,12094,320,12165,12097,356,12103,12115,32,12159,313,12157,50,211,12051,28,340,12201,16,12283,12188,197,12225,15,141,24,42,12060,95,12248,12170,12085,12215,75,12015,12215,131,12202,180,12276,57,146,335,224,12032,12244,12075,12236,12250,197,12082,191,51,12284,12163,12144,11842,12240,12161,18,49,82,255,12239,12206,12083,150,75,120,12212,255,233,12166,86,12078,12026,12237,12229,88,12174,12274,11941,67,118,12054,12170,59,36,31,12148,12230,54,107,12185,278,12221,35,12156,260,39,264,13,185,11995,110,12270,80,268,135,12158,107,12211,12016,426,12105,12149,12147,73,43,101,45,219,181,12008,170,119,12284,12106];

//         // signature s2
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2 = [uint(12079), 124,12246,12263,456,124,12125,12249,226,12258,12262,13,19,12081,12036,12283,394,136,284,12131,12211,88,80,12157,126,12163,9,170,22,9,86,108,28,11847,104,12210,12070,116,89,12234,138,96,172,53,12117,12048,12159,16,135,55,90,12060,21,12241,12250,12139,12275,12113,67,12205,246,261,12278,152,12207,12287,221,26,12175,54,194,12106,11850,12260,122,12288,128,78,12159,12238,11959,12167,12191,12044,193,79,12226,167,12149,110,12069,38,12252,12230,12017,171,143,384,148,12089,11935,12280,242,12149,12241,12103,163,114,150,12203,11898,234,12191,12232,12259,12109,54,12246,156,36,12205,152,11997,12125,43,12018,12171,134,142,165,218,174,12180,44,12262,12236,328,12105,308,12226,147,56,12141,39,97,12170,12278,12190,229,78,77,12128,7,12019,12071,12164,27,12285,12112,12234,12124,171,37,65,12232,208,74,151,52,11981,11918,362,12126,12106,246,12126,157,112,13,12114,12106,78,12254,67,12231,12007,12186,12185,32,51,27,12049,68,12141,12261,12194,42,12258,133,75,11970,12257,12127,12185,12229,178,126,12218,12224,40,12182,12051,12189,63,6,115,12078,12101,12138,12086,12171,168,12190,12011,12050,232,36,12190,47,36,12281,131,12218,12215,375,6,175,12123,12231,12111,169,12265,12280,130,12246,338,170,17,12259,124,12255,12245,12269,156,12159,12194,12135,124,379,12105,12260,12244,12189,16,104,12223,12255,68,71,12042,12158,151,158,12117,309,12263,12137,7,27,12210,12269,117,12246,138,12284,190,12251,12187,129,68,12032,222,56,12181,12232,204,100,12142,137,213,187,525,12150,12241,12213,103,6,12125,12137,12164,76,12257,153,41,12202,44,21,20,99,12230,3,12235,12270,279,40,109,11791,18,12160,153,12121,12195,184,12220,12258,80,223,223,12203,138,31,69,12047,11984,12229,12014,12263,12207,12085,200,12214,15,12065,12249,12262,12178,12225,12158,120,223,72,12137,293,12219,12153,12255,93,12208,88,12169,12103,12196,12258,363,12209,12226,12121,383,3,12248,12121,19,38,12157,12267,12234,150,12138,12122,12101,12195,112,12208,12275,98,322,144,12140,251,215,12150,12240,79,215,69,12146,162,12195,12023,12083,12225,12050,253,12284,12230,1,12225,12019,107,64,12198,108,12131,117,12167,12142,170,12218,12005,12272,49,280,12270,9,12213,62,474,145,62,161,12153,21,12212,12225,336,12275,66,12198,12194,12128,12266,12065,65,12064,12255,64,77,139,115,87,214,12090,21,55,39,63,141,166,12259,118,420,12240,101,109,38,12128,167,12282,89,18,65,12211,12256,42,12282,39,13,12040,148,8,289,350,12006,12207,67,12107,340,159,12204,12003,81,13,12236,12061,88,97,12043,12163,317,242,12090,115];

//         ZKNOX_falcon_epervier.Signature memory sig;
//         // signature s2 inverse ntt
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2_inv_ntt = [uint(1166), 11853,8734,10967,6466,8233,6465,8363,1210,7656,8883,6356,7,1208,6622,10209,7490,4704,6916,1677,4427,5773,4719,2120,4409,11563,10927,5933,11683,7137,10384,798,5678,1643,8768,4876,132,10055,1658,6751,500,983,1207,8506,1224,9593,8695,1903,1113,8450,11866,11076,12098,9343,7819,4594,10759,3035,9915,744,4475,8258,4649,11337,9871,7672,9273,862,12123,9371,5830,3548,5257,8195,8340,8613,8861,4666,3839,8332,399,7646,10338,9035,51,2755,7772,11644,535,7566,8542,1135,48,6221,10668,9757,9426,6376,1318,3266,8459,373,3480,3271,9432,4721,5196,2837,8442,7830,883,1547,6970,2752,7092,4249,3966,11046,6600,789,9901,2079,781,4288,214,2688,2418,4698,1737,1656,3945,2754,10698,6761,786,9750,1177,2821,5204,734,1747,10822,8323,6085,1917,3410,1598,11922,5648,6777,6681,10292,9115,4173,1534,385,8616,6081,6597,4252,6966,3260,6819,8540,10634,6546,11226,1465,9894,2913,7364,5478,11231,6306,1288,10315,7115,11180,739,4335,2467,171,1375,10583,10909,10611,3744,4811,8938,1922,5948,5898,4706,5783,6730,11907,9886,1706,1598,1927,12178,7,10260,8543,5500,9074,7078,5605,5458,1451,9147,366,1540,2209,12144,57,5077,7074,2616,10274,331,1837,12165,10103,961,3388,6213,9082,2822,11318,4298,3069,1797,6005,4270,964,8817,4579,274,5110,3520,1691,10364,224,12176,6295,11109,1203,12269,1155,2001,9520,6602,7808,4729,4520,7286,3797,3341,201,7663,10037,5727,5814,2930,5413,1098,8441,3148,9263,10360,11263,3030,1130,9146,10931,5322,10415,5687,6696,10437,8020,11752,10208,1005,1126,4988,11149,119,117,4655,9124,3324,7395,10723,369,2082,4321,5987,4170,4434,9669,4230,4051,8838,8790,4574,11970,11061,667,5761,5068,6290,8705,9087,8987,1579,10856,4410,1856,7781,6934,10492,5614,10586,5215,4412,3095,1507,5275,5733,10087,5669,9336,374,5787,7887,9420,6744,6210,5418,3120,9597,336,11196,8233,3040,7740,8444,10757,7641,10273,3575,8634,11646,5319,5243,3150,4060,2908,6279,3993,8224,10557,8334,6659,3060,2136,7479,10580,6748,8386,544,1434,7178,11163,177,3736,6400,5877,5791,1599,8024,7839,8144,9723,656,9959,11609,4781,8677,11774,4451,11144,11586,8377,4201,9954,7840,9301,8860,11503,12276,10065,2932,5006,5587,8770,8574,8076,9882,6317,2943,7637,4212,7728,21,1730,5933,7443,6676,9837,1062,3610,11052,1943,4160,4327,2612,7499,3254,5236,2349,5649,11668,10448,6732,4759,9579,545,4392,7845,3316,5936,5437,1648,3781,9054,9410,9210,5254,5944,9690,8956,3253,7605,7823,11433,8134,10799,459,10026,6872,902,12125,6312,2226,714,7299,2218,11216,1795,8416,3194,1383,4572,4630,3736,8895,5822,4658,219,945,2171,1517,3164,3243,7849,838,10316,11185,2815,10789,3805,8052,7025,4708,414,8105,6885,6100,428,7564,4282,9909,7382,3855,3001,6614,5090,11478,747];
//         for (uint256 i = 0; i < 512; i++) {
//             sig.s1[i] = tmp_s1[i];
//             sig.s2[i] = tmp_s2[i];
//             sig.hint[i] = tmp_s2_inv_ntt[i];
//         }
//         // message
//         bytes memory message = "My name is Nicolas from ZKNOXtoo";
//         sig.salt =
//             "\x36\x06\x33\xe5\xdb\x4b\x60\x26\x01\xc1\x4c\xea\x73\x7d\xb3\xdc\xf7\x22\x63\x2c\xc7\x78\x51\xcb\xdd\xe2\xaa\xf0\xa3\x3a\x07\xb3\x73\x44\x5d\xf4\x90\xcc\x8f\xc1";
//         address recovered_pk_2;
//         recovered_pk_2 = epervier.recover(message, sig, true);
//         assertEq(pk_2, recovered_pk_2);
//     }

//     function testVector3() public view {
//         // public key
//         // forgefmt: disable-next-line
// address pk_3 = address(728199263750570446964354330903202655824594974439);

//         // signature s1
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s1 = [uint(52), 12077,12198,12023,12125,12283,307,37,259,116,112,12042,47,12088,288,54,135,325,61,15,142,12141,12157,12267,12040,12286,12238,12257,47,12145,62,387,12214,12282,31,137,12262,12137,69,12251,12065,114,12201,12068,96,12268,12161,133,12194,0,12053,91,30,12286,89,11,86,50,12286,12095,26,12277,170,12213,12286,12040,12115,280,12267,12264,234,339,12274,12195,12031,260,12183,12119,12131,82,12142,125,167,181,12067,208,109,247,12267,214,63,122,12190,12083,175,12273,120,326,12236,169,12111,106,12265,194,12063,12026,12196,12231,12287,322,12058,108,12121,209,115,12141,63,17,12198,12073,257,12125,19,150,155,174,155,114,18,12084,137,12052,116,83,176,97,27,12174,350,185,116,12012,12221,5,12189,12228,12223,29,12270,198,12028,12266,12164,12274,262,259,229,47,12143,12282,12015,12276,129,14,11964,12194,12128,12132,12165,175,134,12131,153,38,12256,12073,60,152,217,12133,12191,35,181,12250,38,12275,12187,111,12212,12285,12222,82,31,318,215,110,326,74,307,238,166,12046,12174,12242,161,12219,11979,11870,51,46,12141,85,12108,167,236,2,11969,236,12229,12164,58,12272,12114,230,128,12196,184,47,350,141,160,12015,174,12209,12265,253,12266,12116,12119,366,97,47,12258,12267,11998,68,12159,12189,25,12204,203,12284,72,327,56,12124,11973,11955,150,12197,12245,12043,12248,12227,4,140,26,12235,52,12255,79,240,216,133,149,11996,344,12222,131,11949,12000,272,12066,12198,13,85,22,33,75,19,12042,240,373,12259,12171,12205,137,12027,12271,35,13,12287,20,131,221,146,12078,69,12214,18,12172,21,99,12154,192,270,81,252,43,127,12223,129,180,11920,12259,39,285,12084,33,12221,12129,376,309,315,88,12258,12017,12003,12143,11891,12269,38,12073,11966,208,123,12012,12183,13,12279,161,12068,12210,253,12278,206,12272,128,12179,11865,12209,12199,393,192,90,12044,11997,12171,297,105,152,11917,50,12288,12120,63,406,12252,83,190,148,85,12254,79,108,12163,254,12244,12107,11903,12115,12212,169,249,185,299,12265,12211,52,243,8,1,133,129,12239,73,12068,29,64,141,103,12202,12284,283,12197,12195,12085,110,12165,201,12005,109,12217,12281,49,12096,72,12060,12288,12205,21,12134,180,11931,12242,12221,12108,12184,142,12159,58,12122,94,31,54,12029,12130,10,87,11743,37,12164,12035,12285,181,44,72,12148,12131,199,36,12279,12238,124,17,12096,10,144,12229,60,106,12069,96,471,116,67,11938,56,12205,48,12206,359,12280,142,88,160,12172,12108,303,12250,153,133,12282,12131,225,158,12199,51,12140,12162,12203,112,12195,176,85,12118,12283,230,162,12168,12186,27];

//         // signature s2
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2 = [uint(177), 11938,31,178,93,32,56,12225,12216,28,12270,144,11840,12155,12263,12145,12194,12268,112,12287,112,12283,75,220,11951,283,96,62,116,12148,12208,298,12275,247,264,80,11980,152,24,35,12191,321,12119,238,69,25,88,81,123,152,12108,12111,12185,25,130,28,12212,12042,12166,12217,64,188,12169,89,12172,12084,11977,127,189,12185,290,184,297,89,11839,12207,12184,86,12193,12005,29,24,65,11977,249,79,12175,22,200,12230,12288,12062,23,12276,21,20,12239,12096,159,52,12015,68,11948,12189,253,12230,12253,12065,99,12259,12223,127,73,308,73,12242,12043,150,12232,121,63,48,12133,12154,137,138,12269,54,12045,12159,12245,49,26,82,205,12230,106,210,12232,12172,25,12069,12068,11902,2,122,12147,12268,17,12201,74,12169,133,12247,12266,203,12142,42,12126,12213,12276,12140,12273,406,12030,62,49,12205,9,72,157,22,12037,93,33,12219,12179,56,171,175,80,4,2,12252,14,12152,321,12040,12102,12124,12060,12225,11985,49,12026,22,12089,12166,281,177,272,456,12235,12147,94,146,120,4,103,12140,12212,174,12156,372,12234,12127,12208,67,12264,11949,263,271,69,12127,262,20,286,224,222,74,285,30,149,160,12213,12276,118,12279,12185,12238,12102,147,11973,12277,12098,185,279,92,12278,93,12135,141,167,12171,12279,12036,164,108,12267,12144,85,12024,142,63,168,15,12170,150,24,12202,97,12237,17,117,162,47,12233,394,12243,8,214,12169,12068,258,101,12234,170,12236,12217,131,12217,12114,202,189,23,134,12189,12,174,141,0,18,308,12158,287,12179,12194,11900,408,11968,288,12261,236,48,12099,12087,12258,12236,178,12187,12230,12161,12106,136,11953,12177,47,11977,305,12280,167,12222,131,123,148,12173,12189,51,361,95,102,12224,72,12239,12236,303,122,12037,48,12242,12077,98,12199,110,147,12000,83,208,12233,290,132,12206,12112,11902,246,12189,11945,103,145,12222,204,223,11970,182,12205,284,12101,227,278,11953,12284,153,12167,12141,29,11996,65,337,239,57,21,156,252,167,116,12094,12180,75,12099,91,12267,12277,284,12060,120,1,12241,21,12115,12221,227,158,11945,494,449,98,92,12031,12239,27,12281,11975,3,267,73,188,335,12039,12000,12124,54,12228,403,12237,124,11994,12125,201,153,11952,12,52,12241,12045,173,12224,12103,12236,289,12113,19,52,12231,88,12097,129,6,176,182,109,12113,40,11914,27,12282,11985,112,10,12127,384,11949,12191,148,82,12210,12091,117,12268,190,12133,314,270,24,12115,12165,12032,40,38,12213,74,114,11980,242,12268,12210,12058,12254,66,12256,112,17,51,57,446,35,12250,12256,205,85,12103,200,103];

//         ZKNOX_falcon_epervier.Signature memory sig;
//         // signature s2 inverse ntt
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2_inv_ntt = [uint(6263), 3578,5789,3192,10290,5352,5403,1309,1846,8754,11529,5099,10385,4777,9495,8145,8201,3364,11038,3472,6666,2361,6020,751,5958,9797,6359,10911,4330,11500,9260,2981,6716,8232,1683,11153,4039,4291,9784,1311,687,9003,6969,1256,10474,1151,5146,5586,9203,2198,5428,5670,10695,3320,4469,8749,11728,9126,2191,11232,11775,3513,5381,3238,9368,10046,11509,8699,999,8972,5785,6856,2351,4012,3882,10893,11485,5708,10779,8594,6696,5568,3596,2367,1176,6886,8478,3688,9345,3498,1357,169,6824,6363,8993,1886,8407,10683,3183,12099,5496,11345,8003,2010,9619,2839,3254,6751,4086,4186,3272,10807,10670,11231,7556,4622,10614,2166,8822,3649,10915,7144,9935,8714,1938,6207,2030,11388,6172,9730,251,114,11348,1240,945,1825,8045,2992,6486,11069,199,537,10120,2144,4862,7433,12210,6,1042,5229,6943,9932,11555,12024,11067,9390,4439,26,9539,10865,3881,5551,12134,3120,7310,10666,3833,4251,5473,9635,701,10657,959,11517,10194,4214,4154,4168,8911,4073,11108,1914,11169,2158,1593,8136,7180,9688,7557,8162,3329,483,383,10048,10939,5492,9716,8649,10009,7361,10794,623,11938,10425,1034,5282,10884,9336,6646,8524,2400,9813,308,9801,5415,7028,2763,4487,8765,2768,4468,6761,3828,6877,5463,1288,5692,536,8891,8020,2320,4461,3065,7267,1306,4141,10586,5745,11216,10527,4910,2064,3859,5439,10631,2030,7592,7880,10099,4002,5150,3682,8634,10442,8672,9105,8369,7691,200,5303,6377,5349,3704,7144,2532,5932,4496,4834,2064,12177,219,3606,3770,5802,2449,10909,9568,5852,1555,9265,11335,4250,10085,709,5785,3830,4844,1163,5178,3555,1311,4031,10455,2739,9501,6286,4808,6754,8035,7620,5105,7950,3990,11541,9659,418,2177,3708,10870,12007,2165,9374,372,8710,10579,6523,6596,11622,5555,2470,6778,11515,586,9867,961,563,6169,12235,8375,1587,7180,2464,11277,6443,2525,10488,3623,11801,5952,1087,11615,6797,7295,3849,4088,10665,4375,3779,5950,1256,3435,4666,11869,11988,10829,10840,9904,3366,8662,11185,10477,9163,6418,7134,7771,11228,2267,8828,5729,9321,1653,3551,6609,1769,3471,3742,4437,7574,3793,2637,2357,1604,8816,8069,10974,12209,8160,8796,10322,1037,3863,2183,710,9401,8392,3012,1280,5303,2263,1000,9025,11056,273,2887,8219,9368,7650,3602,7448,7200,5020,8603,3005,1940,12126,2510,1128,6093,11270,2281,8378,1309,4479,1088,9366,3282,3335,3396,6786,3926,8143,10797,6238,7330,402,5987,8701,6592,7540,11616,10689,3841,5189,10498,9467,3821,6248,2770,539,7435,7848,8170,3508,1,829,345,6386,6122,5068,11216,3210,3061,9425,11113,3146,2167,4101,1206,7572,6912,7209,11885,1581,6786,9232,11959,2286,6368,7453,4821,12048,11772,12218,3870,4158,8111,10013,10001,11589,4399,3948,10017,6901,5808,8429,6883,3605,1302,5956,4442,7415,9649,5138,8345,8257,7531,782,6821,8079,4421,2313,1720];
//         for (uint256 i = 0; i < 512; i++) {
//             sig.s1[i] = tmp_s1[i];
//             sig.s2[i] = tmp_s2[i];
//             sig.hint[i] = tmp_s2_inv_ntt[i];
//         }
//         // message
//         bytes memory message = "We are ZKNox, you already know!!";
//         sig.salt =
//             "\xf2\x3a\x52\xb5\xda\x67\xea\xf7\xba\xae\x0f\x5f\xb1\x36\x9d\xb7\x8f\x3a\xc4\x5f\x8c\x4a\xc5\x67\x1d\x85\x73\x5c\xdd\xdb\x09\xd2\xb1\xe3\x4a\x1f\xc0\x66\xff\x4a";
//         address recovered_pk_3;
//         recovered_pk_3 = epervier.recover(message, sig, true);
//         assertEq(pk_3, recovered_pk_3);
//     }

//     function testVector4() public view {
//         // public key
//         // forgefmt: disable-next-line
// address pk_4 = address(728199263750570446964354330903202655824594974439);

//         // signature s1
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s1 = [uint(10), 12202,73,212,273,12121,12125,177,498,12261,12234,12221,9,167,135,12137,12192,12273,12133,58,283,206,12199,12140,12146,20,12275,27,220,218,11878,17,72,12108,61,12099,12228,12209,12198,12222,274,12014,86,12239,195,12164,248,53,3,156,166,155,12145,12213,53,11918,12105,12259,118,12174,12210,12136,252,12153,12046,12230,226,2,12255,64,12249,12138,12267,12272,12064,12284,11899,12199,12137,12092,19,12216,56,12072,237,86,153,12267,327,12222,453,58,12261,104,12237,85,12179,15,278,109,11955,74,19,12195,12063,12267,11981,191,12171,11992,50,189,186,12110,12213,58,300,12172,12230,12070,12239,44,12242,12159,12263,46,12167,12,331,12187,12001,145,341,306,12215,106,269,12236,35,11984,42,12004,12168,15,41,12043,44,12283,138,12220,12199,12207,91,72,12245,178,12,12054,12117,12278,205,12183,81,12157,107,12026,12256,12101,12109,199,564,193,12185,101,12086,147,12156,103,12229,130,323,12266,11996,3,12077,255,237,65,155,312,296,12279,122,12185,93,12168,12212,115,43,12114,12280,12282,12285,142,12164,12162,153,12090,402,12268,64,12249,44,100,100,5,339,84,11843,193,104,194,103,144,283,93,49,136,187,12185,106,123,17,359,72,12156,74,12287,363,12250,12209,12286,12230,12266,12214,12168,38,12162,87,12127,38,49,12242,12158,80,12213,190,11938,32,28,11956,356,302,250,12028,12268,107,71,12132,12100,315,12157,12183,12218,161,12245,229,254,12178,12276,207,12221,148,12211,12281,239,12196,12275,41,12262,12189,189,12252,12248,91,171,12200,12110,137,12145,243,151,72,204,71,34,184,12267,12159,12202,12030,12168,12012,183,310,256,12267,12232,12222,186,12119,12211,12216,12230,37,12171,167,12237,12224,308,124,12207,179,6,12199,143,64,113,12097,9,43,30,12005,12153,125,31,12210,12133,199,12283,12208,147,251,12047,12192,60,224,62,11957,158,58,12058,153,12197,11999,292,12244,288,217,12160,12165,12060,12238,12163,11958,12152,96,213,186,12244,32,12157,98,448,12206,424,0,12260,12172,355,12283,12194,12259,12082,12243,12148,133,12129,12097,12065,311,146,141,218,334,12244,89,83,99,72,12043,12199,12278,71,12122,12173,12167,99,215,199,12269,12128,45,209,12193,23,295,55,72,143,71,12162,30,168,44,38,12272,165,230,155,12016,12282,103,139,12023,12121,55,12107,64,12201,12285,12161,53,194,190,12250,12202,12132,38,120,12248,183,271,12246,136,12226,12218,328,12206,12112,51,12241,11980,12045,12288,31,271,113,305,12279,12070,29,68,11965,12174,150,12157,171,31,12278,12277,12284,337,362,134,53,12174,12215,112,167,12217,12001,12267,12199,85,12285,1,76,272,12055,192,12115];

//         // signature s2
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2 = [uint(61), 8,95,226,152,56,347,108,12143,34,11921,40,12096,3,206,12245,54,1,12147,258,290,17,12024,71,12230,16,12145,239,12183,12022,12247,234,11942,99,131,217,12205,12224,12273,24,12107,191,243,126,92,168,12285,16,380,12083,174,12285,354,105,407,12149,12151,12256,12258,12274,100,32,12083,220,12179,12281,12233,12278,101,12263,89,165,12146,12234,29,12216,12260,160,204,12248,12062,192,186,9,12253,289,35,314,429,3,12231,63,12281,111,98,12206,118,12230,12277,138,11967,12280,122,11960,12146,16,96,83,166,12019,12103,12174,12155,18,12252,12224,77,12091,206,69,12224,12233,12029,2,191,12143,178,12219,95,273,12169,41,359,10,12153,12192,12031,41,152,12165,70,16,12225,12159,12013,12152,12129,12143,88,12239,12031,268,44,84,12264,12286,129,288,12226,82,128,154,12139,305,12201,12223,12201,12091,12087,11,12055,12194,31,98,12161,12249,12272,53,12261,84,12248,12141,12242,22,11941,93,201,59,11796,11902,68,11942,11943,234,12200,12288,13,12126,12076,11994,12264,12137,12142,12130,12198,12061,12280,162,12223,12175,181,12276,86,12208,12218,11972,14,12187,12288,354,12093,11887,390,94,54,222,296,12269,111,12273,11975,181,11987,12177,12217,226,12178,50,67,153,298,252,12076,20,17,12002,345,12236,12197,124,253,12127,46,12241,88,12257,12120,113,318,12259,450,12266,12148,12166,249,27,12180,23,0,11987,12086,12075,12086,42,12273,122,12279,12129,12286,84,82,197,197,150,98,355,256,12151,12012,12247,140,297,12076,12201,11977,12127,12057,11972,60,100,12103,47,35,12134,12198,162,12145,12147,7,12235,12202,118,12245,31,12189,12243,12132,12176,378,12159,0,12044,12021,12199,12177,264,100,11878,12253,144,11987,12201,16,145,248,26,12192,166,168,12178,5,93,11989,12231,12217,192,145,12230,12240,158,12192,42,12284,96,216,47,272,113,62,12255,12286,51,12188,49,27,39,418,12142,12120,82,12224,12279,215,174,12276,133,306,36,12138,381,12190,12218,12045,12236,12246,12237,12198,74,104,12016,96,3,105,43,148,10,128,158,28,67,37,225,12180,78,24,12202,12161,376,12173,12195,12016,11996,7,115,140,12236,111,6,119,62,12041,144,12262,92,12263,12183,44,109,12267,117,12210,12148,316,91,17,12028,12282,247,12287,11892,34,12270,12190,283,87,98,12119,12147,12018,39,12110,12149,41,100,100,12017,18,175,12204,12147,74,12220,161,198,12167,189,108,465,11975,12207,11956,205,132,397,213,12232,12239,12069,304,7,12056,12005,27,12127,66,12231,12265,12197,11985,12041,21,12252,24,87,156,75,12228,12119,12179,62,12210,12091,131,12247,12270,12112,205,229,68,12151,12175,11919];

//         ZKNOX_falcon_epervier.Signature memory sig;
//         // signature s2 inverse ntt
//         // forgefmt: disable-next-line
// uint[512] memory tmp_s2_inv_ntt = [uint(10775), 2490,8549,5021,2382,3327,7851,2363,10419,11299,3831,9373,1596,1996,11195,5015,3480,8854,401,903,9242,8541,8388,10352,965,3827,8192,7966,4632,11167,10969,6259,3244,9501,3059,10951,4880,5747,1598,2047,3807,10006,2246,5458,2890,7005,9500,8161,935,3671,1888,8319,5112,2179,5124,2585,7164,12072,746,719,5118,8751,659,6127,2448,4358,9802,11304,8166,5632,7800,7467,1103,7688,1961,11476,6764,7543,1500,624,12253,2855,10169,5795,1677,1914,120,7901,10286,3746,1107,8479,3045,3009,8799,4687,8618,874,8848,10389,11734,8107,10696,3657,1785,7626,2519,6812,9731,10348,2253,792,8253,546,5274,3062,5474,7406,1027,4035,1930,2929,9187,4301,6798,11942,5909,11511,4343,6553,5154,6029,1493,1980,5926,540,962,7631,2181,8466,10809,11585,4065,10413,3054,8359,226,2166,4360,8943,11139,10846,12061,2579,9720,6353,9209,11019,6201,1569,11995,10628,3760,3385,5340,4032,10461,10486,2814,1036,2708,379,7002,11815,11786,3039,8647,3162,527,8918,8197,9127,5482,3027,1513,328,2447,1036,87,8923,7439,11993,8753,10212,5858,10131,10760,8702,8312,3079,3309,971,7507,12041,5580,12275,7776,11009,5880,2461,9810,6740,4095,10099,860,2675,11072,8552,11925,1748,1277,8319,5463,7764,11699,6585,8067,7143,7110,4472,6488,11361,6318,5268,10943,4167,6499,5506,10819,6468,4120,9857,3087,8356,119,772,10050,2026,8276,3899,473,4447,3354,6673,11189,8517,10657,1952,10929,4866,8763,5260,597,8062,2256,3928,5160,4070,5451,1946,10801,9727,1286,9930,453,11979,3690,6106,10298,10624,2344,3823,8231,4822,11091,6649,10163,6547,4811,5228,1049,9304,3692,4522,212,7106,8077,9802,2561,7094,10279,8971,10356,8339,11123,7638,5976,9683,6218,1726,8847,7057,10125,12171,6956,10010,6620,3210,12065,3126,1671,7930,9752,6415,8663,1094,9155,1764,4814,5521,2622,640,9014,2404,11322,4184,6742,8458,2037,7861,8825,931,8155,3710,3494,3575,2246,12120,4195,4932,9302,2758,12252,1212,11959,11172,8688,6615,7609,7489,3223,8505,2767,11280,7139,2145,6444,3942,6940,8170,9372,1787,8635,6045,657,3967,4085,10102,3998,7323,2088,5149,1923,6058,7511,10411,11412,8240,9280,9282,4690,11149,8252,4545,10544,2967,10167,6041,10412,2164,3207,5808,10871,8857,5173,78,8737,330,12016,8917,4026,1621,1759,424,11965,9202,6480,10618,4173,11697,9668,6473,10915,6129,9980,8413,8251,1022,8725,2982,2814,7271,4578,10632,8669,9251,9830,5783,9817,1767,11763,8533,6348,7907,5812,11017,185,4228,6195,7700,11551,9726,10922,6007,10685,3964,5986,6443,10732,3366,9760,8836,9957,10363,6847,6254,9844,2728,7561,5329,3015,4046,3481,3130,2043,10659,2703,910,10435,7430,4158,1357,11572,10955,3801,12227,1505,7622,2744,1492,3142,2865,11016,10690,4315,7235,8865,6572,1423,5300,1988,10171,12075,5141,11646,6921,11940,4035,4213,2331,9922,8706];
//         for (uint256 i = 0; i < 512; i++) {
//             sig.s1[i] = tmp_s1[i];
//             sig.s2[i] = tmp_s2[i];
//             sig.hint[i] = tmp_s2_inv_ntt[i];
//         }
//         // message
//         bytes memory message = "Practical security on the chain.";
//         sig.salt =
//             "\x1f\xd1\x66\xc7\x96\xb9\xcc\x25\x8a\x06\x4a\x8f\x57\xe2\x7f\x2a\x5b\x8d\x54\x8a\x72\x8c\x94\x44\xec\xb8\x79\xad\xc1\x9d\xe0\xc1\xb8\x58\x7d\xe3\xe7\x3e\x15\xd3";
//         address recovered_pk_4;
//         recovered_pk_4 = epervier.recover(message, sig, true);
//         assertEq(pk_4, recovered_pk_4);
//     }
// }
